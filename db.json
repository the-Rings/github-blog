{"meta":{"version":1,"warehouse":"4.0.0"},"models":{"Asset":[{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/next/source/css/noscript.styl","path":"css/noscript.styl","modified":1,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/logo-algolia-nebula-blue-full.svg","path":"images/logo-algolia-nebula-blue-full.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/js/bookmark.js","path":"js/bookmark.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/comments-buttons.js","path":"js/comments-buttons.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/comments.js","path":"js/comments.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/config.js","path":"js/config.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/motion.js","path":"js/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/next-boot.js","path":"js/next-boot.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/pjax.js","path":"js/pjax.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/schedule.js","path":"js/schedule.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/utils.js","path":"js/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/schemes/muse.js","path":"js/schemes/muse.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/fancybox.js","path":"js/third-party/fancybox.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/pace.js","path":"js/third-party/pace.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/quicklink.js","path":"js/third-party/quicklink.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/rating.js","path":"js/third-party/rating.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/analytics/baidu-analytics.js","path":"js/third-party/analytics/baidu-analytics.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/analytics/google-analytics.js","path":"js/third-party/analytics/google-analytics.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/analytics/growingio.js","path":"js/third-party/analytics/growingio.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/chat/chatra.js","path":"js/third-party/chat/chatra.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/chat/gitter.js","path":"js/third-party/chat/gitter.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/chat/tidio.js","path":"js/third-party/chat/tidio.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/changyan.js","path":"js/third-party/comments/changyan.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/disqus.js","path":"js/third-party/comments/disqus.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/disqusjs.js","path":"js/third-party/comments/disqusjs.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/gitalk.js","path":"js/third-party/comments/gitalk.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/isso.js","path":"js/third-party/comments/isso.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/livere.js","path":"js/third-party/comments/livere.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/utterances.js","path":"js/third-party/comments/utterances.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/math/katex.js","path":"js/third-party/math/katex.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/math/mathjax.js","path":"js/third-party/math/mathjax.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/search/algolia-search.js","path":"js/third-party/search/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/search/local-search.js","path":"js/third-party/search/local-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/statistics/firestore.js","path":"js/third-party/statistics/firestore.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/statistics/lean-analytics.js","path":"js/third-party/statistics/lean-analytics.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/tags/mermaid.js","path":"js/third-party/tags/mermaid.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/tags/pdf.js","path":"js/third-party/tags/pdf.js","modified":1,"renderable":1}],"Cache":[{"_id":"source/_posts/hexo-build-guide.md","hash":"d833fde76ea7856bb0b213cb906b62fb8c256720","modified":1640833217738},{"_id":"source/_posts/java-arraylist.md","hash":"c0edabe2f0a78d3f04d7e197b48400ffa2cbf2e6","modified":1640832448293},{"_id":"source/_posts/java-chain-of-responsibility.md","hash":"4cdf7f8476ca57b958da0fe317ba23ca4268a37b","modified":1640832468767},{"_id":"source/_posts/hello-world.md","hash":"f145a6fecbbd2421680d07429125d7799eea0f59","modified":1640833220035},{"_id":"source/_posts/java-classloader.md","hash":"09d011e06b3a637f26133085df1526dd4d112eb1","modified":1640833275553},{"_id":"source/_posts/java-annotation.md","hash":"712b8f43893cf4a1c1376e58bed396ff6cf3a199","modified":1640833239701},{"_id":"source/_posts/java-inner-class.md","hash":"ea1c57de65ce9639e73ab1037d052c3c8f77e1fe","modified":1640832621081},{"_id":"source/_posts/build-multi-module-project-best-practice.md","hash":"afe56f79bdc79a65a9fce6ac8ea5b39679383957","modified":1640833187716},{"_id":"source/_posts/java-factory-pattern.md","hash":"18df24dc89ee4cf9450256490578e3ce17a6bc56","modified":1640833288015},{"_id":"source/_posts/java-functional-programming.md","hash":"6b553ebca694c55b60a10ba894f0764896f43d5f","modified":1640833297188},{"_id":"source/_posts/maven-wrapper.md","hash":"6c1630f525365d3d9fb41b9a92e0b6a6f3727a63","modified":1640832696861},{"_id":"source/_posts/java-proxy-and-dynamic-proxy.md","hash":"2dad0cb965f702d18359d634ea66f237d4bcda8d","modified":1640833403209},{"_id":"source/_posts/serialization-deserialization.md","hash":"812ea2d37831fc24ee47d08c93cb9783acfacbbc","modified":1640832858957},{"_id":"source/_posts/professional-dictionary.md","hash":"8440e337384789a1090ebabb28710f98bdb3e395","modified":1640833450420},{"_id":"source/_posts/java-reflection.md","hash":"766bba6e227b1d2ddc01a9dde055ae93df158a1e","modified":1640833412637},{"_id":"source/_posts/java-streams.md","hash":"549218ee853b523eaf4762fc8d4023fec98f2bef","modified":1640833421445},{"_id":"source/_posts/theory-turing-completeness.md","hash":"564dddfa3499e6719fc9eabfb7c18fb6a52e6030","modified":1640833508334},{"_id":"source/about/index.md","hash":"5e3341da64449a4c7cf2ed4d079e60d5189c4c2c","modified":1640832362120},{"_id":"source/categories/index.md","hash":"c5894bd83309dc828ec96f45e8b3c319cfa5c254","modified":1640831234813},{"_id":"source/tags/index.md","hash":"09f5bca4764facf81df1aedfba0d15a74f6c69c7","modified":1640831178244},{"_id":"source/_posts/spring-ioc.md","hash":"cad403c4acefe52d8980e9b4ff23c32948b15771","modified":1640833499355},{"_id":"source/_posts/spring-aop.md","hash":"a57ffb3740aa728dc25c11c6e7a2ffbe30b721f2","modified":1640833475728},{"_id":"source/_posts/spring-autoconfigurations.md","hash":"58068fe1fb8a1554de810ddcc3357dfe1ca657b4","modified":1640833490332},{"_id":"themes/next/.editorconfig","hash":"731c650ddad6eb0fc7c3d4a91cad1698fe7ad311","modified":1635390119513},{"_id":"themes/next/.eslintrc.json","hash":"611e15c3fcb41dc68fa8532ee595a1262a1b5a8a","modified":1635390119513},{"_id":"themes/next/.gitattributes","hash":"aeeca2f1e987d83232d7870d1435a4e3ed66b648","modified":1635390119513},{"_id":"themes/next/.gitignore","hash":"087b7677078303acb2acb47432165950e4d29b43","modified":1635390119519},{"_id":"themes/next/.stylintrc","hash":"6259e2a0b65d46865ab89564b88fc67638668295","modified":1635390119520},{"_id":"themes/next/LICENSE.md","hash":"8cfb03967dd4cbaf3b825271ffce0039aa3fc22a","modified":1635390119520},{"_id":"themes/next/README.md","hash":"43fe29330352545446a532e6630866251129882a","modified":1635390119520},{"_id":"themes/next/_config.yml","hash":"1b0c2cb41687bf002f359e7ee7cceea27374d3a9","modified":1635412984372},{"_id":"themes/next/_vendors.yml","hash":"9875822de1108765fca9f299af68ad460169c1b1","modified":1635390119522},{"_id":"themes/next/crowdin.yml","hash":"4a53f5985e545c635cb56b2a57ed290cb8cf8942","modified":1635390119522},{"_id":"themes/next/package.json","hash":"6bffbde3c06fe12b2f51d42ea8686a11a7d8150c","modified":1635390119546},{"_id":"themes/next/renovate.json","hash":"767b077c7b615e20af3cf865813cd64674a9bea6","modified":1635390119546},{"_id":"themes/next/.githooks/install.js","hash":"305c2a269818466eed9e381b866c6cd1ad7f8afd","modified":1635390119514},{"_id":"themes/next/.githooks/pre-commit","hash":"b69b9d0b51e27d5d4c87c3242f5067c2cda26e44","modified":1635390119514},{"_id":"themes/next/.github/CODE_OF_CONDUCT.md","hash":"593ae64e72d43c020a697eac65b1f9c3483ff097","modified":1635390119514},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"2fdca1040427cabfe27cae6754ec5e027ec7092e","modified":1635390119515},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"a103e2d875f7434191859e5b42075cfa9a4cbcb3","modified":1635390119516},{"_id":"themes/next/.github/config.yml","hash":"0956bf71b6f36632b63b14d26580458041a5abd2","modified":1635390119516},{"_id":"themes/next/.github/issue_label_bot.yaml","hash":"533fbe6b2f87d7e7ec6949063bb7ea7eb4fbe52d","modified":1635390119517},{"_id":"themes/next/.github/label-commenter-config.yml","hash":"a1aa85a2fc66ff0c52c65bd97b0fa282e297a73f","modified":1635390119517},{"_id":"themes/next/.github/labeler.yml","hash":"ff76a903609932a867082b8ccced906e9910533a","modified":1635390119517},{"_id":"themes/next/.github/release-drafter.yml","hash":"de38f816e3023e0a5c1fd1f3c2b626f78bc35246","modified":1635390119517},{"_id":"themes/next/docs/AGPL3.md","hash":"f463f95b169d64983f59fa6f3e4b6760290a0e6b","modified":1635390119522},{"_id":"themes/next/docs/AUTHORS.md","hash":"579014d47f45b27fd1618b9709f0efe9585c7449","modified":1635390119522},{"_id":"themes/next/docs/LICENSE.txt","hash":"d1cd5a8e83d3bbdb50f902d2b487813da95ddfd3","modified":1635390119523},{"_id":"themes/next/languages/README.md","hash":"b1c96465b3bc139bf5ba6200974b66581d8ff85a","modified":1635390119524},{"_id":"themes/next/languages/ar.yml","hash":"cc7e3e2855348563d746f15c4752b9c63fcdd91a","modified":1635390119524},{"_id":"themes/next/languages/de.yml","hash":"83023c4246b93a2f89f342afe29a7b9e1185f74f","modified":1635390119525},{"_id":"themes/next/languages/default.yml","hash":"ea5e6aee4cb14510793ac4593a3bddffe23e530c","modified":1635390119525},{"_id":"themes/next/languages/en.yml","hash":"66445143decfbb5eb7031eb370698e31d5222a7a","modified":1635390119525},{"_id":"themes/next/languages/es.yml","hash":"07955d78028cea2a590c63fdc2c01ca3ee05a727","modified":1635390119525},{"_id":"themes/next/languages/fa.yml","hash":"e09fad889ab3ae87874093e1acd51edc9297d869","modified":1635390119526},{"_id":"themes/next/languages/fr.yml","hash":"328c255c82e9b561e20a9f51a4d84abc63d1b90a","modified":1635390119526},{"_id":"themes/next/languages/id.yml","hash":"d7c337ca72efb0bd02ade8b5560c559384ad84dd","modified":1635390119526},{"_id":"themes/next/languages/it.yml","hash":"c038ff0cadbe405750d980bcacfd3900acf96905","modified":1635390119526},{"_id":"themes/next/languages/ja.yml","hash":"57a35b21aca04ce8bca64fb5933f35626c462ea3","modified":1635390119526},{"_id":"themes/next/languages/ko.yml","hash":"d6e2add7488065ec4f7d21cfcf7f0eaa877a84f4","modified":1635390119527},{"_id":"themes/next/languages/nl.yml","hash":"e47858bd1e0d0622c15366ae6c0513d996f589e3","modified":1635390119527},{"_id":"themes/next/languages/pt-BR.yml","hash":"305025e932832328b7e2a8a584638a23c462e68f","modified":1635390119527},{"_id":"themes/next/languages/pt.yml","hash":"ff93459250c33d3c7ba06c30164cc4208edf9b33","modified":1635390119527},{"_id":"themes/next/languages/ru.yml","hash":"7d13108f4a70ff6a162508a49678e4a477fa7b56","modified":1635390119528},{"_id":"themes/next/languages/si.yml","hash":"c15ed758dbad890e856f4fc281208d7b78cc1a59","modified":1635390119528},{"_id":"themes/next/languages/tr.yml","hash":"d3262d2221b0583a52e5d20a3cd1380f5dc49378","modified":1635390119528},{"_id":"themes/next/languages/uk.yml","hash":"f32871f67c63d26bc4e3e15df9b01f5a41236a50","modified":1635390119528},{"_id":"themes/next/languages/vi.yml","hash":"e452ea8c48993262a3e8fce9d92072cafabfc734","modified":1635390119528},{"_id":"themes/next/languages/zh-CN.yml","hash":"f8379d15038e22ef7039d91272cb4f36842dbbe1","modified":1635390119529},{"_id":"themes/next/languages/zh-HK.yml","hash":"c1ee97ceb56da76ecdc7b69fa975f28c8574441b","modified":1635390119529},{"_id":"themes/next/languages/zh-TW.yml","hash":"70c45076ad722b777956048fcc430eac37844c11","modified":1635390119529},{"_id":"themes/next/layout/_layout.njk","hash":"2842f3e9fdde5bbd14cac89629221e68d80c8ea1","modified":1635390119529},{"_id":"themes/next/layout/archive.njk","hash":"aa491dba8f746e626c273a920effedf7d0b32170","modified":1635390119545},{"_id":"themes/next/layout/category.njk","hash":"c243c94abe62ec1e7da73067ac2db147f9a42416","modified":1635390119545},{"_id":"themes/next/layout/index.njk","hash":"92db3756ad46718a0cbb0d2bda02218bd865a63d","modified":1635390119545},{"_id":"themes/next/layout/page.njk","hash":"5fd0c362019eac987e17954dc85287b682195c76","modified":1635390119546},{"_id":"themes/next/layout/post.njk","hash":"707a50e50b90df5fbeaf8407d12895d04163a290","modified":1635390119546},{"_id":"themes/next/layout/tag.njk","hash":"64148c8f6b623391433595ae691ff64d7941d8af","modified":1635390119546},{"_id":"themes/next/test/index.js","hash":"983a505399796b9d9e174ba46d89abbdde38f8ee","modified":1635390119587},{"_id":"themes/next/.github/ISSUE_TEMPLATE/bug-report.md","hash":"032194e7975564176f2109aa8b7c020fa6d5e6b1","modified":1635390119515},{"_id":"themes/next/.github/ISSUE_TEMPLATE/config.yml","hash":"daeedc5da2ee74ac31cf71846b766ca6499e9fc6","modified":1635390119515},{"_id":"themes/next/.github/ISSUE_TEMPLATE/feature-request.md","hash":"4a7885fe2c8b25be02ab57c345cd862aeeeeacaf","modified":1635390119515},{"_id":"themes/next/.github/ISSUE_TEMPLATE/other.md","hash":"618d07b49f4774cd79613d4001984a19d954a6ad","modified":1635390119516},{"_id":"themes/next/.github/workflows/label-commenter.yml","hash":"7dec949b13131783e726facb2f4acde0945db1b8","modified":1635390119518},{"_id":"themes/next/.github/workflows/labeler.yml","hash":"46d0b29dc561fe571d91fd06a7c8ef606b984c72","modified":1635390119518},{"_id":"themes/next/.github/workflows/linter.yml","hash":"b57d876c90d1645a52bbba8a52d47ad0b0c96140","modified":1635390119518},{"_id":"themes/next/.github/workflows/lock.yml","hash":"58eca481fd71088a8ae1dbc04645bcfc03460b87","modified":1635390119518},{"_id":"themes/next/.github/workflows/release-drafter.yml","hash":"359b74890a47d784e35a5cc3c7885d5cdf302e82","modified":1635390119518},{"_id":"themes/next/.github/workflows/stale.yml","hash":"32e7dfb55ecf8af66aebfed471be09ef2eb10e18","modified":1635390119518},{"_id":"themes/next/.github/workflows/tester.yml","hash":"645bb69d0b6cc062c47fabb1ccb2297ccbcfa7f5","modified":1635390119519},{"_id":"themes/next/docs/ru/README.md","hash":"e1d6bf38cf34972ca2ee5331a727787fe14082a3","modified":1635390119523},{"_id":"themes/next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"7befb4325b107dd668d9eae3d7e86a34910ce3f2","modified":1635390119523},{"_id":"themes/next/docs/zh-CN/CONTRIBUTING.md","hash":"a09ceb82b45dd8b7da76c227f3d0bb7eebe7d5d1","modified":1635390119524},{"_id":"themes/next/docs/zh-CN/README.md","hash":"354b0b0a24cbe97cccf2ec8bd97eb7d624fa0dea","modified":1635390119524},{"_id":"themes/next/layout/_macro/post-collapse.njk","hash":"d9d8e6d7a6a8c80009dd5334cc17fd3e4977a008","modified":1635390119530},{"_id":"themes/next/layout/_macro/post.njk","hash":"e81c2c9f6f7c8c1395b6dd3ff67ed424a1c62394","modified":1635390119530},{"_id":"themes/next/layout/_macro/sidebar.njk","hash":"eec74e135d01948361020140c3798769e1e7363b","modified":1635390119530},{"_id":"themes/next/layout/_partials/comments.njk","hash":"d6b7bb7764e3b471ed6b4e5715f6cbe2dd453f59","modified":1635390119530},{"_id":"themes/next/layout/_partials/footer.njk","hash":"65f0d69084e0e26a0153d3b8db610a15c4102691","modified":1635390119531},{"_id":"themes/next/layout/_partials/languages.njk","hash":"537026fc120adeef9148c98ebf074207e3810538","modified":1635390119532},{"_id":"themes/next/layout/_partials/pagination.njk","hash":"2de77d533c91532a8a4052000244d0c1693370df","modified":1635390119534},{"_id":"themes/next/layout/_partials/widgets.njk","hash":"967594ee64805e27b7ff9d957e23ab3f5c948600","modified":1635390119538},{"_id":"themes/next/layout/_scripts/index.njk","hash":"4eb65641b47ea9b23ed2ddfd69b18f21d7d8f214","modified":1635390119538},{"_id":"themes/next/layout/_scripts/vendors.njk","hash":"0a1470440f11362df2b1cd6b6228e273d9f999d6","modified":1635390119538},{"_id":"themes/next/layout/_third-party/fancybox.njk","hash":"53ad3c31762b74e5d29787b37d5e494cc4fded9b","modified":1635390119541},{"_id":"themes/next/layout/_third-party/index.njk","hash":"33a4a3275474bd3bb2e8d1b0ea01b42dda9ea608","modified":1635390119542},{"_id":"themes/next/layout/_third-party/pace.njk","hash":"13b2a77b4858a127f458ea092b6f713b052befac","modified":1635390119543},{"_id":"themes/next/layout/_third-party/quicklink.njk","hash":"73bc15a9c3c5c239ab90efa19a1e721f41f3cb93","modified":1635390119543},{"_id":"themes/next/layout/_third-party/rating.njk","hash":"d0444179fec512760ab1d4f76928d795b971c884","modified":1635390119543},{"_id":"themes/next/scripts/events/index.js","hash":"8bca7ae3cebb3857866d718a562c5d8820fcfbe5","modified":1635390119547},{"_id":"themes/next/scripts/filters/default-injects.js","hash":"0c9a1fe9906672724dbf274154a37bac1915ca2c","modified":1635390119551},{"_id":"themes/next/scripts/filters/locals.js","hash":"8499b9c8c6cdae8aa7e4f5ec5b4b76037969db76","modified":1635390119551},{"_id":"themes/next/scripts/filters/minify.js","hash":"9789307212d729c8cb65e3541348938a1965ff6f","modified":1635390119551},{"_id":"themes/next/scripts/filters/post.js","hash":"5a132b7f9280a40b3d5fb40928c8cbbe071fe6f6","modified":1635390119551},{"_id":"themes/next/scripts/helpers/engine.js","hash":"18cc82558e7a9f3b6086c41ce9de0c46e807a66c","modified":1635390119551},{"_id":"themes/next/scripts/helpers/next-config.js","hash":"e73f43f1bcb46965e317285d6831e129a40ea59b","modified":1635390119552},{"_id":"themes/next/scripts/helpers/font.js","hash":"0a6fa582a0890ecaf5f03f758a730936e48aeca1","modified":1635390119552},{"_id":"themes/next/scripts/helpers/next-url.js","hash":"98fc68cf3fcd6253bbb94068ab1d86578a4ef9ea","modified":1635390119552},{"_id":"themes/next/scripts/helpers/next-vendors.js","hash":"52acbc74c1ead8a77cd3bbcba4e033053683f7d0","modified":1635390119552},{"_id":"themes/next/scripts/tags/button.js","hash":"86c71c73a63744efbbbb367612871fede0d69529","modified":1635390119553},{"_id":"themes/next/scripts/tags/caniuse.js","hash":"8e912c715702addaf0cefe63e580e45b97ae8c3f","modified":1635390119553},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"b4d12e6fe29089be0f43bafc9eea736602cd16bf","modified":1635390119553},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"4cf2002bcd5a6851aea68e9a1971e6399f5c3ed2","modified":1635390119553},{"_id":"themes/next/scripts/tags/index.js","hash":"255dd1090e8319b557eeca43571f0e4f8aab013b","modified":1635390119553},{"_id":"themes/next/scripts/tags/label.js","hash":"c18b0e619a779ed40be7f014db92af18f45fbd5c","modified":1635390119554},{"_id":"themes/next/scripts/tags/link-grid.js","hash":"3f358bb78c5c6fdf45de287f3ead553e3a6a93c2","modified":1635390119554},{"_id":"themes/next/scripts/tags/mermaid.js","hash":"b3844e168b51a99d495ca05562ffac47677f5728","modified":1635390119554},{"_id":"themes/next/scripts/tags/note.js","hash":"a12fd53e421400836a3722ae69130969558d6ac0","modified":1635390119555},{"_id":"themes/next/scripts/tags/pdf.js","hash":"317ba4611020cc840854386dde098dbbe452777e","modified":1635390119555},{"_id":"themes/next/scripts/tags/tabs.js","hash":"e0ed5fe1bc9d2957952a1aacdf3252d6ef3f9743","modified":1635390119555},{"_id":"themes/next/scripts/tags/video.js","hash":"f6ad3f52779f0636251238d3cbdc5b6f91cc5aba","modified":1635390119555},{"_id":"themes/next/source/css/_colors.styl","hash":"ae65cee0940b73b40f4f335c1d3cbc5ff600ef38","modified":1635390119556},{"_id":"themes/next/source/css/_mixins.styl","hash":"2ca820b221fb7458e6ef4fbcff826e1d1cf4b473","modified":1635390119571},{"_id":"themes/next/source/css/main.styl","hash":"38b8a12681a3a04bed02aa1659054912ed6def11","modified":1635390119575},{"_id":"themes/next/source/css/noscript.styl","hash":"7dc97674c232f6ca71e48b95e3f66472cd8e9c05","modified":1635390119576},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1635390119576},{"_id":"themes/next/source/images/avatar.gif","hash":"2dbc3e2f2d624b2ca1afe6edc2ca17307f1950c8","modified":1635390119576},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1635390119577},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1635390119577},{"_id":"themes/next/source/images/logo-algolia-nebula-blue-full.svg","hash":"b85e274207b1392782476a0430feac98db1e7da0","modified":1635390119577},{"_id":"themes/next/source/images/logo.svg","hash":"2cb74fd3ea2635e015eabc58a8d488aed6cf6417","modified":1635390119577},{"_id":"themes/next/source/js/bookmark.js","hash":"1457291a7244b7786ec35b949d97183e4fbd181d","modified":1635390119578},{"_id":"themes/next/source/js/comments-buttons.js","hash":"81ea6cbcdf0357094753d7523919c1eafa38e79f","modified":1635390119578},{"_id":"themes/next/source/js/comments.js","hash":"0b4daf0ce610760bd52e95d423f61f3e1c72442a","modified":1635390119578},{"_id":"themes/next/source/js/config.js","hash":"211a9ab35205ccfa6b7c74394bade84da0d00af7","modified":1635390119578},{"_id":"themes/next/source/js/motion.js","hash":"20b979ebe3671cb415e6e7171485d65cc347086e","modified":1635390119579},{"_id":"themes/next/source/js/next-boot.js","hash":"b0bdb542a809932182cfbb8772328115142a0b77","modified":1635390119579},{"_id":"themes/next/source/js/pjax.js","hash":"fd954af9b333e26574acafa1642eb7c86b85b7a2","modified":1635390119579},{"_id":"themes/next/source/js/schedule.js","hash":"6dade4388aa6579576a35758075134f573985d57","modified":1635390119579},{"_id":"themes/next/source/js/utils.js","hash":"c13fa66aae52f59f88881738c00ebdcaf0209496","modified":1635390119587},{"_id":"themes/next/test/helpers/font.js","hash":"6f5076bd3f2724e47b46ca69028393a9b6275cd1","modified":1635390119587},{"_id":"themes/next/test/helpers/index.js","hash":"2fb58dca3df2fe53116ee2b1232fa26ebe7b2ce5","modified":1635390119587},{"_id":"themes/next/test/helpers/next-url.js","hash":"08e84781f1cd54e5634b86877ad9cefae4a78e95","modified":1635390119587},{"_id":"themes/next/test/tags/button.js","hash":"a50ca44eaec3d91c2958e3157d624cd3e68828c7","modified":1635390119588},{"_id":"themes/next/test/tags/center-quote.js","hash":"2ac4b5a358681691a17e736de06fce0b640a7023","modified":1635390119588},{"_id":"themes/next/test/tags/caniuse.js","hash":"2852be850d9103c25114253a45e6c62e32517de4","modified":1635390119588},{"_id":"themes/next/test/tags/group-pictures.js","hash":"d7eb1d4402bf96485e69d5944db6aef8f10c8097","modified":1635390119588},{"_id":"themes/next/test/tags/index.js","hash":"5cad001936a694bf32d59751cc2b68a66199f976","modified":1635390119588},{"_id":"themes/next/test/tags/label.js","hash":"6cad7d84c42511459a89cda3971e8ea5cdee0125","modified":1635390119588},{"_id":"themes/next/test/tags/link-grid.js","hash":"41730266306c02362258384cd73659223928361f","modified":1635390119589},{"_id":"themes/next/test/tags/mermaid.js","hash":"f718a3d0e303d842e2ca5a3b162539a49e45a520","modified":1635390119589},{"_id":"themes/next/test/tags/note.js","hash":"161a81ce749e239d2403681372d48ecc1b51d7b9","modified":1635390119589},{"_id":"themes/next/test/tags/pdf.js","hash":"2d114596a8a180b2f3cd2a9c6528a328961f12d4","modified":1635390119589},{"_id":"themes/next/test/tags/tabs.js","hash":"b19d2592347eae5d6a7a97ca7e8cec03e8f25b51","modified":1635390119590},{"_id":"themes/next/test/tags/video.js","hash":"88db9a3a26cd35525c43c0339fcd1c5965ec9518","modified":1635390119590},{"_id":"themes/next/test/validate/index.js","hash":"560862194991c5963da5a411629d8e6c71d20ee2","modified":1635390119590},{"_id":"themes/next/layout/_partials/head/head-unique.njk","hash":"bd87e3a877ebab4508fc2b48b41c96b45c4dd970","modified":1635390119531},{"_id":"themes/next/layout/_partials/head/head.njk","hash":"abcc550cb14374fb7452d6edee63967ad9583d1c","modified":1635390119531},{"_id":"themes/next/layout/_partials/header/brand.njk","hash":"5d02ca876f25038c9f9e1d789c6ebae9ef71ae00","modified":1635390119531},{"_id":"themes/next/layout/_partials/header/index.njk","hash":"2f550b53372ec150c2538f216399995b8c003a21","modified":1635390119532},{"_id":"themes/next/layout/_partials/header/menu-item.njk","hash":"f066390762faf6684a523e2eb943420023aac2b1","modified":1635390119532},{"_id":"themes/next/layout/_partials/header/menu.njk","hash":"cb841a7a5db322dacd18c23074be300460aa6353","modified":1635390119532},{"_id":"themes/next/layout/_partials/header/sub-menu.njk","hash":"940cad08a67e6c361214045096bd3cdffdf44fcf","modified":1635390119532},{"_id":"themes/next/layout/_partials/page/breadcrumb.njk","hash":"9c136edd2248e2d50c1f6110b75e2b75c299bbd7","modified":1635390119533},{"_id":"themes/next/layout/_partials/page/categories.njk","hash":"b352346dd2cb42f7eeaec5e39d9a2a353b029775","modified":1635390119533},{"_id":"themes/next/layout/_partials/page/page-header.njk","hash":"92553feb26f30f7fc9147bc4ef122908a9da06be","modified":1635390119533},{"_id":"themes/next/layout/_partials/page/schedule.njk","hash":"130e776575d634201d4f8ef3d78dc12624f19fde","modified":1635390119533},{"_id":"themes/next/layout/_partials/page/tags.njk","hash":"752df7d12360a077c51a25609916a3ecc1763bb3","modified":1635390119533},{"_id":"themes/next/layout/_partials/post/post-copyright.njk","hash":"0ebc0142abebbeef4278e32abb543c7d7fa75d88","modified":1635390119535},{"_id":"themes/next/layout/_partials/post/post-followme.njk","hash":"ebf83083856f8bd81ad47ffb985d44e338b4e6bb","modified":1635390119535},{"_id":"themes/next/layout/_partials/post/post-footer.njk","hash":"e3502059bcc443ce932946a9891fcbe8b2bb362d","modified":1635390119535},{"_id":"themes/next/layout/_partials/post/post-meta.njk","hash":"2d99d7f355770f16934f5a3836887b118fb4d4bb","modified":1635390119535},{"_id":"themes/next/layout/_partials/post/post-related.njk","hash":"80d3dac42740d2aef677e25165e31c05eb048887","modified":1635390119536},{"_id":"themes/next/layout/_partials/post/post-reward.njk","hash":"58b3f657a47bae406e5fcf19cd5e42680785ac71","modified":1635390119536},{"_id":"themes/next/layout/_partials/search/algolia-search.njk","hash":"93fbb449fbd599cb4315d7eb0daeb239811b233f","modified":1635390119536},{"_id":"themes/next/layout/_partials/search/index.njk","hash":"9766852e72c1809d8c1eea71ac6116b4cc0886d2","modified":1635390119537},{"_id":"themes/next/layout/_partials/search/localsearch.njk","hash":"f73d25a8ccfdd5d4ca2953dc434ff8ce36034c57","modified":1635390119537},{"_id":"themes/next/layout/_partials/sidebar/site-overview.njk","hash":"0b96ee7ccd602e0ee3fc6db47228803771308d4f","modified":1635390119537},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.njk","hash":"3e80332f88b101141be69f2a07f54ed8c053eabb","modified":1635390119538},{"_id":"themes/next/layout/_third-party/analytics/cloudflare.njk","hash":"c7cea42f6db2137c11ca1d83e43fcb7ad7ccfb89","modified":1635390119539},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.njk","hash":"52ad137450f7b3d6a330e16b3ed1c6174290f0eb","modified":1635390119539},{"_id":"themes/next/layout/_third-party/analytics/growingio.njk","hash":"9ff9ec05c2037beea229a6bb698f9e3546973220","modified":1635390119539},{"_id":"themes/next/layout/_third-party/analytics/index.njk","hash":"465fcffd4216f8ca0ea2613fe9cf7308f71b9da5","modified":1635390119539},{"_id":"themes/next/layout/_third-party/chat/chatra.njk","hash":"09d2c9487d75894d45a823e3237ae9f90fd6ee01","modified":1635390119540},{"_id":"themes/next/layout/_third-party/chat/gitter.njk","hash":"375a86f0b19e130cfa7707007e3a53d9ae7c9b64","modified":1635390119540},{"_id":"themes/next/layout/_third-party/chat/tidio.njk","hash":"3fbc72427c1211e5dcfd269af1a74852a7ba5c1a","modified":1635390119540},{"_id":"themes/next/layout/_third-party/comments/changyan.njk","hash":"5f7967bd946060f4102263a552ddfbae9975e7ea","modified":1635390119540},{"_id":"themes/next/layout/_third-party/comments/disqus.njk","hash":"b0828dd1b1fd66ecd612d9e886a08e7579e9a4f7","modified":1635390119540},{"_id":"themes/next/layout/_third-party/comments/disqusjs.njk","hash":"c5086b4c35f730f82c99c4a8317f2f153ebde869","modified":1635390119540},{"_id":"themes/next/layout/_third-party/comments/gitalk.njk","hash":"6fd4df5c21cfe530dbb0c012bc0b202f2c362b9c","modified":1635390119540},{"_id":"themes/next/layout/_third-party/comments/isso.njk","hash":"38badcc7624a13961381c2465478056b9602aee5","modified":1635390119541},{"_id":"themes/next/layout/_third-party/comments/livere.njk","hash":"b8e0d5de584cece5e05b03db5b86145aa1e422b4","modified":1635390119541},{"_id":"themes/next/layout/_third-party/comments/utterances.njk","hash":"a7921be7328e1509d33b435175f5333a9aada66f","modified":1635390119541},{"_id":"themes/next/layout/_third-party/math/index.njk","hash":"1856c4b035c5b8e64300a11af0461b519dfc4cf4","modified":1635390119542},{"_id":"themes/next/layout/_third-party/math/katex.njk","hash":"a84db8bc8804335f95609a221ac1746433dcdc89","modified":1635390119542},{"_id":"themes/next/layout/_third-party/math/mathjax.njk","hash":"a62aa1ed4e35b8d0451d83f341bf0a97538bc9a4","modified":1635390119542},{"_id":"themes/next/layout/_third-party/search/algolia-search.njk","hash":"67f67a77f27103177b9940446f43610229536d82","modified":1635390119543},{"_id":"themes/next/layout/_third-party/search/localsearch.njk","hash":"210c32b654adae3d8076c4417d370b42af258cea","modified":1635390119543},{"_id":"themes/next/layout/_third-party/statistics/busuanzi-counter.njk","hash":"d97790e4b442a1e3ded7d7b4f84b8ee6cdb6e8ea","modified":1635390119544},{"_id":"themes/next/layout/_third-party/statistics/firestore.njk","hash":"af5336e8bbdc4638435971da115bb7443d374ade","modified":1635390119544},{"_id":"themes/next/layout/_third-party/statistics/index.njk","hash":"866ffa15a3250678eb8a90aa6f609fa965db90fd","modified":1635390119544},{"_id":"themes/next/layout/_third-party/statistics/lean-analytics.njk","hash":"8703d1855bb8d251c9b7c2940b7e3be525e53000","modified":1635390119544},{"_id":"themes/next/layout/_third-party/tags/mermaid.njk","hash":"dd8f963acd5a3685be46fd5319c06df0308d99b2","modified":1635390119544},{"_id":"themes/next/layout/_third-party/tags/pdf.njk","hash":"0386c708975cc5faea4f782611c5d2c6b8ac2850","modified":1635390119545},{"_id":"themes/next/scripts/events/lib/config.js","hash":"a912944cae0d864458d365867b8a9c89f348e68a","modified":1635390119547},{"_id":"themes/next/scripts/events/lib/highlight.js","hash":"00cec6980cafd417def885f496371856cd524a25","modified":1635390119547},{"_id":"themes/next/scripts/events/lib/injects.js","hash":"1f1ea7b579a49f17574c31d78d663c54896133eb","modified":1635390119548},{"_id":"themes/next/scripts/events/lib/utils.js","hash":"8508e96a5f883a5a57d8c1b8b5ea438fa29aafd3","modified":1635390119548},{"_id":"themes/next/scripts/events/lib/vendors.js","hash":"2f7057a8d3fce08aa7e2a17d7b7a1f03ac3d8ed6","modified":1635390119548},{"_id":"themes/next/scripts/filters/comment/changyan.js","hash":"cfff8331fdaa2ede4ab08c58cfc6d98c7d2374d9","modified":1635390119549},{"_id":"themes/next/scripts/filters/comment/common.js","hash":"713056d33dbcd8e9748205c5680b456c21174f4e","modified":1635390119549},{"_id":"themes/next/scripts/filters/comment/default-config.js","hash":"1cb58aa6b88f7461c3c3f9605273686adcc30979","modified":1635390119549},{"_id":"themes/next/scripts/filters/comment/disqus.js","hash":"3283bdd6e5ac7d10376df8ddd5faaec5dc1bd667","modified":1635390119549},{"_id":"themes/next/scripts/filters/comment/disqusjs.js","hash":"70eb507ef7f1a4fc3ca71a3814cc57afe7f3f60c","modified":1635390119549},{"_id":"themes/next/scripts/filters/comment/gitalk.js","hash":"96e58efba0dc76af409cc7d2db225f0fe4526ea8","modified":1635390119549},{"_id":"themes/next/scripts/filters/comment/isso.js","hash":"c22cbccd7d514947e084eeac6a3af1aa41ec857a","modified":1635390119550},{"_id":"themes/next/scripts/filters/comment/livere.js","hash":"bb8ebb541c40362c0cbbd8e83d3b777302bb6c40","modified":1635390119550},{"_id":"themes/next/scripts/filters/comment/utterances.js","hash":"a50718c081685fd35ff8ea9ca13682c284399ed8","modified":1635390119550},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"c4537fa2de33d98baff2c87a73801770414e0b69","modified":1635390119574},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"ee5024be8e39605f0c6d71db038e15e0693d0f41","modified":1635390119574},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"d3a8f6e71c86926d0c2a247a31d7446d829736d5","modified":1635390119575},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"58014a2d087c4126058a99b5b1cb7d8a2eb6224d","modified":1635390119575},{"_id":"themes/next/source/css/_variables/base.styl","hash":"d8882613736f43cab31bd5e1aa4e1265e903d305","modified":1635390119575},{"_id":"themes/next/source/js/schemes/muse.js","hash":"e18fc7074a580509dd5f966eb55428eb86730393","modified":1635390119580},{"_id":"themes/next/source/js/third-party/fancybox.js","hash":"8a847a7bbdbc0086dd1de12b82107a854b43f5e5","modified":1635390119583},{"_id":"themes/next/source/js/third-party/pace.js","hash":"0ebee77b2307bf4b260afb06c060171ef42b7141","modified":1635390119584},{"_id":"themes/next/source/js/third-party/quicklink.js","hash":"539c5bb51244f7f4aa98884f3229d128c1cefc40","modified":1635390119585},{"_id":"themes/next/source/js/third-party/rating.js","hash":"a1f44247c18ac00ee3e0026560398429e4c77dd7","modified":1635390119585},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"2bbf9046ef2a8f99ef3668bbb8be4e52e9d97bb7","modified":1635390119556},{"_id":"themes/next/source/css/_common/components/index.styl","hash":"991c1f80995cec418dc00d3d6b13e2d911ac9894","modified":1635390119556},{"_id":"themes/next/source/css/_common/components/reading-progress.styl","hash":"f3defd56be33dba4866a695396d96c767ce63182","modified":1635390119560},{"_id":"themes/next/source/css/_common/outline/index.styl","hash":"7782dfae7a0f8cd61b936fa8ac980440a7bbd3bb","modified":1635390119563},{"_id":"themes/next/source/css/_common/outline/mobile.styl","hash":"2db4462e9cb87b8aef3f50f850fed407de16da3e","modified":1635390119563},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"ca4d03a96ccc606151cf3f6ae8c9cea7fdc86bf7","modified":1635390119566},{"_id":"themes/next/source/css/_common/scaffolding/buttons.styl","hash":"f768ecb2fe3e9384777c1c115cd7409e9155edd7","modified":1635390119566},{"_id":"themes/next/source/css/_common/scaffolding/comments.styl","hash":"cf8446f4378dcab27b55ede1635c608ae6b8a5c8","modified":1635390119566},{"_id":"themes/next/source/css/_common/scaffolding/index.styl","hash":"43045d115f8fe95732c446aa45bf1c97609ff2a5","modified":1635390119567},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"6d740699fb6a7640647a8fd77c4ea4992d8d6437","modified":1635390119568},{"_id":"themes/next/source/css/_common/scaffolding/pagination.styl","hash":"34416a5792d0235caa8c0c7e59725f2df0fa614c","modified":1635390119568},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"b9388016f8d9274703e77e306a1feaad1b7b9d6c","modified":1635390119569},{"_id":"themes/next/source/css/_common/scaffolding/toggles.styl","hash":"90f7d3baab061e860172b536c9edc38c7fd2ef5c","modified":1635390119571},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"f51b6a4f06359ed56b2d10caa6f15362d3b3751d","modified":1635390119571},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"b1054313ca9419e76fea0451417c881616f50a38","modified":1635390119572},{"_id":"themes/next/source/css/_schemes/Mist/_layout.styl","hash":"00366a6bd1a66f99f845c5ebfc9e8cf56651b815","modified":1635390119572},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"f337981f8f20944ed366694aea88146c7b0a13ab","modified":1635390119572},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expand.styl","hash":"c9a9e07b721bb2376e24753ae0a9452431439114","modified":1635390119572},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"89bf3f6b82cb0fafbbd483431df8f450857c5a0b","modified":1635390119572},{"_id":"themes/next/source/css/_schemes/Muse/_header.styl","hash":"fd89988442f380cba907752fe3f608e3498f8c93","modified":1635390119573},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"018b6a761e197086174c9f06b4d5ea21cc230951","modified":1635390119573},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"28030c61288cc0e1321b18373a5c79029fd76a53","modified":1635390119573},{"_id":"themes/next/source/css/_schemes/Muse/_sidebar.styl","hash":"134272cb8096156c9e32fbbe085394633c7509cd","modified":1635390119573},{"_id":"themes/next/source/css/_schemes/Muse/_sub-menu.styl","hash":"2d3e05015796a790abd9d68957a5c698c0c9f9b6","modified":1635390119573},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"25c2a7930da14f023329df20f38df2728057fb4d","modified":1635390119573},{"_id":"themes/next/source/css/_schemes/Pisces/_header.styl","hash":"9b2cba0c9aa5a64957294f7548c199db1f63f0f4","modified":1635390119573},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"9f60d501808f67d151af437221d0dfacc27c180c","modified":1635390119573},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"1d29eca70fa686d895f8e98a283e4a159e40905a","modified":1635390119573},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"42bf453def88da82c842dca84e8f47087091f08e","modified":1635390119573},{"_id":"themes/next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"b5c3dd08c520a16ee49f85fa12b4935e725ef261","modified":1635390119573},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"7905f428b46d100ac5928875cb1e2b99fa86fc0b","modified":1635390119574},{"_id":"themes/next/source/js/third-party/analytics/baidu-analytics.js","hash":"f9579a02599de063ccff336177ba964a2931a6e9","modified":1635390119580},{"_id":"themes/next/source/js/third-party/analytics/google-analytics.js","hash":"d77d4934d959e7125128754b568f1d041c3fbfff","modified":1635390119580},{"_id":"themes/next/source/js/third-party/analytics/growingio.js","hash":"f755e8537ccbbb0bd84c26923f320d4e206e7428","modified":1635390119580},{"_id":"themes/next/source/js/third-party/chat/chatra.js","hash":"72e0766752b78a723fb30e92d533a8b353104e2d","modified":1635390119581},{"_id":"themes/next/source/js/third-party/chat/gitter.js","hash":"14b024c920a8b359777d79dd8e1a849387f8f3ad","modified":1635390119581},{"_id":"themes/next/source/js/third-party/chat/tidio.js","hash":"77c231bcd64f1c09bd9989909e9fee703b65f47f","modified":1635390119581},{"_id":"themes/next/source/js/third-party/comments/changyan.js","hash":"b1dd519dc3b1153c9d2ba2d35f68ca8f73f33bae","modified":1635390119581},{"_id":"themes/next/source/js/third-party/comments/disqus.js","hash":"5460de247c038d6cfbe774d7f8747f0a958d9017","modified":1635390119582},{"_id":"themes/next/source/js/third-party/comments/disqusjs.js","hash":"1c282d6c2151346d1f0aa95055d17abe77054ec9","modified":1635390119582},{"_id":"themes/next/source/js/third-party/comments/gitalk.js","hash":"1e8509356fb027d948d118ab220d9631f4d482fa","modified":1635390119582},{"_id":"themes/next/source/js/third-party/comments/isso.js","hash":"b9b9fd2f0e098a123b34a4932da912a9485ffe6c","modified":1635390119582},{"_id":"themes/next/source/js/third-party/comments/livere.js","hash":"68892d74ef5fc308c6e7e6b4f190826d79f3055d","modified":1635390119582},{"_id":"themes/next/source/js/third-party/comments/utterances.js","hash":"ec44d7f1c8b51b0aa3cccba099a78f3575ac828c","modified":1635390119583},{"_id":"themes/next/source/js/third-party/math/katex.js","hash":"5c63ec71458b4fe0cd98fd4a04e11c3746764f11","modified":1635390119583},{"_id":"themes/next/source/js/third-party/math/mathjax.js","hash":"d93556184b2c0aa1dbc4a6fb892d2f77b80d7d9f","modified":1635390119583},{"_id":"themes/next/source/js/third-party/search/algolia-search.js","hash":"ea94731438d8c518d946601f8f46a65b92381fac","modified":1635390119585},{"_id":"themes/next/source/js/third-party/search/local-search.js","hash":"dc2b0e89aa32afc7f7a7e2d7a277dadb7f96e06d","modified":1635390119585},{"_id":"themes/next/source/js/third-party/statistics/firestore.js","hash":"d0829fe41d2fe86b8499e2a896556c1275ea0066","modified":1635390119586},{"_id":"themes/next/source/js/third-party/statistics/lean-analytics.js","hash":"6abdc209f4503d4efd676e18bc30ddea813b6ff9","modified":1635390119586},{"_id":"themes/next/source/js/third-party/tags/mermaid.js","hash":"2618135cbcee6bf228f6734767de1995e5eaaac6","modified":1635390119586},{"_id":"themes/next/source/js/third-party/tags/pdf.js","hash":"e109c2d6828f527f0289d5fa3bb02fce63ee6d93","modified":1635390119586},{"_id":"themes/next/source/css/_common/components/pages/breadcrumb.styl","hash":"fde10ce94e9ae21a03b60d41d532835b54abdcb1","modified":1635390119556},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"80595d274f593b321c0b644a06f3165fe07b16f5","modified":1635390119557},{"_id":"themes/next/source/css/_common/components/pages/index.styl","hash":"6cf78a379bb656cc0abb4ab80fcae60152ce41ad","modified":1635390119557},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"091b8c763e43447d087c122a86538f290f83136a","modified":1635390119557},{"_id":"themes/next/source/css/_common/components/pages/tag-cloud.styl","hash":"56d719bcdcba3d725141c55bbd4b168f3942f912","modified":1635390119557},{"_id":"themes/next/source/css/_common/components/post/index.styl","hash":"df2fbd0ada00f37439b0de965c6f1c29d3c97429","modified":1635390119557},{"_id":"themes/next/source/css/_common/components/post/post-body.styl","hash":"7a34d020877273dcf11c25fa481409300efb8659","modified":1635390119558},{"_id":"themes/next/source/css/_common/components/post/post-footer.styl","hash":"e53a5eb1d1771e284044bdb0bc0ed2de27923669","modified":1635390119558},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"c34936a17c3d8af6c0988ac6746d7509dc0b50eb","modified":1635390119559},{"_id":"themes/next/source/css/_common/components/post/post-header.styl","hash":"4d29b6ae7ed3dc44b10df851a4128b6441efa8be","modified":1635390119559},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"69dff7cf231d01f85671758455726dd666664a73","modified":1635390119560},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"9043d9bc2db35ca000c79258ef89fdb161dc43fb","modified":1635390119560},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"0a779f955a0e25df0852e0731517dadb234aa181","modified":1635390119560},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"eebe3013a9a976011570dce2d04dfeae4c31d790","modified":1635390119558},{"_id":"themes/next/source/css/_common/components/third-party/gitalk.styl","hash":"fb165c1a0d990c5cf98b87773e0dc50410229b96","modified":1635390119560},{"_id":"themes/next/source/css/_common/components/third-party/index.styl","hash":"8df4b0023880ebe10de6b28d951e59286fba97e3","modified":1635390119560},{"_id":"themes/next/source/css/_common/components/third-party/math.styl","hash":"1e5776ad4c5c8bcf7596ac74dcabc30704b3f5a0","modified":1635390119561},{"_id":"themes/next/source/css/_common/components/post/post-followme.styl","hash":"791bc9befb0d4d06e3e517eccfe0bc3551a02a60","modified":1635390119558},{"_id":"themes/next/source/css/_common/components/third-party/related-posts.styl","hash":"0527153aa821bdbdb84c7b47f60e3cefd95a742f","modified":1635390119561},{"_id":"themes/next/source/css/_common/components/third-party/search.styl","hash":"ab5e2023e863ba6ca6ba4d288fea2877dcd3ad82","modified":1635390119561},{"_id":"themes/next/source/css/_common/components/third-party/utterances.styl","hash":"d28856f365a9373c4ae6fe1e5673d63df2dfd65f","modified":1635390119561},{"_id":"themes/next/source/css/_common/outline/footer/index.styl","hash":"02b6d1a53f7a02c6b0929b11f3ab904b5b873a0e","modified":1635390119562},{"_id":"themes/next/source/css/_common/outline/header/bookmark.styl","hash":"c8648c8ea3105556be0068d9fb2735261d0d94bc","modified":1635390119562},{"_id":"themes/next/source/css/_common/outline/header/github-banner.styl","hash":"05af22f3edc2383a3d97ec4c05e9ac43b014bead","modified":1635390119562},{"_id":"themes/next/source/css/_common/outline/header/menu.styl","hash":"2db695204d39e4c7daa7b91585a0ea4b06b49f11","modified":1635390119563},{"_id":"themes/next/source/css/_common/outline/header/index.styl","hash":"67fc7a1eb59c8451eec34e572cbb2fd1424757bc","modified":1635390119562},{"_id":"themes/next/source/css/_common/outline/header/site-meta.styl","hash":"aa1de16f693dd6aa66adc5728cce112f0b6fbe38","modified":1635390119563},{"_id":"themes/next/source/css/_common/outline/header/site-nav.styl","hash":"d9bc2b520636b9df7f946295cd430593df4118ff","modified":1635390119563},{"_id":"themes/next/source/css/_common/outline/sidebar/index.styl","hash":"9964a96f9a647cfb16b97679eced79d07e084e6d","modified":1635390119564},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author-links.styl","hash":"2c2bfbc34b6f19d262ae7c041474985e12f4f4ad","modified":1635390119564},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author.styl","hash":"d8a028f532d562e6a86bb3b9c7b992e4b6dbbb51","modified":1635390119564},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-blogroll.styl","hash":"1c324d56ae83e96db2c4c6d63edd7ee51c936fc1","modified":1635390119564},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-button.styl","hash":"63d8f5f169c2b1c969928fc79244c5fe89ee484e","modified":1635390119564},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-dimmer.styl","hash":"57ed6770535ecb2e6485a0c87d4de6d6476368b9","modified":1635390119565},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-nav.styl","hash":"db4f3263b2b6551dd56bfdf33cceaf81661a3611","modified":1635390119565},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toc.styl","hash":"081345490271840855d1238b969dbf2e0a2bba8f","modified":1635390119566},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toggle.styl","hash":"6681ffe283f8a7e3c86310ef4f6ca1e499c1a19f","modified":1635390119566},{"_id":"themes/next/source/css/_common/outline/sidebar/site-state.styl","hash":"2de038def2cb91da143b14696366c14a66e0e569","modified":1635390119566},{"_id":"themes/next/source/css/_common/scaffolding/highlight/copy-code.styl","hash":"a4003e1408844568cb5102a5a111046cb19b2d31","modified":1635390119567},{"_id":"themes/next/source/css/_common/scaffolding/highlight/index.styl","hash":"5f706f3382652835379cf9b9fec24ccd4513ab65","modified":1635390119567},{"_id":"themes/next/source/css/_common/scaffolding/tags/blockquote-center.styl","hash":"6b3680e0dbea8e14c1cec24ef63b7fae5e37f7ef","modified":1635390119569},{"_id":"themes/next/source/css/_common/scaffolding/tags/group-pictures.styl","hash":"8d9218980e185210ce034e9769ab639b9630fd88","modified":1635390119569},{"_id":"themes/next/source/css/_common/scaffolding/tags/index.styl","hash":"e22fde6f1657d311d46f64d868c4491d535c8caa","modified":1635390119569},{"_id":"themes/next/source/css/_common/scaffolding/tags/label.styl","hash":"531daf2612c6217950677a2d03924459ce57c291","modified":1635390119569},{"_id":"themes/next/source/css/_common/scaffolding/tags/link-grid.styl","hash":"7075dd32dd70da1e161e4bd14b46f1e8be62fa3c","modified":1635390119570},{"_id":"themes/next/source/css/_common/scaffolding/tags/mermaid.styl","hash":"c7754dc6c866928b538f0863a05b96ec44b5e986","modified":1635390119570},{"_id":"themes/next/source/css/_common/scaffolding/tags/note.styl","hash":"2e9dc3b3546e19e9de18050ad04b1741841116bc","modified":1635390119570},{"_id":"themes/next/source/css/_common/scaffolding/tags/pdf.styl","hash":"77122986509a6b4968bae2729417b7016137534c","modified":1635390119570},{"_id":"themes/next/source/css/_common/scaffolding/tags/tabs.styl","hash":"40a38f2129617ffd4e8d5cd78e982fdfc9941acf","modified":1635390119571},{"_id":"public/search.xml","hash":"341e7e75be26277488e74249351c7f765beddcce","modified":1640833652847},{"_id":"public/about/index.html","hash":"e83748bf7666e6a8419fb25ae343ae41bef750d3","modified":1640833652847},{"_id":"public/categories/index.html","hash":"a7667e4e635ac4b40fa8a054a23ae59cc70a11eb","modified":1640833652847},{"_id":"public/tags/index.html","hash":"c73309ac35b50d2647676868db58c8744d6849ef","modified":1640833652847},{"_id":"public/2021/11/22/serialization-deserialization/index.html","hash":"e210ae4d1fb71a450276aaae313ceb5548d5e9cf","modified":1640833652847},{"_id":"public/2021/11/04/java-inner-class/index.html","hash":"45d182f0c475eaaa0e20741eb4f56e19e5f4f79e","modified":1640833652847},{"_id":"public/2021/05/27/hello-world/index.html","hash":"cfc137857412e7e53861dbe822269c8cf659b906","modified":1640833652847},{"_id":"public/archives/index.html","hash":"c59d4772fcc784c84da48090869cd3817173a628","modified":1640833652847},{"_id":"public/archives/page/2/index.html","hash":"b5264a0ee5a96a693b8077c44ca47361bb012a35","modified":1640833652847},{"_id":"public/archives/2021/index.html","hash":"0232e162817cf48ec27eba40ba33662d0d40f1fd","modified":1640833652847},{"_id":"public/archives/2021/page/2/index.html","hash":"75a0c74528ed70535c2082795a793eb25672dea5","modified":1640833652847},{"_id":"public/archives/2021/05/index.html","hash":"df9f41c535cf41efd62e50bdfa5cbea4aafc0a2f","modified":1640833652847},{"_id":"public/archives/2021/06/index.html","hash":"3740a740d18aefaf8edd44c2349af624f6aae1a0","modified":1640833652847},{"_id":"public/archives/2021/07/index.html","hash":"578427c500a75b0478054bcf5efd8af018b19101","modified":1640833652847},{"_id":"public/archives/2021/08/index.html","hash":"bb6f1412c58bea93fe2ce8f4b8522d554bb746c0","modified":1640833652847},{"_id":"public/archives/2021/09/index.html","hash":"0a65a74fc06e3d9e497c2a2f62951f0b518be6bc","modified":1640833652847},{"_id":"public/archives/2021/10/index.html","hash":"758152f45da3c09a4c441ebaa59f1af752a0002d","modified":1640833652847},{"_id":"public/archives/2021/11/index.html","hash":"23f583ea5ffc7eb4ea79f42f925036975a4f88a7","modified":1640833652847},{"_id":"public/categories/Package-Manager/index.html","hash":"b229ae46ca579fd8b1b3e72445b2f12a34ce572b","modified":1640833652847},{"_id":"public/categories/Hexo/index.html","hash":"90e38ae21036274bcf9ebfe0f48fdea99c81962b","modified":1640833652847},{"_id":"public/categories/Java/index.html","hash":"44ec780f7195561f9274c77b7f6dc6640ac4317c","modified":1640833652847},{"_id":"public/categories/Pattern/index.html","hash":"a88f228d3a555adedcaf64c9f8bbda35453e00de","modified":1640833652847},{"_id":"public/categories/Java/Pattern/index.html","hash":"4ea4eaf4fb018880b4385de8bf675175ab0a9716","modified":1640833652847},{"_id":"public/categories//index.html","hash":"9faebbcf461ade7495f0c9b4940ceb6df2a71bc8","modified":1640833652847},{"_id":"public/categories/Spring/index.html","hash":"b51d9c5ac41a57dca9621da64825d38fdeacd8d4","modified":1640833652847},{"_id":"public/categories//index.html","hash":"3d820fda149f37b1b446898c45aad5d3ab364c08","modified":1640833652847},{"_id":"public/tags/ClassLoader/index.html","hash":"81c74e9b811d5724a43d976689b2e05287c63f18","modified":1640833652847},{"_id":"public/tags/factory-pattern/index.html","hash":"101feb9bcc69531d5c63ab6f2ebd4a805c729498","modified":1640833652847},{"_id":"public/tags/Proxy/index.html","hash":"556ab3605d2f9901e89663e96045f8912156aa46","modified":1640833652847},{"_id":"public/tags/Reflection/index.html","hash":"ac5783d178fc740372327cdc67bbe572c5d2a7cc","modified":1640833652847},{"_id":"public/tags/Stream/index.html","hash":"5a699c93445eea3b4dd90438734472a8b72c41bc","modified":1640833652847},{"_id":"public/tags/maven/index.html","hash":"b149e683a5f101c6c766c4f17555505bb4b6326f","modified":1640833652847},{"_id":"public/tags/Serialization/index.html","hash":"adc2ed1bd78da7b66e88d82a86393b109705f0d1","modified":1640833652847},{"_id":"public/tags/AOP/index.html","hash":"f9a4794fb744d588d128656c1054b3db3c6bcca8","modified":1640833652847},{"_id":"public/tags/Spring/index.html","hash":"ebabc387783cd3d89d0943102fd409ef411c7049","modified":1640833652847},{"_id":"public/tags/Turing/index.html","hash":"19131d9577ff00f5def217f65a980575b9589287","modified":1640833652847},{"_id":"public/2021/11/15/java-arraylist/index.html","hash":"8ada10876f95b98ee9c3bfbcb37daaad8954bf85","modified":1640833652847},{"_id":"public/2021/11/12/theory-turing-completeness/index.html","hash":"c8ef3727b4fddc7d205c40d9231ec8b4728f7d06","modified":1640833652847},{"_id":"public/2021/11/07/maven-wrapper/index.html","hash":"3c34bff746b0b47958596a1cc45fb285f878948f","modified":1640833652847},{"_id":"public/2021/11/02/java-chain-of-responsibility/index.html","hash":"78391c92bddd7326c44ca949057784c1e0bd387d","modified":1640833652847},{"_id":"public/2021/11/01/spring-autoconfigurations/index.html","hash":"b0f961273465e60c928691abfb9dfd65d1ab9f5a","modified":1640833652847},{"_id":"public/2021/10/05/professional-dictionary/index.html","hash":"96678e6a031b922f70a058d2a89adff1a4b09f7e","modified":1640833652847},{"_id":"public/2021/10/01/spring-aop/index.html","hash":"09d3df42fcb2b3d9c6fc048990fe922c3eefe9e9","modified":1640833652847},{"_id":"public/2021/09/28/spring-ioc/index.html","hash":"e4cf3003bd5306baac39eeb3601ebeeac340f14a","modified":1640833652847},{"_id":"public/2021/08/12/java-reflection/index.html","hash":"23d1989b0a5a9c00d62b707f464994f1d0f7a0a0","modified":1640833652847},{"_id":"public/2021/08/04/java-functional-programming/index.html","hash":"c7c17c6e7c4948a1a892062c1d01bdf6cf1c6a8d","modified":1640833652847},{"_id":"public/2021/08/01/java-proxy-and-dynamic-proxy/index.html","hash":"1f30406b80fc918dd4f15567dd147c8b5b179be0","modified":1640833652847},{"_id":"public/2021/07/24/java-annotation/index.html","hash":"bb481f846380e22a7c7c341c12d23b6be63cc9c4","modified":1640833652847},{"_id":"public/2021/07/03/java-factory-pattern/index.html","hash":"12ef67630b4e0334dab543192c46346bbc28e56f","modified":1640833652847},{"_id":"public/2021/06/19/build-multi-module-project-best-practice/index.html","hash":"3163f0d032f0173e6fe18f493c2a0eebe1ca0685","modified":1640833652847},{"_id":"public/2021/06/15/java-classloader/index.html","hash":"eba20476b5099e5a100c5015c0c171543ead88c6","modified":1640833652847},{"_id":"public/2021/06/07/java-streams/index.html","hash":"f621bf95974772a487d971bf214e87bc17c95ca1","modified":1640833652847},{"_id":"public/2021/05/28/hexo-build-guide/index.html","hash":"667c88a9aba566df38e9e381e21f57c011609f13","modified":1640833652847},{"_id":"public/index.html","hash":"a0365044b0540f7fe5c6fdb8e380e1f9300ecbd9","modified":1640833652847},{"_id":"public/page/2/index.html","hash":"3f2e648245480e44e71987638bcb60eb9bbea3ac","modified":1640833652847},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1640833652847},{"_id":"public/images/avatar.gif","hash":"2dbc3e2f2d624b2ca1afe6edc2ca17307f1950c8","modified":1640833652847},{"_id":"public/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1640833652847},{"_id":"public/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1640833652847},{"_id":"public/images/logo-algolia-nebula-blue-full.svg","hash":"b85e274207b1392782476a0430feac98db1e7da0","modified":1640833652847},{"_id":"public/images/logo.svg","hash":"2cb74fd3ea2635e015eabc58a8d488aed6cf6417","modified":1640833652847},{"_id":"public/css/noscript.css","hash":"54d14cd43dc297950a4a8d39ec9644dd5fc3499f","modified":1640833652847},{"_id":"public/js/bookmark.js","hash":"0f563ffbf05fad30e854e413ab17ff7164ab5a53","modified":1640833652847},{"_id":"public/js/comments-buttons.js","hash":"1a7344440321713426a0b2ab17e276b5bdf85ade","modified":1640833652847},{"_id":"public/js/comments.js","hash":"66ae2e26ea36a41b72c638ea8b220296638ae952","modified":1640833652847},{"_id":"public/js/config.js","hash":"4c4ebbe3b3f3841a26f9d5af6d0ba8bc6da01c54","modified":1640833652847},{"_id":"public/js/motion.js","hash":"6d4bd07a6f8e1b4083119dca0acb5b289533b619","modified":1640833652847},{"_id":"public/js/next-boot.js","hash":"48497e2156a10155dc42311633a110c9685692c9","modified":1640833652847},{"_id":"public/js/pjax.js","hash":"0523cb1946907687c53999e2ce7cfe1831da6476","modified":1640833652847},{"_id":"public/js/schedule.js","hash":"2b43e2d576a308289880befc27580dbb2aa34439","modified":1640833652847},{"_id":"public/js/utils.js","hash":"e447160d342b1f93df5214b6a733441039ced439","modified":1640833652847},{"_id":"public/js/schemes/muse.js","hash":"62f4638674c92dfb72454fee38751d0227d3d225","modified":1640833652847},{"_id":"public/js/third-party/fancybox.js","hash":"c098d14e65dd170537134358d4b8359ad0539c2c","modified":1640833652847},{"_id":"public/js/third-party/pace.js","hash":"0ef04218b93561ba4d0ff420d556c3d90a756d32","modified":1640833652847},{"_id":"public/js/third-party/quicklink.js","hash":"6f58cd7aa8f6f1ab92d5a96551add293f4e55312","modified":1640833652847},{"_id":"public/js/third-party/rating.js","hash":"4e92c2d107ba47b47826829f9668030d5ea9bfb8","modified":1640833652847},{"_id":"public/js/third-party/analytics/baidu-analytics.js","hash":"f629acc46ff40c071ffd31b77d5c7616f0fdd778","modified":1640833652847},{"_id":"public/js/third-party/analytics/google-analytics.js","hash":"59684383385059dc4f8a1ff85dbbeb703bcdbcb5","modified":1640833652847},{"_id":"public/js/third-party/analytics/growingio.js","hash":"78dd3cf04082b7dbe6246e404b2aa8e726922402","modified":1640833652847},{"_id":"public/js/third-party/chat/chatra.js","hash":"c32180522788c10e51df1803aa6842ef0432ddc9","modified":1640833652847},{"_id":"public/js/third-party/chat/gitter.js","hash":"cc38c94125f90dadde11b5ebac7d8bf99a1a08a2","modified":1640833652847},{"_id":"public/js/third-party/chat/tidio.js","hash":"b0079f6a4601e06ca6fe46e83a2f5af553e9bc3c","modified":1640833652847},{"_id":"public/js/third-party/comments/changyan.js","hash":"8c8ebec444c727b704ea41ad88b0b96ed2e4b8d4","modified":1640833652847},{"_id":"public/js/third-party/comments/disqus.js","hash":"e1cc671b0d524864fd445e3ab4ade9ee6d07e565","modified":1640833652847},{"_id":"public/js/third-party/comments/disqusjs.js","hash":"b6c58f098473b526d6a3cd35655caf34b77f7cff","modified":1640833652847},{"_id":"public/js/third-party/comments/gitalk.js","hash":"0ec038cf83e8ec067534f16a54041e47a3c1e59a","modified":1640833652847},{"_id":"public/js/third-party/comments/isso.js","hash":"753a873b6f566aff5ba77ca23f91b78eb880ca64","modified":1640833652847},{"_id":"public/js/third-party/comments/livere.js","hash":"2247d88c934c765c43013337860774aaa99f0b31","modified":1640833652847},{"_id":"public/js/third-party/comments/utterances.js","hash":"f67f90eb03e284c82da2b8cf2f1e31801813c16d","modified":1640833652847},{"_id":"public/js/third-party/math/katex.js","hash":"83c54ee536e487a1031783443fe0cb63b1b4767e","modified":1640833652847},{"_id":"public/js/third-party/math/mathjax.js","hash":"5c749b9c1c3bb738122d0516211ecff6496d4907","modified":1640833652847},{"_id":"public/js/third-party/search/algolia-search.js","hash":"ac401e3736d56a3c9cb85ab885744cce0b813c55","modified":1640833652847},{"_id":"public/js/third-party/search/local-search.js","hash":"45c485f82258d246f37deb66884bd2643323ef3a","modified":1640833652847},{"_id":"public/js/third-party/statistics/firestore.js","hash":"0960f16107ed61452fb0dffc6ed22dc143de34ef","modified":1640833652847},{"_id":"public/js/third-party/statistics/lean-analytics.js","hash":"5a928990856b8e456f0663cf3b6b406733672e39","modified":1640833652847},{"_id":"public/js/third-party/tags/mermaid.js","hash":"3dc4628efa6debd6490fc0ebddff2424a7b319d8","modified":1640833652847},{"_id":"public/js/third-party/tags/pdf.js","hash":"af78c22f0e61c8c8aa8794e585e0d632c6d4fcb8","modified":1640833652847},{"_id":"public/css/main.css","hash":"55a3a484a1fe5a96b589b73f0ee0550092ca909a","modified":1640833652847}],"Category":[{"name":"Package Manager","_id":"ckxsdzpy50004xotg087w2j5w"},{"name":"Hexo","_id":"ckxsdzpyd0009xotg7114am3u"},{"name":"Java","_id":"ckxsdzpyg000dxotgbnsjarwf"},{"name":"Pattern","_id":"ckxsdzpyr000mxotge5xqgrtr"},{"name":"Pattern","parent":"ckxsdzpyg000dxotgbnsjarwf","_id":"ckxsdzpyz0011xotgeu895910"},{"name":"","_id":"ckxsdzpz6001gxotg7vrz8bz1"},{"name":"Spring","_id":"ckxsdzpz8001lxotg3mw83p5p"},{"name":"","_id":"ckxsdzpzc001wxotgff1x5cxf"}],"Data":[],"Page":[{"title":"","date":"2017-10-28T03:27:47.000Z","_content":"\n, , ; API, API, \"\"\"\".\n\n: \nhttps://draveness.me/\n","source":"about/index.md","raw":"---\ntitle: \ndate: 2017-10-28 11:27:47\n---\n\n, , ; API, API, \"\"\"\".\n\n: \nhttps://draveness.me/\n","updated":"2021-12-30T02:46:02.120Z","path":"about/index.html","comments":1,"layout":"page","_id":"ckxsdzpxs0000xotg7ltq11rh","content":"<p>, , ; API, API, .</p>\n<p>:<br><a href=\"https://draveness.me/\">https://draveness.me/</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>, , ; API, API, .</p>\n<p>:<br><a href=\"https://draveness.me/\">https://draveness.me/</a></p>\n"},{"title":"","date":"2021-10-28T03:25:27.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: \ndate: 2021-10-28 11:25:27\ntype: \"categories\"\n---\n","updated":"2021-12-30T02:27:14.813Z","path":"categories/index.html","comments":1,"layout":"page","_id":"ckxsdzpy20002xotge4gfgokf","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"","date":"2021-05-28T03:25:33.000Z","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: \ndate: 2021-05-28 11:25:33\ntype: \"tags\"\n---\n","updated":"2021-12-30T02:26:18.244Z","path":"tags/index.html","comments":1,"layout":"page","_id":"ckxsdzpy80005xotg3cdb011g","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"","date":"2021-06-19T02:19:26.000Z","_content":"\ngradle, multi module\n\n# Creating simplest Gradle project for Java\nRedis Client, Jedis.\n\n1. Root Project, , `settings.gradle`\n```gradle\nrootProject.name = 'simplest-gradle-project'\n\n```\n2. root, gradle wrapper, `gradlew`, `gradlew.bat`, `gradle`(),  Spring Initializr .\n3. subproject`build.gradle`, ()\n```gradle\nplugins {\n\tid 'java'\n}\n\ngroup = 'org.demo'\nversion = '0.0.1-SNAPSHOT'\n\nrepositories {\n    maven {\n      url 'https://maven.aliyun.com/repository/public/'\n    }\n    maven {\n      url 'https://maven.aliyun.com/repository/spring/'\n    }\n    mavenLocal()\n    mavenCentral()\n}\n\ndependencies {\n\timplementation 'redis.clients:jedis:jedis-3.6.2'\n}\n```\n4. gradle tasksrc(build.gradle),  `./gradlew :createDirs`, IDEAgradle, `simplest-gradle-project > Tasks > other > createDirs`\n```gradle\n// src\ntask createDirs {\n    sourceSets*.java.srcDirs*.each{\n        it.mkdirs()\n    }\n    sourceSets*.resources.srcDirs*.each{\n        it.mkdirs()\n    }\n}\n```\n\n,\nhttps://spring.io/guides/gs/multi-module/\n\n# Creating a Multi Module Project\n1. Root Project, , `settings.gradle`()\n```gradle\nrootProject.name = 'gradle-multi-module'\n\ninclude 'subproject1'\ninclude 'subproject2'\n```\n2. root, gradle wrapper, `gradlew`, `gradlew.bat`, `gradle`(),  Spring Initializr .\n3. root, subprojects, `mkdir -p src/main/java/com/example/multimodule/service`\n4. subproject`build.gradle`, ():\n```gradle\nplugins {\n\tid 'org.springframework.boot' version '2.5.2'\n\tid 'io.spring.dependency-management' version '1.0.11.RELEASE'\n\tid 'java'\n}\n\ngroup = 'com.example'\nversion = '0.0.1-SNAPSHOT'\nsourceCompatibility = '1.8'\n\nrepositories {\n    maven {\n      url 'https://maven.aliyun.com/repository/public/'\n    }\n    maven {\n      url 'https://maven.aliyun.com/repository/spring/'\n    }\n    mavenLocal()\n    mavenCentral()\n}\n\ndependencies {\n\timplementation 'org.springframework.boot:spring-boot-starter'\n\ttestImplementation 'org.springframework.boot:spring-boot-starter-test'\n}\n```\n\n### Gradle\nGradle.\n\ngradlebuild tool, Maven. \n1. Gradle makes it easy to build common types of project  say Java libraries  by adding a layer of conventions and prebuilt functionality through plugins.\n2. Gradle models its builds as Directed Acyclic Graphs (DAGs) of tasks (units of work). What this means is that a build essentially configures a set of tasks and wires them together  based on their dependencies  to create that DAG. Once the task graph has been created, Gradle determines which tasks need to be run in which order and then proceeds to execute them. Gradletask, taskDAG. Javatask: check, assemble, jar, .\n: DSL . DSL  Domain Specific Language ;  DSL  GPL,  GPL ,  General Purpose Language  Objective-CJavaPython  C Regex, HTML, GradleGrovvy.  GPL DSL  CPython  Haskell  {% post_link theory-turing-completeness '' %} \n\n","source":"_posts/build-multi-module-project-best-practice.md","raw":"---\ntitle: \ndate: 2021-06-19 10:19:26\ncategories:\n- Package Manager\n---\n\ngradle, multi module\n\n# Creating simplest Gradle project for Java\nRedis Client, Jedis.\n\n1. Root Project, , `settings.gradle`\n```gradle\nrootProject.name = 'simplest-gradle-project'\n\n```\n2. root, gradle wrapper, `gradlew`, `gradlew.bat`, `gradle`(),  Spring Initializr .\n3. subproject`build.gradle`, ()\n```gradle\nplugins {\n\tid 'java'\n}\n\ngroup = 'org.demo'\nversion = '0.0.1-SNAPSHOT'\n\nrepositories {\n    maven {\n      url 'https://maven.aliyun.com/repository/public/'\n    }\n    maven {\n      url 'https://maven.aliyun.com/repository/spring/'\n    }\n    mavenLocal()\n    mavenCentral()\n}\n\ndependencies {\n\timplementation 'redis.clients:jedis:jedis-3.6.2'\n}\n```\n4. gradle tasksrc(build.gradle),  `./gradlew :createDirs`, IDEAgradle, `simplest-gradle-project > Tasks > other > createDirs`\n```gradle\n// src\ntask createDirs {\n    sourceSets*.java.srcDirs*.each{\n        it.mkdirs()\n    }\n    sourceSets*.resources.srcDirs*.each{\n        it.mkdirs()\n    }\n}\n```\n\n,\nhttps://spring.io/guides/gs/multi-module/\n\n# Creating a Multi Module Project\n1. Root Project, , `settings.gradle`()\n```gradle\nrootProject.name = 'gradle-multi-module'\n\ninclude 'subproject1'\ninclude 'subproject2'\n```\n2. root, gradle wrapper, `gradlew`, `gradlew.bat`, `gradle`(),  Spring Initializr .\n3. root, subprojects, `mkdir -p src/main/java/com/example/multimodule/service`\n4. subproject`build.gradle`, ():\n```gradle\nplugins {\n\tid 'org.springframework.boot' version '2.5.2'\n\tid 'io.spring.dependency-management' version '1.0.11.RELEASE'\n\tid 'java'\n}\n\ngroup = 'com.example'\nversion = '0.0.1-SNAPSHOT'\nsourceCompatibility = '1.8'\n\nrepositories {\n    maven {\n      url 'https://maven.aliyun.com/repository/public/'\n    }\n    maven {\n      url 'https://maven.aliyun.com/repository/spring/'\n    }\n    mavenLocal()\n    mavenCentral()\n}\n\ndependencies {\n\timplementation 'org.springframework.boot:spring-boot-starter'\n\ttestImplementation 'org.springframework.boot:spring-boot-starter-test'\n}\n```\n\n### Gradle\nGradle.\n\ngradlebuild tool, Maven. \n1. Gradle makes it easy to build common types of project  say Java libraries  by adding a layer of conventions and prebuilt functionality through plugins.\n2. Gradle models its builds as Directed Acyclic Graphs (DAGs) of tasks (units of work). What this means is that a build essentially configures a set of tasks and wires them together  based on their dependencies  to create that DAG. Once the task graph has been created, Gradle determines which tasks need to be run in which order and then proceeds to execute them. Gradletask, taskDAG. Javatask: check, assemble, jar, .\n: DSL . DSL  Domain Specific Language ;  DSL  GPL,  GPL ,  General Purpose Language  Objective-CJavaPython  C Regex, HTML, GradleGrovvy.  GPL DSL  CPython  Haskell  {% post_link theory-turing-completeness '' %} \n\n","slug":"build-multi-module-project-best-practice","published":1,"updated":"2021-12-30T02:59:47.716Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpxx0001xotg65yafs9i","content":"<p>gradle, multi module</p>\n<h1 id=\"Creating-simplest-Gradle-project-for-Java\"><a href=\"#Creating-simplest-Gradle-project-for-Java\" class=\"headerlink\" title=\"Creating simplest Gradle project for Java\"></a>Creating simplest Gradle project for Java</h1><p>Redis Client, Jedis.</p>\n<ol>\n<li>Root Project, , <code>settings.gradle</code><figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rootProject.name = <span class=\"string\">&#x27;simplest-gradle-project&#x27;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></li>\n<li>root, gradle wrapper, <code>gradlew</code>, <code>gradlew.bat</code>, <code>gradle</code>(),  Spring Initializr .</li>\n<li>subproject<code>build.gradle</code>, ()<figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plugins &#123;</span><br><span class=\"line\">\tid <span class=\"string\">&#x27;java&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">group</span> = <span class=\"string\">&#x27;org.demo&#x27;</span></span><br><span class=\"line\">version = <span class=\"string\">&#x27;0.0.1-SNAPSHOT&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">repositories</span> &#123;</span><br><span class=\"line\">    maven &#123;</span><br><span class=\"line\">      url <span class=\"string\">&#x27;https://maven.aliyun.com/repository/public/&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    maven &#123;</span><br><span class=\"line\">      url <span class=\"string\">&#x27;https://maven.aliyun.com/repository/spring/&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mavenLocal()</span><br><span class=\"line\">    mavenCentral()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">dependencies</span> &#123;</span><br><span class=\"line\">\timplementation <span class=\"string\">&#x27;redis.clients:jedis:jedis-3.6.2&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li>gradle tasksrc(build.gradle),  <code>./gradlew :createDirs</code>, IDEAgradle, <code>simplest-gradle-project &gt; Tasks &gt; other &gt; createDirs</code><figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src</span></span><br><span class=\"line\"><span class=\"keyword\">task</span> createDirs &#123;</span><br><span class=\"line\">    <span class=\"keyword\">sourceSets</span>*.java.srcDirs*.<span class=\"keyword\">each</span>&#123;</span><br><span class=\"line\">        it.mkdirs()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">sourceSets</span>*.resources.srcDirs*.<span class=\"keyword\">each</span>&#123;</span><br><span class=\"line\">        it.mkdirs()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ol>\n<p>,<br><a href=\"https://spring.io/guides/gs/multi-module/\">https://spring.io/guides/gs/multi-module/</a></p>\n<h1 id=\"Creating-a-Multi-Module-Project\"><a href=\"#Creating-a-Multi-Module-Project\" class=\"headerlink\" title=\"Creating a Multi Module Project\"></a>Creating a Multi Module Project</h1><ol>\n<li>Root Project, , <code>settings.gradle</code>()<figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rootProject.name = <span class=\"string\">&#x27;gradle-multi-module&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&#x27;subproject1&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&#x27;subproject2&#x27;</span></span><br></pre></td></tr></table></figure></li>\n<li>root, gradle wrapper, <code>gradlew</code>, <code>gradlew.bat</code>, <code>gradle</code>(),  Spring Initializr .</li>\n<li>root, subprojects, <code>mkdir -p src/main/java/com/example/multimodule/service</code></li>\n<li>subproject<code>build.gradle</code>, ():<figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plugins &#123;</span><br><span class=\"line\">\tid <span class=\"string\">&#x27;org.springframework.boot&#x27;</span> version <span class=\"string\">&#x27;2.5.2&#x27;</span></span><br><span class=\"line\">\tid <span class=\"string\">&#x27;io.spring.dependency-management&#x27;</span> version <span class=\"string\">&#x27;1.0.11.RELEASE&#x27;</span></span><br><span class=\"line\">\tid <span class=\"string\">&#x27;java&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">group</span> = <span class=\"string\">&#x27;com.example&#x27;</span></span><br><span class=\"line\">version = <span class=\"string\">&#x27;0.0.1-SNAPSHOT&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">sourceCompatibility</span> = <span class=\"string\">&#x27;1.8&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">repositories</span> &#123;</span><br><span class=\"line\">    maven &#123;</span><br><span class=\"line\">      url <span class=\"string\">&#x27;https://maven.aliyun.com/repository/public/&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    maven &#123;</span><br><span class=\"line\">      url <span class=\"string\">&#x27;https://maven.aliyun.com/repository/spring/&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mavenLocal()</span><br><span class=\"line\">    mavenCentral()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">dependencies</span> &#123;</span><br><span class=\"line\">\timplementation <span class=\"string\">&#x27;org.springframework.boot:spring-boot-starter&#x27;</span></span><br><span class=\"line\">\ttestImplementation <span class=\"string\">&#x27;org.springframework.boot:spring-boot-starter-test&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"Gradle\"><a href=\"#Gradle\" class=\"headerlink\" title=\"Gradle\"></a>Gradle</h3><p>Gradle.</p>\n<p>gradlebuild tool, Maven. </p>\n<ol>\n<li>Gradle makes it easy to build common types of project  say Java libraries  by adding a layer of conventions and prebuilt functionality through plugins.</li>\n<li>Gradle models its builds as Directed Acyclic Graphs (DAGs) of tasks (units of work). What this means is that a build essentially configures a set of tasks and wires them together  based on their dependencies  to create that DAG. Once the task graph has been created, Gradle determines which tasks need to be run in which order and then proceeds to execute them. Gradletask, taskDAG. Javatask: check, assemble, jar, .<br>: DSL . DSL  Domain Specific Language ;  DSL  GPL,  GPL ,  General Purpose Language  Objective-CJavaPython  C Regex, HTML, GradleGrovvy.  GPL DSL  CPython  Haskell  <a href=\"/2021/11/12/theory-turing-completeness/\" title=\"\"></a> </li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<p>gradle, multi module</p>\n<h1 id=\"Creating-simplest-Gradle-project-for-Java\"><a href=\"#Creating-simplest-Gradle-project-for-Java\" class=\"headerlink\" title=\"Creating simplest Gradle project for Java\"></a>Creating simplest Gradle project for Java</h1><p>Redis Client, Jedis.</p>\n<ol>\n<li>Root Project, , <code>settings.gradle</code><figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rootProject.name = <span class=\"string\">&#x27;simplest-gradle-project&#x27;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></li>\n<li>root, gradle wrapper, <code>gradlew</code>, <code>gradlew.bat</code>, <code>gradle</code>(),  Spring Initializr .</li>\n<li>subproject<code>build.gradle</code>, ()<figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plugins &#123;</span><br><span class=\"line\">\tid <span class=\"string\">&#x27;java&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">group</span> = <span class=\"string\">&#x27;org.demo&#x27;</span></span><br><span class=\"line\">version = <span class=\"string\">&#x27;0.0.1-SNAPSHOT&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">repositories</span> &#123;</span><br><span class=\"line\">    maven &#123;</span><br><span class=\"line\">      url <span class=\"string\">&#x27;https://maven.aliyun.com/repository/public/&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    maven &#123;</span><br><span class=\"line\">      url <span class=\"string\">&#x27;https://maven.aliyun.com/repository/spring/&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mavenLocal()</span><br><span class=\"line\">    mavenCentral()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">dependencies</span> &#123;</span><br><span class=\"line\">\timplementation <span class=\"string\">&#x27;redis.clients:jedis:jedis-3.6.2&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li>gradle tasksrc(build.gradle),  <code>./gradlew :createDirs</code>, IDEAgradle, <code>simplest-gradle-project &gt; Tasks &gt; other &gt; createDirs</code><figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src</span></span><br><span class=\"line\"><span class=\"keyword\">task</span> createDirs &#123;</span><br><span class=\"line\">    <span class=\"keyword\">sourceSets</span>*.java.srcDirs*.<span class=\"keyword\">each</span>&#123;</span><br><span class=\"line\">        it.mkdirs()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">sourceSets</span>*.resources.srcDirs*.<span class=\"keyword\">each</span>&#123;</span><br><span class=\"line\">        it.mkdirs()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ol>\n<p>,<br><a href=\"https://spring.io/guides/gs/multi-module/\">https://spring.io/guides/gs/multi-module/</a></p>\n<h1 id=\"Creating-a-Multi-Module-Project\"><a href=\"#Creating-a-Multi-Module-Project\" class=\"headerlink\" title=\"Creating a Multi Module Project\"></a>Creating a Multi Module Project</h1><ol>\n<li>Root Project, , <code>settings.gradle</code>()<figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rootProject.name = <span class=\"string\">&#x27;gradle-multi-module&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&#x27;subproject1&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&#x27;subproject2&#x27;</span></span><br></pre></td></tr></table></figure></li>\n<li>root, gradle wrapper, <code>gradlew</code>, <code>gradlew.bat</code>, <code>gradle</code>(),  Spring Initializr .</li>\n<li>root, subprojects, <code>mkdir -p src/main/java/com/example/multimodule/service</code></li>\n<li>subproject<code>build.gradle</code>, ():<figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plugins &#123;</span><br><span class=\"line\">\tid <span class=\"string\">&#x27;org.springframework.boot&#x27;</span> version <span class=\"string\">&#x27;2.5.2&#x27;</span></span><br><span class=\"line\">\tid <span class=\"string\">&#x27;io.spring.dependency-management&#x27;</span> version <span class=\"string\">&#x27;1.0.11.RELEASE&#x27;</span></span><br><span class=\"line\">\tid <span class=\"string\">&#x27;java&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">group</span> = <span class=\"string\">&#x27;com.example&#x27;</span></span><br><span class=\"line\">version = <span class=\"string\">&#x27;0.0.1-SNAPSHOT&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">sourceCompatibility</span> = <span class=\"string\">&#x27;1.8&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">repositories</span> &#123;</span><br><span class=\"line\">    maven &#123;</span><br><span class=\"line\">      url <span class=\"string\">&#x27;https://maven.aliyun.com/repository/public/&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    maven &#123;</span><br><span class=\"line\">      url <span class=\"string\">&#x27;https://maven.aliyun.com/repository/spring/&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mavenLocal()</span><br><span class=\"line\">    mavenCentral()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">dependencies</span> &#123;</span><br><span class=\"line\">\timplementation <span class=\"string\">&#x27;org.springframework.boot:spring-boot-starter&#x27;</span></span><br><span class=\"line\">\ttestImplementation <span class=\"string\">&#x27;org.springframework.boot:spring-boot-starter-test&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"Gradle\"><a href=\"#Gradle\" class=\"headerlink\" title=\"Gradle\"></a>Gradle</h3><p>Gradle.</p>\n<p>gradlebuild tool, Maven. </p>\n<ol>\n<li>Gradle makes it easy to build common types of project  say Java libraries  by adding a layer of conventions and prebuilt functionality through plugins.</li>\n<li>Gradle models its builds as Directed Acyclic Graphs (DAGs) of tasks (units of work). What this means is that a build essentially configures a set of tasks and wires them together  based on their dependencies  to create that DAG. Once the task graph has been created, Gradle determines which tasks need to be run in which order and then proceeds to execute them. Gradletask, taskDAG. Javatask: check, assemble, jar, .<br>: DSL . DSL  Domain Specific Language ;  DSL  GPL,  GPL ,  General Purpose Language  Objective-CJavaPython  C Regex, HTML, GradleGrovvy.  GPL DSL  CPython  Haskell  <a href=\"/2021/11/12/theory-turing-completeness/\" title=\"\"></a> </li>\n</ol>\n"},{"title":"Hello World","date":"2021-05-27T02:03:18.000Z","_content":"Welcome to [the-Rings](https://the-rings.github.io/)! This is your very first post.\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\ndate: 2021-05-27 10:03:18\n---\nWelcome to [the-Rings](https://the-rings.github.io/)! This is your very first post.\n","slug":"hello-world","published":1,"updated":"2021-12-30T03:00:20.035Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpy30003xotgea04atzf","content":"<p>Welcome to <a href=\"https://the-rings.github.io/\">the-Rings</a>! This is your very first post.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>Welcome to <a href=\"https://the-rings.github.io/\">the-Rings</a>! This is your very first post.</p>\n"},{"title":"Hexo","date":"2021-05-28T06:53:12.000Z","_content":"\ngithubHexoHTMLgithubyour-github-name.github.io\n\n## Github\n\n1. githubrepository`Repository name``[your-github-name].github.io`, , .\n2. repository, `Repository name``github-bolg`(), \n3. ssh`id_ras.pub` > settings > SSH keys\n\n## \n\n1. Node.js (npm)\n\n2. npm, , \n\n   - Windows, `C:\\Users\\your-user-name\\.npmrc`\n\n     ```\n       registry=https://registry.npm.taobao.org\n       prefix=D:\\apps\\nodejs\\node_global\n       cache=D:\\apps\\nodejs\\node_cache\n    ```\n\n3. `npm install -g hexo`\n\n4. `hexo init [your-project-name]`\n\n5. . : `hexo clean`&`hexo generate`&`hexo server`, `localhost:4000`\n\n6. \n\n   - `.deploy_git`&`.github`, \n   - `source/_posts`, soure`about`, `categoryies`, `tags`, `` , ``, ``. \n   - `themes`, \n   - `_config.yml`, , \n   - `package.json`&`package-lock.json`\n   - `public`, `[your-github-name].github.io`\n   - `node_modules`\n\n7. git, `.gitignore`\n\n    ```\n     .DS_Store\n     Thumbs.db\n     db.json\n     *.log\n     node_modules/\n     public/\n     .deploy*/\n    ```\n\n   - > gitignore`[github-blog]`repository, \n\n     ```shell\n     git init\n     git remote add origin [github-bolg repository ssh address]\n     # for example: $ git remote add origin git@github.com:the-Rings/github-blog.git\n     # github202012, &, ssh address, SSH keys\n     git add .\n     git commit -m \"something\"\n     git push --set-upstream main\n     # \n     ```\n\n8. `_config.yml``[your-github-name].github.io`public, git, hexo\n\n    ```yaml\n    # _config.ymldeploy\n    deploy:\n      type: git\n      repo: git@github.com:[your-github-name]/[your-github-name].github.io.git # SSH\n      branch: main # main\n    ```\n\n9. `npm install hexo-deployer-git --save`, github\n\n10. `hexo clean`&`hexo generate`&`hexo deploy`, .\n\n## \n\n1. `Next`, `theme/next`, , , \n\n   ```shell\n     hexo new page categories\n     hexo new page tags\n     hexo new page about\n   ```\n\n2. , `_config.yml``Extensions`, , `$ npm install hexo-generator-searchdb --save`\n\n    ```yaml\n     search:\n       path: search.xml\n       field: post\n       format: html\n       limit: 10000\n    ```\n\n   - , `theme/next/.config.yml``local_search: enable: true`\n\n3. UML\n    ```shell\n    npm install --save hexo-tag-plantuml\n    ```\n    : https://plantuml.com/zh/class-diagram\n    : https://www.plantuml.com/plantuml/uml/SyfFKj2rKt3CoKnELR1Io4ZDoSa70000\n    {% plantuml %}\n    Joinpoint <|-- Invocation\n    interface Joinpoint {}\n    interface Invocation {}\n    \n    Invocation <|-- MethodInvocation\n    interface MethodInvocation {}\n    \n    MethodInvocation <|-- ProxyMethodInvocation\n    interface ProxyMethodInvocation {}\n    \n    ProxyMethodInvocation <|.. ReflectiveMethodInvocation\n    {% endplantuml %}\n\n## \n1. {% post_link file_name \"display name\" %}\n\n## \n\n1. `hexo new post [new-blog-name]`, `source/_post/`, markdown, Typora\n2. \n3. , `git add `&`git commit`&`git push`\n4. `hexo clean`&`hexo generate`&`hexo deploy`\n\n\n# Troubleshooting\n\n1. `hexo generate`: `Template render error: (unknown path)`, , , `{% xxx %}``{ % xxx %}`, .","source":"_posts/hexo-build-guide.md","raw":"---\ntitle: Hexo\ndate: 2021-05-28 14:53:12\ncategories:\n- Hexo\n---\n\ngithubHexoHTMLgithubyour-github-name.github.io\n\n## Github\n\n1. githubrepository`Repository name``[your-github-name].github.io`, , .\n2. repository, `Repository name``github-bolg`(), \n3. ssh`id_ras.pub` > settings > SSH keys\n\n## \n\n1. Node.js (npm)\n\n2. npm, , \n\n   - Windows, `C:\\Users\\your-user-name\\.npmrc`\n\n     ```\n       registry=https://registry.npm.taobao.org\n       prefix=D:\\apps\\nodejs\\node_global\n       cache=D:\\apps\\nodejs\\node_cache\n    ```\n\n3. `npm install -g hexo`\n\n4. `hexo init [your-project-name]`\n\n5. . : `hexo clean`&`hexo generate`&`hexo server`, `localhost:4000`\n\n6. \n\n   - `.deploy_git`&`.github`, \n   - `source/_posts`, soure`about`, `categoryies`, `tags`, `` , ``, ``. \n   - `themes`, \n   - `_config.yml`, , \n   - `package.json`&`package-lock.json`\n   - `public`, `[your-github-name].github.io`\n   - `node_modules`\n\n7. git, `.gitignore`\n\n    ```\n     .DS_Store\n     Thumbs.db\n     db.json\n     *.log\n     node_modules/\n     public/\n     .deploy*/\n    ```\n\n   - > gitignore`[github-blog]`repository, \n\n     ```shell\n     git init\n     git remote add origin [github-bolg repository ssh address]\n     # for example: $ git remote add origin git@github.com:the-Rings/github-blog.git\n     # github202012, &, ssh address, SSH keys\n     git add .\n     git commit -m \"something\"\n     git push --set-upstream main\n     # \n     ```\n\n8. `_config.yml``[your-github-name].github.io`public, git, hexo\n\n    ```yaml\n    # _config.ymldeploy\n    deploy:\n      type: git\n      repo: git@github.com:[your-github-name]/[your-github-name].github.io.git # SSH\n      branch: main # main\n    ```\n\n9. `npm install hexo-deployer-git --save`, github\n\n10. `hexo clean`&`hexo generate`&`hexo deploy`, .\n\n## \n\n1. `Next`, `theme/next`, , , \n\n   ```shell\n     hexo new page categories\n     hexo new page tags\n     hexo new page about\n   ```\n\n2. , `_config.yml``Extensions`, , `$ npm install hexo-generator-searchdb --save`\n\n    ```yaml\n     search:\n       path: search.xml\n       field: post\n       format: html\n       limit: 10000\n    ```\n\n   - , `theme/next/.config.yml``local_search: enable: true`\n\n3. UML\n    ```shell\n    npm install --save hexo-tag-plantuml\n    ```\n    : https://plantuml.com/zh/class-diagram\n    : https://www.plantuml.com/plantuml/uml/SyfFKj2rKt3CoKnELR1Io4ZDoSa70000\n    {% plantuml %}\n    Joinpoint <|-- Invocation\n    interface Joinpoint {}\n    interface Invocation {}\n    \n    Invocation <|-- MethodInvocation\n    interface MethodInvocation {}\n    \n    MethodInvocation <|-- ProxyMethodInvocation\n    interface ProxyMethodInvocation {}\n    \n    ProxyMethodInvocation <|.. ReflectiveMethodInvocation\n    {% endplantuml %}\n\n## \n1. {% post_link file_name \"display name\" %}\n\n## \n\n1. `hexo new post [new-blog-name]`, `source/_post/`, markdown, Typora\n2. \n3. , `git add `&`git commit`&`git push`\n4. `hexo clean`&`hexo generate`&`hexo deploy`\n\n\n# Troubleshooting\n\n1. `hexo generate`: `Template render error: (unknown path)`, , , `{% xxx %}``{ % xxx %}`, .","slug":"hexo-build-guide","published":1,"updated":"2021-12-30T03:00:17.738Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpy80006xotgf8gsfdnb","content":"<p>githubHexoHTMLgithubyour-github-name.github.io</p>\n<h2 id=\"Github\"><a href=\"#Github\" class=\"headerlink\" title=\"Github\"></a>Github</h2><ol>\n<li>githubrepository<code>Repository name</code><code>[your-github-name].github.io</code>, , .</li>\n<li>repository, <code>Repository name</code><code>github-bolg</code>(), </li>\n<li>ssh<code>id_ras.pub</code> &gt; settings &gt; SSH keys</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><p>Node.js (npm)</p>\n</li>\n<li><p>npm, , </p>\n<ul>\n<li><p>Windows, <code>C:\\Users\\your-user-name\\.npmrc</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">registry=https://registry.npm.taobao.org</span><br><span class=\"line\">prefix=D:\\apps\\nodejs\\node_global</span><br><span class=\"line\">cache=D:\\apps\\nodejs\\node_cache</span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n<li><p><code>npm install -g hexo</code></p>\n</li>\n<li><p><code>hexo init [your-project-name]</code></p>\n</li>\n<li><p>. : <code>hexo clean</code>&amp;<code>hexo generate</code>&amp;<code>hexo server</code>, <code>localhost:4000</code></p>\n</li>\n<li><p></p>\n<ul>\n<li><code>.deploy_git</code>&amp;<code>.github</code>, </li>\n<li><code>source/_posts</code>, soure<code>about</code>, <code>categoryies</code>, <code>tags</code>, <code></code> , <code></code>, <code></code>. </li>\n<li><code>themes</code>, </li>\n<li><code>_config.yml</code>, , </li>\n<li><code>package.json</code>&amp;<code>package-lock.json</code></li>\n<li><code>public</code>, <code>[your-github-name].github.io</code></li>\n<li><code>node_modules</code></li>\n</ul>\n</li>\n<li><p>git, <code>.gitignore</code></p>\n <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.DS_Store</span><br><span class=\"line\">Thumbs.db</span><br><span class=\"line\">db.json</span><br><span class=\"line\">*.log</span><br><span class=\"line\">node_modules/</span><br><span class=\"line\">public/</span><br><span class=\"line\">.deploy*/</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><blockquote>\n<p>gitignore<code>[github-blog]</code>repository, </p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git init</span><br><span class=\"line\">git remote add origin [github-bolg repository ssh address]</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> <span class=\"keyword\">for</span> example: $ git remote add origin git@github.com:the-Rings/github-blog.git</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> github202012, &amp;, ssh address, SSH keys</span></span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m &quot;something&quot;</span><br><span class=\"line\">git push --set-upstream main</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> </span></span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n<li><p><code>_config.yml</code><code>[your-github-name].github.io</code>public, git, hexo</p>\n <figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># _config.ymldeploy</span></span><br><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\">  <span class=\"attr\">type:</span> <span class=\"string\">git</span></span><br><span class=\"line\">  <span class=\"attr\">repo:</span> <span class=\"string\">git@github.com:[your-github-name]/[your-github-name].github.io.git</span> <span class=\"comment\"># SSH</span></span><br><span class=\"line\">  <span class=\"attr\">branch:</span> <span class=\"string\">main</span> <span class=\"comment\"># main</span></span><br></pre></td></tr></table></figure></li>\n<li><p><code>npm install hexo-deployer-git --save</code>, github</p>\n</li>\n<li><p><code>hexo clean</code>&amp;<code>hexo generate</code>&amp;<code>hexo deploy</code>, .</p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><p><code>Next</code>, <code>theme/next</code>, , , </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new page categories</span><br><span class=\"line\">hexo new page tags</span><br><span class=\"line\">hexo new page about</span><br></pre></td></tr></table></figure></li>\n<li><p>, <code>_config.yml</code><code>Extensions</code>, , <code>$ npm install hexo-generator-searchdb --save</code></p>\n <figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">search:</span></span><br><span class=\"line\">  <span class=\"attr\">path:</span> <span class=\"string\">search.xml</span></span><br><span class=\"line\">  <span class=\"attr\">field:</span> <span class=\"string\">post</span></span><br><span class=\"line\">  <span class=\"attr\">format:</span> <span class=\"string\">html</span></span><br><span class=\"line\">  <span class=\"attr\">limit:</span> <span class=\"number\">10000</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>, <code>theme/next/.config.yml</code><code>local_search: enable: true</code></li>\n</ul>\n</li>\n<li><p>UML</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install --save hexo-tag-plantuml</span><br></pre></td></tr></table></figure>\n<p> : <a href=\"https://plantuml.com/zh/class-diagram\">https://plantuml.com/zh/class-diagram</a><br> : <a href=\"https://www.plantuml.com/plantuml/uml/SyfFKj2rKt3CoKnELR1Io4ZDoSa70000\">https://www.plantuml.com/plantuml/uml/SyfFKj2rKt3CoKnELR1Io4ZDoSa70000</a></p>\n <img  src=http://www.plantuml.com/plantuml/svg/yyhFp2i0uX85cnfTNGNFlBByvCIIpFmyBg1OQb5QOdAgWXTSJNKjaZ12BKYS2uaBDietjIGZFmMhWUXIOFqOWc1J0ehoAohn68LL7cmUTXcR6ZqzXQ3Kj9pKv9BCibHqUG00></li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><a href=\"#\">Post not found: file_name display name</a></li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><code>hexo new post [new-blog-name]</code>, <code>source/_post/</code>, markdown, Typora</li>\n<li></li>\n<li>, <code>git add </code>&amp;<code>git commit</code>&amp;<code>git push</code></li>\n<li><code>hexo clean</code>&amp;<code>hexo generate</code>&amp;<code>hexo deploy</code></li>\n</ol>\n<h1 id=\"Troubleshooting\"><a href=\"#Troubleshooting\" class=\"headerlink\" title=\"Troubleshooting\"></a>Troubleshooting</h1><p></p>\n<ol>\n<li><code>hexo generate</code>: <code>Template render error: (unknown path)</code>, , , <code>&#123;% xxx %&#125;</code><code>&#123; % xxx %&#125;</code>, .</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<p>githubHexoHTMLgithubyour-github-name.github.io</p>\n<h2 id=\"Github\"><a href=\"#Github\" class=\"headerlink\" title=\"Github\"></a>Github</h2><ol>\n<li>githubrepository<code>Repository name</code><code>[your-github-name].github.io</code>, , .</li>\n<li>repository, <code>Repository name</code><code>github-bolg</code>(), </li>\n<li>ssh<code>id_ras.pub</code> &gt; settings &gt; SSH keys</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><p>Node.js (npm)</p>\n</li>\n<li><p>npm, , </p>\n<ul>\n<li><p>Windows, <code>C:\\Users\\your-user-name\\.npmrc</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">registry=https://registry.npm.taobao.org</span><br><span class=\"line\">prefix=D:\\apps\\nodejs\\node_global</span><br><span class=\"line\">cache=D:\\apps\\nodejs\\node_cache</span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n<li><p><code>npm install -g hexo</code></p>\n</li>\n<li><p><code>hexo init [your-project-name]</code></p>\n</li>\n<li><p>. : <code>hexo clean</code>&amp;<code>hexo generate</code>&amp;<code>hexo server</code>, <code>localhost:4000</code></p>\n</li>\n<li><p></p>\n<ul>\n<li><code>.deploy_git</code>&amp;<code>.github</code>, </li>\n<li><code>source/_posts</code>, soure<code>about</code>, <code>categoryies</code>, <code>tags</code>, <code></code> , <code></code>, <code></code>. </li>\n<li><code>themes</code>, </li>\n<li><code>_config.yml</code>, , </li>\n<li><code>package.json</code>&amp;<code>package-lock.json</code></li>\n<li><code>public</code>, <code>[your-github-name].github.io</code></li>\n<li><code>node_modules</code></li>\n</ul>\n</li>\n<li><p>git, <code>.gitignore</code></p>\n <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.DS_Store</span><br><span class=\"line\">Thumbs.db</span><br><span class=\"line\">db.json</span><br><span class=\"line\">*.log</span><br><span class=\"line\">node_modules/</span><br><span class=\"line\">public/</span><br><span class=\"line\">.deploy*/</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><blockquote>\n<p>gitignore<code>[github-blog]</code>repository, </p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git init</span><br><span class=\"line\">git remote add origin [github-bolg repository ssh address]</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> <span class=\"keyword\">for</span> example: $ git remote add origin git@github.com:the-Rings/github-blog.git</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> github202012, &amp;, ssh address, SSH keys</span></span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m &quot;something&quot;</span><br><span class=\"line\">git push --set-upstream main</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> </span></span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n<li><p><code>_config.yml</code><code>[your-github-name].github.io</code>public, git, hexo</p>\n <figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># _config.ymldeploy</span></span><br><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\">  <span class=\"attr\">type:</span> <span class=\"string\">git</span></span><br><span class=\"line\">  <span class=\"attr\">repo:</span> <span class=\"string\">git@github.com:[your-github-name]/[your-github-name].github.io.git</span> <span class=\"comment\"># SSH</span></span><br><span class=\"line\">  <span class=\"attr\">branch:</span> <span class=\"string\">main</span> <span class=\"comment\"># main</span></span><br></pre></td></tr></table></figure></li>\n<li><p><code>npm install hexo-deployer-git --save</code>, github</p>\n</li>\n<li><p><code>hexo clean</code>&amp;<code>hexo generate</code>&amp;<code>hexo deploy</code>, .</p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><p><code>Next</code>, <code>theme/next</code>, , , </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new page categories</span><br><span class=\"line\">hexo new page tags</span><br><span class=\"line\">hexo new page about</span><br></pre></td></tr></table></figure></li>\n<li><p>, <code>_config.yml</code><code>Extensions</code>, , <code>$ npm install hexo-generator-searchdb --save</code></p>\n <figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">search:</span></span><br><span class=\"line\">  <span class=\"attr\">path:</span> <span class=\"string\">search.xml</span></span><br><span class=\"line\">  <span class=\"attr\">field:</span> <span class=\"string\">post</span></span><br><span class=\"line\">  <span class=\"attr\">format:</span> <span class=\"string\">html</span></span><br><span class=\"line\">  <span class=\"attr\">limit:</span> <span class=\"number\">10000</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>, <code>theme/next/.config.yml</code><code>local_search: enable: true</code></li>\n</ul>\n</li>\n<li><p>UML</p>\n <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install --save hexo-tag-plantuml</span><br></pre></td></tr></table></figure>\n<p> : <a href=\"https://plantuml.com/zh/class-diagram\">https://plantuml.com/zh/class-diagram</a><br> : <a href=\"https://www.plantuml.com/plantuml/uml/SyfFKj2rKt3CoKnELR1Io4ZDoSa70000\">https://www.plantuml.com/plantuml/uml/SyfFKj2rKt3CoKnELR1Io4ZDoSa70000</a></p>\n <img  src=http://www.plantuml.com/plantuml/svg/yyhFp2i0uX85cnfTNGNFlBByvCIIpFmyBg1OQb5QOdAgWXTSJNKjaZ12BKYS2uaBDietjIGZFmMhWUXIOFqOWc1J0ehoAohn68LL7cmUTXcR6ZqzXQ3Kj9pKv9BCibHqUG00></li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><a href=\"#\">Post not found: file_name display name</a></li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><code>hexo new post [new-blog-name]</code>, <code>source/_post/</code>, markdown, Typora</li>\n<li></li>\n<li>, <code>git add </code>&amp;<code>git commit</code>&amp;<code>git push</code></li>\n<li><code>hexo clean</code>&amp;<code>hexo generate</code>&amp;<code>hexo deploy</code></li>\n</ol>\n<h1 id=\"Troubleshooting\"><a href=\"#Troubleshooting\" class=\"headerlink\" title=\"Troubleshooting\"></a>Troubleshooting</h1><p></p>\n<ol>\n<li><code>hexo generate</code>: <code>Template render error: (unknown path)</code>, , , <code>&#123;% xxx %&#125;</code><code>&#123; % xxx %&#125;</code>, .</li>\n</ol>\n"},{"title":"Java","date":"2021-07-24T02:31:14.000Z","_content":"\n, , , , Annotation Processor. , .\n.\n\n# Annotation\n: (All primitives)StringClassenumAnnotation\n\n.\n\n, . @Target@Retention. @RetentionSOURCECLASSRUNTIMESOURCECLASSJVMRUNTIMESOURCEcomplie timejavac@SuppressWarnings @Override:\nmapstruct@Mapper@Retentation(RetentationPolicy.CLASS)target/generated-sources/annotations/javaclass\n\nSOURCEJava\n{% plantuml %}\nstart\n\n: your source code;\n\nrepeat: Parse and Enter;\n    : ...;\nrepeat while (Annotation Processing)\n\n: Analyse and Generate;\n: 100100010;\n\nend\n{% endplantuml %}\n\nAnnotation ProcessingRetentationPolicy.SOURCERetentationPolicy.CLASSclass\n\n\n## Useing javac to Process Annotations\n\n\n(), `Annotation Processor`, AbstractProcessor, process.\n\nAnnotation Processor.\nprocessingsource codeannotationsource filemapstructjavaclass\n\n## Runtime Annotations Processing\nAbstractProcessorJavaAPIgetAnnotation(xxx.class)\n\n@Query(...)CriteriaFields@QueryCriteriacriteriacriterai.getClass().getDeclaredFields()Fieldfield.setAccessible(true)privatefield.getAnnotation(Query.class)@Querylikefiled.getName()filed.get(criteria)\n```java\nimport cn.hutool.core.util.ObjectUtil;\nimport com.lee.annotation.Query;\nimport com.lee.config.mybatis.SimpleQueryWrapper;\nimport java.lang.reflect.Field;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.List;\nimport lombok.extern.slf4j.Slf4j;\n\n/**\n * @author guomaoqing907\n */\n@Slf4j\n@SuppressWarnings({\"unchecked\", \"all\"})\npublic class QueryHelpForMybatis<T> {\n  public static <T, Q> SimpleQueryWrapper<T> getQueryCondition(Q query) {\n    List<SimpleQueryWrapper<T>> list = new ArrayList<SimpleQueryWrapper<T>>();\n    SimpleQueryWrapper<T> qw = new SimpleQueryWrapper<>();\n    if (query == null) {\n      return qw;\n    }\n    try {\n      List<Field> fields = getAllFields(query.getClass(), new ArrayList<>());\n      for (Field field : fields) {\n        boolean accessible = field.isAccessible();\n        // private\n        field.setAccessible(true);\n        Query q = field.getAnnotation(Query.class);\n        if (q != null) {\n          String propName = q.propName();\n          String joinName = q.joinName();\n          // join\n          if (!isBlank(joinName)) {\n            continue;\n          }\n          String blurry = q.blurry();\n          String attributeName = isBlank(propName) ? field.getName() : propName;\n          boolean sortType = q.sortType();\n          Class<?> fieldType = field.getType();\n          Object val = field.get(query);\n          if (ObjectUtil.isNull(val) || \"\".equals(val) || ObjectUtil.isEmpty(val)) {\n            continue;\n          }\n          // \n          if (ObjectUtil.isNotEmpty(blurry)) {\n            String[] blurrys = blurry.split(\",\");\n            List<SimpleQueryWrapper<T>> conditionChain = new ArrayList<>();\n            // NOTE:  (a like '..' or b like '..' or c like '..') and d = '..'\n            for (String s : blurrys) {\n              qw.or().like(s, val.toString());\n            }\n            continue;\n          }\n          switch (q.type()) {\n            case EQUAL:\n              qw.eq(attributeName, val);\n              break;\n            case GREATER_THAN:\n              qw.and(obj -> obj.ge(attributeName, val));\n              break;\n            case LESS_THAN:\n              qw.and(obj -> obj.le(attributeName, val));\n              break;\n            case LESS_THAN_NQ:\n              qw.and(obj -> obj.lt(attributeName, val));\n              break;\n            case INNER_LIKE:\n              qw.and(obj -> obj.like(attributeName, val));\n              break;\n            case LEFT_LIKE:\n              qw.and(obj -> obj.likeLeft(attributeName, val));\n              break;\n            case RIGHT_LIKE:\n              qw.and(obj -> obj.likeRight(attributeName, val));\n              break;\n            case IN:\n              List valList = (ArrayList) val;\n              Object[] objArray = valList.toArray();\n              qw.and(obj -> obj.in(attributeName, objArray));\n              break;\n            case NOT_EQUAL:\n              qw.and(obj -> obj.ne(attributeName, val));\n              break;\n            case NOT_NULL:\n              qw.and(obj -> obj.isNotNull(attributeName));\n              break;\n            case IS_NULL:\n              qw.and(obj -> obj.isNull(attributeName));\n              break;\n            case BETWEEN:\n              List<Object> between = new ArrayList<>((List<Object>) val);\n              qw.and(obj -> obj.between(attributeName, between.get(0), between.get(1)));\n              break;\n            case SORT:\n              List valListSort = (ArrayList) val ;\n              Object[] objArraySort = valListSort.toArray();\n              if(valListSort.toString().split(\",\").length<=2){\n                Object object = \"asc\";\n                if (objArraySort[1].equals(object)){\n                   qw.orderBy(true, true, objArraySort[0].toString());\n                }else {\n                  qw.orderBy(true, false, objArraySort[0].toString());\n                }\n              }\n              else {\n                String[] stringsSort;\n                for (Object objectSort : objArraySort){\n                  stringsSort=objectSort.toString().split(\",\");\n                  if (stringsSort[1].equals(\"asc\")){\n                    qw.orderBy(true, true, stringsSort[0]);\n                  }else {\n                    qw.orderBy(true, false, stringsSort[0]);\n                  }\n                }\n              }\n              break;\n            default:\n          }\n        }\n        field.setAccessible(accessible);\n      }\n    } catch (Exception e) {\n      log.error(e.getMessage(), e);\n    }\n    return qw;\n  }\n\n  private static boolean isBlank(final CharSequence cs) {\n    int strLen;\n    if (cs == null || (strLen = cs.length()) == 0) {\n      return true;\n    }\n    for (int i = 0; i < strLen; i++) {\n      if (!Character.isWhitespace(cs.charAt(i))) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  public static List<Field> getAllFields(Class clazz, List<Field> fields) {\n    if (clazz != null) {\n      fields.addAll(Arrays.asList(clazz.getDeclaredFields()));\n      getAllFields(clazz.getSuperclass(), fields);\n    }\n    return fields;\n  }\n}\n```\n\n\n","source":"_posts/java-annotation.md","raw":"---\ntitle: Java\ndate: 2021-07-24 10:31:14\ncategories:\n- Java\n---\n\n, , , , Annotation Processor. , .\n.\n\n# Annotation\n: (All primitives)StringClassenumAnnotation\n\n.\n\n, . @Target@Retention. @RetentionSOURCECLASSRUNTIMESOURCECLASSJVMRUNTIMESOURCEcomplie timejavac@SuppressWarnings @Override:\nmapstruct@Mapper@Retentation(RetentationPolicy.CLASS)target/generated-sources/annotations/javaclass\n\nSOURCEJava\n{% plantuml %}\nstart\n\n: your source code;\n\nrepeat: Parse and Enter;\n    : ...;\nrepeat while (Annotation Processing)\n\n: Analyse and Generate;\n: 100100010;\n\nend\n{% endplantuml %}\n\nAnnotation ProcessingRetentationPolicy.SOURCERetentationPolicy.CLASSclass\n\n\n## Useing javac to Process Annotations\n\n\n(), `Annotation Processor`, AbstractProcessor, process.\n\nAnnotation Processor.\nprocessingsource codeannotationsource filemapstructjavaclass\n\n## Runtime Annotations Processing\nAbstractProcessorJavaAPIgetAnnotation(xxx.class)\n\n@Query(...)CriteriaFields@QueryCriteriacriteriacriterai.getClass().getDeclaredFields()Fieldfield.setAccessible(true)privatefield.getAnnotation(Query.class)@Querylikefiled.getName()filed.get(criteria)\n```java\nimport cn.hutool.core.util.ObjectUtil;\nimport com.lee.annotation.Query;\nimport com.lee.config.mybatis.SimpleQueryWrapper;\nimport java.lang.reflect.Field;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.List;\nimport lombok.extern.slf4j.Slf4j;\n\n/**\n * @author guomaoqing907\n */\n@Slf4j\n@SuppressWarnings({\"unchecked\", \"all\"})\npublic class QueryHelpForMybatis<T> {\n  public static <T, Q> SimpleQueryWrapper<T> getQueryCondition(Q query) {\n    List<SimpleQueryWrapper<T>> list = new ArrayList<SimpleQueryWrapper<T>>();\n    SimpleQueryWrapper<T> qw = new SimpleQueryWrapper<>();\n    if (query == null) {\n      return qw;\n    }\n    try {\n      List<Field> fields = getAllFields(query.getClass(), new ArrayList<>());\n      for (Field field : fields) {\n        boolean accessible = field.isAccessible();\n        // private\n        field.setAccessible(true);\n        Query q = field.getAnnotation(Query.class);\n        if (q != null) {\n          String propName = q.propName();\n          String joinName = q.joinName();\n          // join\n          if (!isBlank(joinName)) {\n            continue;\n          }\n          String blurry = q.blurry();\n          String attributeName = isBlank(propName) ? field.getName() : propName;\n          boolean sortType = q.sortType();\n          Class<?> fieldType = field.getType();\n          Object val = field.get(query);\n          if (ObjectUtil.isNull(val) || \"\".equals(val) || ObjectUtil.isEmpty(val)) {\n            continue;\n          }\n          // \n          if (ObjectUtil.isNotEmpty(blurry)) {\n            String[] blurrys = blurry.split(\",\");\n            List<SimpleQueryWrapper<T>> conditionChain = new ArrayList<>();\n            // NOTE:  (a like '..' or b like '..' or c like '..') and d = '..'\n            for (String s : blurrys) {\n              qw.or().like(s, val.toString());\n            }\n            continue;\n          }\n          switch (q.type()) {\n            case EQUAL:\n              qw.eq(attributeName, val);\n              break;\n            case GREATER_THAN:\n              qw.and(obj -> obj.ge(attributeName, val));\n              break;\n            case LESS_THAN:\n              qw.and(obj -> obj.le(attributeName, val));\n              break;\n            case LESS_THAN_NQ:\n              qw.and(obj -> obj.lt(attributeName, val));\n              break;\n            case INNER_LIKE:\n              qw.and(obj -> obj.like(attributeName, val));\n              break;\n            case LEFT_LIKE:\n              qw.and(obj -> obj.likeLeft(attributeName, val));\n              break;\n            case RIGHT_LIKE:\n              qw.and(obj -> obj.likeRight(attributeName, val));\n              break;\n            case IN:\n              List valList = (ArrayList) val;\n              Object[] objArray = valList.toArray();\n              qw.and(obj -> obj.in(attributeName, objArray));\n              break;\n            case NOT_EQUAL:\n              qw.and(obj -> obj.ne(attributeName, val));\n              break;\n            case NOT_NULL:\n              qw.and(obj -> obj.isNotNull(attributeName));\n              break;\n            case IS_NULL:\n              qw.and(obj -> obj.isNull(attributeName));\n              break;\n            case BETWEEN:\n              List<Object> between = new ArrayList<>((List<Object>) val);\n              qw.and(obj -> obj.between(attributeName, between.get(0), between.get(1)));\n              break;\n            case SORT:\n              List valListSort = (ArrayList) val ;\n              Object[] objArraySort = valListSort.toArray();\n              if(valListSort.toString().split(\",\").length<=2){\n                Object object = \"asc\";\n                if (objArraySort[1].equals(object)){\n                   qw.orderBy(true, true, objArraySort[0].toString());\n                }else {\n                  qw.orderBy(true, false, objArraySort[0].toString());\n                }\n              }\n              else {\n                String[] stringsSort;\n                for (Object objectSort : objArraySort){\n                  stringsSort=objectSort.toString().split(\",\");\n                  if (stringsSort[1].equals(\"asc\")){\n                    qw.orderBy(true, true, stringsSort[0]);\n                  }else {\n                    qw.orderBy(true, false, stringsSort[0]);\n                  }\n                }\n              }\n              break;\n            default:\n          }\n        }\n        field.setAccessible(accessible);\n      }\n    } catch (Exception e) {\n      log.error(e.getMessage(), e);\n    }\n    return qw;\n  }\n\n  private static boolean isBlank(final CharSequence cs) {\n    int strLen;\n    if (cs == null || (strLen = cs.length()) == 0) {\n      return true;\n    }\n    for (int i = 0; i < strLen; i++) {\n      if (!Character.isWhitespace(cs.charAt(i))) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  public static List<Field> getAllFields(Class clazz, List<Field> fields) {\n    if (clazz != null) {\n      fields.addAll(Arrays.asList(clazz.getDeclaredFields()));\n      getAllFields(clazz.getSuperclass(), fields);\n    }\n    return fields;\n  }\n}\n```\n\n\n","slug":"java-annotation","published":1,"updated":"2021-12-30T03:00:39.701Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpya0007xotg13uchtu0","content":"<p>, , , , Annotation Processor. , .<br>.</p>\n<h1 id=\"Annotation\"><a href=\"#Annotation\" class=\"headerlink\" title=\"Annotation\"></a>Annotation</h1><p>: (All primitives)StringClassenumAnnotation</p>\n<p>.</p>\n<p>, . @Target@Retention. @RetentionSOURCECLASSRUNTIMESOURCECLASSJVMRUNTIMESOURCEcomplie timejavac@SuppressWarnings @Override:<br>mapstruct@Mapper@Retentation(RetentationPolicy.CLASS)target/generated-sources/annotations/javaclass</p>\n<p>SOURCEJava</p>\n<img  src=http://www.plantuml.com/plantuml/svg/BOsn2WCn34DtVuN6TWdNDPbkA5tl5qnYsi3X5CUbtD_NXHEI9l4qdSs9CexnCSoeAgYZII4oUGjxniOs1QmDTtMnGWXbf9JAkS7trNV1PLKTpjw7OhDHPSwkp-iVlohlnqbvY8gnnqN6RLd2aVWJRJy0>\n\n<p>Annotation ProcessingRetentationPolicy.SOURCERetentationPolicy.CLASSclass</p>\n<h2 id=\"Useing-javac-to-Process-Annotations\"><a href=\"#Useing-javac-to-Process-Annotations\" class=\"headerlink\" title=\"Useing javac to Process Annotations\"></a>Useing javac to Process Annotations</h2><p></p>\n<p>(), <code>Annotation Processor</code>, AbstractProcessor, process.</p>\n<p>Annotation Processor.<br>processingsource codeannotationsource filemapstructjavaclass</p>\n<h2 id=\"Runtime-Annotations-Processing\"><a href=\"#Runtime-Annotations-Processing\" class=\"headerlink\" title=\"Runtime Annotations Processing\"></a>Runtime Annotations Processing</h2><p>AbstractProcessorJavaAPIgetAnnotation(xxx.class)</p>\n<p>@Query()CriteriaFields@QueryCriteriacriteriacriterai.getClass().getDeclaredFields()Fieldfield.setAccessible(true)privatefield.getAnnotation(Query.class)@Querylikefiled.getName()filed.get(criteria)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> cn.hutool.core.util.ObjectUtil;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.lee.annotation.Query;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.lee.config.mybatis.SimpleQueryWrapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.lang.reflect.Field;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Arrays;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> guomaoqing907</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@SuppressWarnings(&#123;&quot;unchecked&quot;, &quot;all&quot;&#125;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">QueryHelpForMybatis</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T, Q&gt; <span class=\"function\">SimpleQueryWrapper&lt;T&gt; <span class=\"title\">getQueryCondition</span><span class=\"params\">(Q query)</span> </span>&#123;</span><br><span class=\"line\">    List&lt;SimpleQueryWrapper&lt;T&gt;&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;SimpleQueryWrapper&lt;T&gt;&gt;();</span><br><span class=\"line\">    SimpleQueryWrapper&lt;T&gt; qw = <span class=\"keyword\">new</span> SimpleQueryWrapper&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (query == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> qw;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      List&lt;Field&gt; fields = getAllFields(query.getClass(), <span class=\"keyword\">new</span> ArrayList&lt;&gt;());</span><br><span class=\"line\">      <span class=\"keyword\">for</span> (Field field : fields) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> accessible = field.isAccessible();</span><br><span class=\"line\">        <span class=\"comment\">// private</span></span><br><span class=\"line\">        field.setAccessible(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        Query q = field.getAnnotation(Query.class);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (q != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">          String propName = q.propName();</span><br><span class=\"line\">          String joinName = q.joinName();</span><br><span class=\"line\">          <span class=\"comment\">// join</span></span><br><span class=\"line\">          <span class=\"keyword\">if</span> (!isBlank(joinName)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          String blurry = q.blurry();</span><br><span class=\"line\">          String attributeName = isBlank(propName) ? field.getName() : propName;</span><br><span class=\"line\">          <span class=\"keyword\">boolean</span> sortType = q.sortType();</span><br><span class=\"line\">          Class&lt;?&gt; fieldType = field.getType();</span><br><span class=\"line\">          Object val = field.get(query);</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (ObjectUtil.isNull(val) || <span class=\"string\">&quot;&quot;</span>.equals(val) || ObjectUtil.isEmpty(val)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"comment\">// </span></span><br><span class=\"line\">          <span class=\"keyword\">if</span> (ObjectUtil.isNotEmpty(blurry)) &#123;</span><br><span class=\"line\">            String[] blurrys = blurry.split(<span class=\"string\">&quot;,&quot;</span>);</span><br><span class=\"line\">            List&lt;SimpleQueryWrapper&lt;T&gt;&gt; conditionChain = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">            <span class=\"comment\">// <span class=\"doctag\">NOTE:</span>  (a like &#x27;..&#x27; or b like &#x27;..&#x27; or c like &#x27;..&#x27;) and d = &#x27;..&#x27;</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (String s : blurrys) &#123;</span><br><span class=\"line\">              qw.or().like(s, val.toString());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">switch</span> (q.type()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> EQUAL:</span><br><span class=\"line\">              qw.eq(attributeName, val);</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> GREATER_THAN:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.ge(attributeName, val));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> LESS_THAN:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.le(attributeName, val));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> LESS_THAN_NQ:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.lt(attributeName, val));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> INNER_LIKE:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.like(attributeName, val));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> LEFT_LIKE:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.likeLeft(attributeName, val));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> RIGHT_LIKE:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.likeRight(attributeName, val));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> IN:</span><br><span class=\"line\">              List valList = (ArrayList) val;</span><br><span class=\"line\">              Object[] objArray = valList.toArray();</span><br><span class=\"line\">              qw.and(obj -&gt; obj.in(attributeName, objArray));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> NOT_EQUAL:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.ne(attributeName, val));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> NOT_NULL:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.isNotNull(attributeName));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> IS_NULL:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.isNull(attributeName));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> BETWEEN:</span><br><span class=\"line\">              List&lt;Object&gt; between = <span class=\"keyword\">new</span> ArrayList&lt;&gt;((List&lt;Object&gt;) val);</span><br><span class=\"line\">              qw.and(obj -&gt; obj.between(attributeName, between.get(<span class=\"number\">0</span>), between.get(<span class=\"number\">1</span>)));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> SORT:</span><br><span class=\"line\">              List valListSort = (ArrayList) val ;</span><br><span class=\"line\">              Object[] objArraySort = valListSort.toArray();</span><br><span class=\"line\">              <span class=\"keyword\">if</span>(valListSort.toString().split(<span class=\"string\">&quot;,&quot;</span>).length&lt;=<span class=\"number\">2</span>)&#123;</span><br><span class=\"line\">                Object object = <span class=\"string\">&quot;asc&quot;</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (objArraySort[<span class=\"number\">1</span>].equals(object))&#123;</span><br><span class=\"line\">                   qw.orderBy(<span class=\"keyword\">true</span>, <span class=\"keyword\">true</span>, objArraySort[<span class=\"number\">0</span>].toString());</span><br><span class=\"line\">                &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                  qw.orderBy(<span class=\"keyword\">true</span>, <span class=\"keyword\">false</span>, objArraySort[<span class=\"number\">0</span>].toString());</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                String[] stringsSort;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (Object objectSort : objArraySort)&#123;</span><br><span class=\"line\">                  stringsSort=objectSort.toString().split(<span class=\"string\">&quot;,&quot;</span>);</span><br><span class=\"line\">                  <span class=\"keyword\">if</span> (stringsSort[<span class=\"number\">1</span>].equals(<span class=\"string\">&quot;asc&quot;</span>))&#123;</span><br><span class=\"line\">                    qw.orderBy(<span class=\"keyword\">true</span>, <span class=\"keyword\">true</span>, stringsSort[<span class=\"number\">0</span>]);</span><br><span class=\"line\">                  &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    qw.orderBy(<span class=\"keyword\">true</span>, <span class=\"keyword\">false</span>, stringsSort[<span class=\"number\">0</span>]);</span><br><span class=\"line\">                  &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">default</span>:</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        field.setAccessible(accessible);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">      log.error(e.getMessage(), e);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> qw;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isBlank</span><span class=\"params\">(<span class=\"keyword\">final</span> CharSequence cs)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> strLen;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cs == <span class=\"keyword\">null</span> || (strLen = cs.length()) == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; strLen; i++) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (!Character.isWhitespace(cs.charAt(i))) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> List&lt;Field&gt; <span class=\"title\">getAllFields</span><span class=\"params\">(Class clazz, List&lt;Field&gt; fields)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (clazz != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      fields.addAll(Arrays.asList(clazz.getDeclaredFields()));</span><br><span class=\"line\">      getAllFields(clazz.getSuperclass(), fields);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> fields;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n","site":{"data":{}},"excerpt":"","more":"<p>, , , , Annotation Processor. , .<br>.</p>\n<h1 id=\"Annotation\"><a href=\"#Annotation\" class=\"headerlink\" title=\"Annotation\"></a>Annotation</h1><p>: (All primitives)StringClassenumAnnotation</p>\n<p>.</p>\n<p>, . @Target@Retention. @RetentionSOURCECLASSRUNTIMESOURCECLASSJVMRUNTIMESOURCEcomplie timejavac@SuppressWarnings @Override:<br>mapstruct@Mapper@Retentation(RetentationPolicy.CLASS)target/generated-sources/annotations/javaclass</p>\n<p>SOURCEJava</p>\n<img  src=http://www.plantuml.com/plantuml/svg/BOsn2WCn34DtVuN6TWdNDPbkA5tl5qnYsi3X5CUbtD_NXHEI9l4qdSs9CexnCSoeAgYZII4oUGjxniOs1QmDTtMnGWXbf9JAkS7trNV1PLKTpjw7OhDHPSwkp-iVlohlnqbvY8gnnqN6RLd2aVWJRJy0>\n\n<p>Annotation ProcessingRetentationPolicy.SOURCERetentationPolicy.CLASSclass</p>\n<h2 id=\"Useing-javac-to-Process-Annotations\"><a href=\"#Useing-javac-to-Process-Annotations\" class=\"headerlink\" title=\"Useing javac to Process Annotations\"></a>Useing javac to Process Annotations</h2><p></p>\n<p>(), <code>Annotation Processor</code>, AbstractProcessor, process.</p>\n<p>Annotation Processor.<br>processingsource codeannotationsource filemapstructjavaclass</p>\n<h2 id=\"Runtime-Annotations-Processing\"><a href=\"#Runtime-Annotations-Processing\" class=\"headerlink\" title=\"Runtime Annotations Processing\"></a>Runtime Annotations Processing</h2><p>AbstractProcessorJavaAPIgetAnnotation(xxx.class)</p>\n<p>@Query()CriteriaFields@QueryCriteriacriteriacriterai.getClass().getDeclaredFields()Fieldfield.setAccessible(true)privatefield.getAnnotation(Query.class)@Querylikefiled.getName()filed.get(criteria)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> cn.hutool.core.util.ObjectUtil;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.lee.annotation.Query;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.lee.config.mybatis.SimpleQueryWrapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.lang.reflect.Field;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Arrays;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> guomaoqing907</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@SuppressWarnings(&#123;&quot;unchecked&quot;, &quot;all&quot;&#125;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">QueryHelpForMybatis</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T, Q&gt; <span class=\"function\">SimpleQueryWrapper&lt;T&gt; <span class=\"title\">getQueryCondition</span><span class=\"params\">(Q query)</span> </span>&#123;</span><br><span class=\"line\">    List&lt;SimpleQueryWrapper&lt;T&gt;&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;SimpleQueryWrapper&lt;T&gt;&gt;();</span><br><span class=\"line\">    SimpleQueryWrapper&lt;T&gt; qw = <span class=\"keyword\">new</span> SimpleQueryWrapper&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (query == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> qw;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      List&lt;Field&gt; fields = getAllFields(query.getClass(), <span class=\"keyword\">new</span> ArrayList&lt;&gt;());</span><br><span class=\"line\">      <span class=\"keyword\">for</span> (Field field : fields) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> accessible = field.isAccessible();</span><br><span class=\"line\">        <span class=\"comment\">// private</span></span><br><span class=\"line\">        field.setAccessible(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        Query q = field.getAnnotation(Query.class);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (q != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">          String propName = q.propName();</span><br><span class=\"line\">          String joinName = q.joinName();</span><br><span class=\"line\">          <span class=\"comment\">// join</span></span><br><span class=\"line\">          <span class=\"keyword\">if</span> (!isBlank(joinName)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          String blurry = q.blurry();</span><br><span class=\"line\">          String attributeName = isBlank(propName) ? field.getName() : propName;</span><br><span class=\"line\">          <span class=\"keyword\">boolean</span> sortType = q.sortType();</span><br><span class=\"line\">          Class&lt;?&gt; fieldType = field.getType();</span><br><span class=\"line\">          Object val = field.get(query);</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (ObjectUtil.isNull(val) || <span class=\"string\">&quot;&quot;</span>.equals(val) || ObjectUtil.isEmpty(val)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"comment\">// </span></span><br><span class=\"line\">          <span class=\"keyword\">if</span> (ObjectUtil.isNotEmpty(blurry)) &#123;</span><br><span class=\"line\">            String[] blurrys = blurry.split(<span class=\"string\">&quot;,&quot;</span>);</span><br><span class=\"line\">            List&lt;SimpleQueryWrapper&lt;T&gt;&gt; conditionChain = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">            <span class=\"comment\">// <span class=\"doctag\">NOTE:</span>  (a like &#x27;..&#x27; or b like &#x27;..&#x27; or c like &#x27;..&#x27;) and d = &#x27;..&#x27;</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (String s : blurrys) &#123;</span><br><span class=\"line\">              qw.or().like(s, val.toString());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">switch</span> (q.type()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> EQUAL:</span><br><span class=\"line\">              qw.eq(attributeName, val);</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> GREATER_THAN:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.ge(attributeName, val));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> LESS_THAN:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.le(attributeName, val));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> LESS_THAN_NQ:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.lt(attributeName, val));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> INNER_LIKE:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.like(attributeName, val));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> LEFT_LIKE:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.likeLeft(attributeName, val));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> RIGHT_LIKE:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.likeRight(attributeName, val));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> IN:</span><br><span class=\"line\">              List valList = (ArrayList) val;</span><br><span class=\"line\">              Object[] objArray = valList.toArray();</span><br><span class=\"line\">              qw.and(obj -&gt; obj.in(attributeName, objArray));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> NOT_EQUAL:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.ne(attributeName, val));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> NOT_NULL:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.isNotNull(attributeName));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> IS_NULL:</span><br><span class=\"line\">              qw.and(obj -&gt; obj.isNull(attributeName));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> BETWEEN:</span><br><span class=\"line\">              List&lt;Object&gt; between = <span class=\"keyword\">new</span> ArrayList&lt;&gt;((List&lt;Object&gt;) val);</span><br><span class=\"line\">              qw.and(obj -&gt; obj.between(attributeName, between.get(<span class=\"number\">0</span>), between.get(<span class=\"number\">1</span>)));</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> SORT:</span><br><span class=\"line\">              List valListSort = (ArrayList) val ;</span><br><span class=\"line\">              Object[] objArraySort = valListSort.toArray();</span><br><span class=\"line\">              <span class=\"keyword\">if</span>(valListSort.toString().split(<span class=\"string\">&quot;,&quot;</span>).length&lt;=<span class=\"number\">2</span>)&#123;</span><br><span class=\"line\">                Object object = <span class=\"string\">&quot;asc&quot;</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (objArraySort[<span class=\"number\">1</span>].equals(object))&#123;</span><br><span class=\"line\">                   qw.orderBy(<span class=\"keyword\">true</span>, <span class=\"keyword\">true</span>, objArraySort[<span class=\"number\">0</span>].toString());</span><br><span class=\"line\">                &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                  qw.orderBy(<span class=\"keyword\">true</span>, <span class=\"keyword\">false</span>, objArraySort[<span class=\"number\">0</span>].toString());</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                String[] stringsSort;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (Object objectSort : objArraySort)&#123;</span><br><span class=\"line\">                  stringsSort=objectSort.toString().split(<span class=\"string\">&quot;,&quot;</span>);</span><br><span class=\"line\">                  <span class=\"keyword\">if</span> (stringsSort[<span class=\"number\">1</span>].equals(<span class=\"string\">&quot;asc&quot;</span>))&#123;</span><br><span class=\"line\">                    qw.orderBy(<span class=\"keyword\">true</span>, <span class=\"keyword\">true</span>, stringsSort[<span class=\"number\">0</span>]);</span><br><span class=\"line\">                  &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    qw.orderBy(<span class=\"keyword\">true</span>, <span class=\"keyword\">false</span>, stringsSort[<span class=\"number\">0</span>]);</span><br><span class=\"line\">                  &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">default</span>:</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        field.setAccessible(accessible);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">      log.error(e.getMessage(), e);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> qw;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isBlank</span><span class=\"params\">(<span class=\"keyword\">final</span> CharSequence cs)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> strLen;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cs == <span class=\"keyword\">null</span> || (strLen = cs.length()) == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; strLen; i++) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (!Character.isWhitespace(cs.charAt(i))) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> List&lt;Field&gt; <span class=\"title\">getAllFields</span><span class=\"params\">(Class clazz, List&lt;Field&gt; fields)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (clazz != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      fields.addAll(Arrays.asList(clazz.getDeclaredFields()));</span><br><span class=\"line\">      getAllFields(clazz.getSuperclass(), fields);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> fields;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n"},{"title":"ArrayList","date":"2021-11-15T08:32:10.000Z","_content":"\nArrayListList, ?\n\n### ArrayList.remove(index)\n```java\nList<String> al = new ArrayList<>(Arrays.asList(\"a\", \"b\", \"c\", \"d\", \"e\"));\nString old = al.remove(0);\nSystem.out.println(old);\n\n// output:\n// a\n```\n> : `Arrays.asList(...).remove(index)``UnsupportedOperationException`.\n> Arrays.asListArrayList(), `java.util.Arrays`, remove\n> `Arrays.asList(...)`List, add. ArrayList\n\nArrayList():\n```java\npublic class ArrayList<E> extends AbstractList<E>\n        implements List<E>, RandomAccess, Cloneable, java.io.Serializable\n{\n    // ...\n    \n    /**\n     * The array buffer into which the elements of the ArrayList are stored.\n     * The capacity of the ArrayList is the length of this array buffer. Any\n     * empty ArrayList with elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA\n     * will be expanded to DEFAULT_CAPACITY when the first element is added.\n     */\n    transient Object[] elementData; // non-private to simplify nested class access\n\n    E elementData(int index) {\n        // elementData\n        return (E) elementData[index];\n    }\n\n    /**\n     * Removes the element at the specified position in this list.\n     * Shifts any subsequent elements to the left (subtracts one from their\n     * indices).\n     *\n     * @param index the index of the element to be removed\n     * @return the element that was removed from the list\n     * @throws IndexOutOfBoundsException {@inheritDoc}\n     */\n    public E remove(int index) {\n        rangeCheck(index);\n\n        modCount++;\n        E oldValue = elementData(index);\n\n        // numMoved\n        // 0, , , null\n        int numMoved = size - index - 1;\n        if (numMoved > 0)\n            System.arraycopy(elementData, index+1, elementData, index,\n                             numMoved);\n        elementData[--size] = null; // clear to let GC do its work\n\n        return oldValue;\n    }\n\n    // ...\n}\n```\n\nArrayList`elementData`. remove, `System.arraycopy`index, null.\nSystem.arraycopynative\n```java\n/**\n * srcsrcPoslength, destdescPos\n * , length2, srcPos=3, destPos=0\n * src: [a, b, c, d, e]\n *                  \n * dest:         [1, 2, 3, 4, 5]\n * output: [a, b, 3, 4, 5](dest)\n * \n * @param src     the source array.\n * @param srcPos  starting position in the source array.\n * @param dest    the destination array.\n * @param destPos starting position in the destination data.\n * @param length  the number of array elements to be copied.\n */\npublic static native void arraycopy(Object src,  int  srcPos, Object dest, int destPos, int length);\n```\nnativeC++, [OpenJDK](https://github.com/openjdk/jdk/tags?after=jdk8-b114), `jdk\\src\\share\\native`C/C++\n - jdk\\src\\linux source for linux.\n - jdk\\src\\windows source for windows.\n - jdk\\src\\solaris souce for solaris.\n - jd\\src\\share common source.\n\n`hotspot\\src\\share\\vm\\oops\\objArrayKlass.cpp`168, copy_array, :\n```java\nwhile(length > 0){\n    dest[destPos] = src[srcPos]\n    destPos++;\n    srcPos++;\n    length--;\n}\n```\nList`[a, b, c, d, e]`, `.remove(0)`, `System.arraycopy(elementData, 1, elementData, 0, 4)``elementData``[b, c, d, e, e]`, . `elementData[--size] = null`, `[b, c, d, e, null]`, . : **clear to let GC do its work**, GC, ArrayList.size1, , `elementData`.\n\n```java\nelementData[--size] = null; // clear to let GC do its work\n```\n. , , ; , (List), , null, .\n\n\n","source":"_posts/java-arraylist.md","raw":"---\ntitle: ArrayList\ndate: 2021-11-15 16:32:10\ncategories:\n- Java\n---\n\nArrayListList, ?\n\n### ArrayList.remove(index)\n```java\nList<String> al = new ArrayList<>(Arrays.asList(\"a\", \"b\", \"c\", \"d\", \"e\"));\nString old = al.remove(0);\nSystem.out.println(old);\n\n// output:\n// a\n```\n> : `Arrays.asList(...).remove(index)``UnsupportedOperationException`.\n> Arrays.asListArrayList(), `java.util.Arrays`, remove\n> `Arrays.asList(...)`List, add. ArrayList\n\nArrayList():\n```java\npublic class ArrayList<E> extends AbstractList<E>\n        implements List<E>, RandomAccess, Cloneable, java.io.Serializable\n{\n    // ...\n    \n    /**\n     * The array buffer into which the elements of the ArrayList are stored.\n     * The capacity of the ArrayList is the length of this array buffer. Any\n     * empty ArrayList with elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA\n     * will be expanded to DEFAULT_CAPACITY when the first element is added.\n     */\n    transient Object[] elementData; // non-private to simplify nested class access\n\n    E elementData(int index) {\n        // elementData\n        return (E) elementData[index];\n    }\n\n    /**\n     * Removes the element at the specified position in this list.\n     * Shifts any subsequent elements to the left (subtracts one from their\n     * indices).\n     *\n     * @param index the index of the element to be removed\n     * @return the element that was removed from the list\n     * @throws IndexOutOfBoundsException {@inheritDoc}\n     */\n    public E remove(int index) {\n        rangeCheck(index);\n\n        modCount++;\n        E oldValue = elementData(index);\n\n        // numMoved\n        // 0, , , null\n        int numMoved = size - index - 1;\n        if (numMoved > 0)\n            System.arraycopy(elementData, index+1, elementData, index,\n                             numMoved);\n        elementData[--size] = null; // clear to let GC do its work\n\n        return oldValue;\n    }\n\n    // ...\n}\n```\n\nArrayList`elementData`. remove, `System.arraycopy`index, null.\nSystem.arraycopynative\n```java\n/**\n * srcsrcPoslength, destdescPos\n * , length2, srcPos=3, destPos=0\n * src: [a, b, c, d, e]\n *                  \n * dest:         [1, 2, 3, 4, 5]\n * output: [a, b, 3, 4, 5](dest)\n * \n * @param src     the source array.\n * @param srcPos  starting position in the source array.\n * @param dest    the destination array.\n * @param destPos starting position in the destination data.\n * @param length  the number of array elements to be copied.\n */\npublic static native void arraycopy(Object src,  int  srcPos, Object dest, int destPos, int length);\n```\nnativeC++, [OpenJDK](https://github.com/openjdk/jdk/tags?after=jdk8-b114), `jdk\\src\\share\\native`C/C++\n - jdk\\src\\linux source for linux.\n - jdk\\src\\windows source for windows.\n - jdk\\src\\solaris souce for solaris.\n - jd\\src\\share common source.\n\n`hotspot\\src\\share\\vm\\oops\\objArrayKlass.cpp`168, copy_array, :\n```java\nwhile(length > 0){\n    dest[destPos] = src[srcPos]\n    destPos++;\n    srcPos++;\n    length--;\n}\n```\nList`[a, b, c, d, e]`, `.remove(0)`, `System.arraycopy(elementData, 1, elementData, 0, 4)``elementData``[b, c, d, e, e]`, . `elementData[--size] = null`, `[b, c, d, e, null]`, . : **clear to let GC do its work**, GC, ArrayList.size1, , `elementData`.\n\n```java\nelementData[--size] = null; // clear to let GC do its work\n```\n. , , ; , (List), , null, .\n\n\n","slug":"java-arraylist","published":1,"updated":"2021-12-30T02:47:28.293Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpyb0008xotgekce7p56","content":"<p>ArrayListList, ?</p>\n<h3 id=\"ArrayList-remove-index\"><a href=\"#ArrayList-remove-index\" class=\"headerlink\" title=\"ArrayList.remove(index)\"></a>ArrayList.remove(index)</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; al = <span class=\"keyword\">new</span> ArrayList&lt;&gt;(Arrays.asList(<span class=\"string\">&quot;a&quot;</span>, <span class=\"string\">&quot;b&quot;</span>, <span class=\"string\">&quot;c&quot;</span>, <span class=\"string\">&quot;d&quot;</span>, <span class=\"string\">&quot;e&quot;</span>));</span><br><span class=\"line\">String old = al.remove(<span class=\"number\">0</span>);</span><br><span class=\"line\">System.out.println(old);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// output:</span></span><br><span class=\"line\"><span class=\"comment\">// a</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>: <code>Arrays.asList(...).remove(index)</code><code>UnsupportedOperationException</code>.<br>Arrays.asListArrayList(), <code>java.util.Arrays</code>, remove<br><code>Arrays.asList(...)</code>List, add. ArrayList</p>\n</blockquote>\n<p>ArrayList():</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ArrayList</span>&lt;<span class=\"title\">E</span>&gt; <span class=\"keyword\">extends</span> <span class=\"title\">AbstractList</span>&lt;<span class=\"title\">E</span>&gt;</span></span><br><span class=\"line\"><span class=\"class\">        <span class=\"keyword\">implements</span> <span class=\"title\">List</span>&lt;<span class=\"title\">E</span>&gt;, <span class=\"title\">RandomAccess</span>, <span class=\"title\">Cloneable</span>, <span class=\"title\">java</span>.<span class=\"title\">io</span>.<span class=\"title\">Serializable</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * The array buffer into which the elements of the ArrayList are stored.</span></span><br><span class=\"line\"><span class=\"comment\">     * The capacity of the ArrayList is the length of this array buffer. Any</span></span><br><span class=\"line\"><span class=\"comment\">     * empty ArrayList with elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA</span></span><br><span class=\"line\"><span class=\"comment\">     * will be expanded to DEFAULT_CAPACITY when the first element is added.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">transient</span> Object[] elementData; <span class=\"comment\">// non-private to simplify nested class access</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">E <span class=\"title\">elementData</span><span class=\"params\">(<span class=\"keyword\">int</span> index)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// elementData</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> (E) elementData[index];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Removes the element at the specified position in this list.</span></span><br><span class=\"line\"><span class=\"comment\">     * Shifts any subsequent elements to the left (subtracts one from their</span></span><br><span class=\"line\"><span class=\"comment\">     * indices).</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> index the index of the element to be removed</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> the element that was removed from the list</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IndexOutOfBoundsException &#123;<span class=\"doctag\">@inheritDoc</span>&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> E <span class=\"title\">remove</span><span class=\"params\">(<span class=\"keyword\">int</span> index)</span> </span>&#123;</span><br><span class=\"line\">        rangeCheck(index);</span><br><span class=\"line\"></span><br><span class=\"line\">        modCount++;</span><br><span class=\"line\">        E oldValue = elementData(index);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// numMoved</span></span><br><span class=\"line\">        <span class=\"comment\">// 0, , , null</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> numMoved = size - index - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (numMoved &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">            System.arraycopy(elementData, index+<span class=\"number\">1</span>, elementData, index,</span><br><span class=\"line\">                             numMoved);</span><br><span class=\"line\">        elementData[--size] = <span class=\"keyword\">null</span>; <span class=\"comment\">// clear to let GC do its work</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> oldValue;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ArrayList<code>elementData</code>. remove, <code>System.arraycopy</code>index, null.<br>System.arraycopynative</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * srcsrcPoslength, destdescPos</span></span><br><span class=\"line\"><span class=\"comment\"> * , length2, srcPos=3, destPos=0</span></span><br><span class=\"line\"><span class=\"comment\"> * src: [a, b, c, d, e]</span></span><br><span class=\"line\"><span class=\"comment\"> *                  </span></span><br><span class=\"line\"><span class=\"comment\"> * dest:         [1, 2, 3, 4, 5]</span></span><br><span class=\"line\"><span class=\"comment\"> * output: [a, b, 3, 4, 5](dest)</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> src     the source array.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> srcPos  starting position in the source array.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> dest    the destination array.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> destPos starting position in the destination data.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> length  the number of array elements to be copied.</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title\">arraycopy</span><span class=\"params\">(Object src,  <span class=\"keyword\">int</span>  srcPos, Object dest, <span class=\"keyword\">int</span> destPos, <span class=\"keyword\">int</span> length)</span></span>;</span><br></pre></td></tr></table></figure>\n<p>nativeC++, <a href=\"https://github.com/openjdk/jdk/tags?after=jdk8-b114\">OpenJDK</a>, <code>jdk\\src\\share\\native</code>C/C++</p>\n<ul>\n<li>jdk\\src\\linux source for linux.</li>\n<li>jdk\\src\\windows source for windows.</li>\n<li>jdk\\src\\solaris souce for solaris.</li>\n<li>jd\\src\\share common source.</li>\n</ul>\n<p><code>hotspot\\src\\share\\vm\\oops\\objArrayKlass.cpp</code>168, copy_array, :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span>(length &gt; <span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">    dest[destPos] = src[srcPos]</span><br><span class=\"line\">    destPos++;</span><br><span class=\"line\">    srcPos++;</span><br><span class=\"line\">    length--;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>List<code>[a, b, c, d, e]</code>, <code>.remove(0)</code>, <code>System.arraycopy(elementData, 1, elementData, 0, 4)</code><code>elementData</code><code>[b, c, d, e, e]</code>, . <code>elementData[--size] = null</code>, <code>[b, c, d, e, null]</code>, . : <strong>clear to let GC do its work</strong>, GC, ArrayList.size1, , <code>elementData</code>.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">elementData[--size] = <span class=\"keyword\">null</span>; <span class=\"comment\">// clear to let GC do its work</span></span><br></pre></td></tr></table></figure>\n<p>. , , ; , (List), , null, .</p>\n","site":{"data":{}},"excerpt":"","more":"<p>ArrayListList, ?</p>\n<h3 id=\"ArrayList-remove-index\"><a href=\"#ArrayList-remove-index\" class=\"headerlink\" title=\"ArrayList.remove(index)\"></a>ArrayList.remove(index)</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; al = <span class=\"keyword\">new</span> ArrayList&lt;&gt;(Arrays.asList(<span class=\"string\">&quot;a&quot;</span>, <span class=\"string\">&quot;b&quot;</span>, <span class=\"string\">&quot;c&quot;</span>, <span class=\"string\">&quot;d&quot;</span>, <span class=\"string\">&quot;e&quot;</span>));</span><br><span class=\"line\">String old = al.remove(<span class=\"number\">0</span>);</span><br><span class=\"line\">System.out.println(old);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// output:</span></span><br><span class=\"line\"><span class=\"comment\">// a</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>: <code>Arrays.asList(...).remove(index)</code><code>UnsupportedOperationException</code>.<br>Arrays.asListArrayList(), <code>java.util.Arrays</code>, remove<br><code>Arrays.asList(...)</code>List, add. ArrayList</p>\n</blockquote>\n<p>ArrayList():</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ArrayList</span>&lt;<span class=\"title\">E</span>&gt; <span class=\"keyword\">extends</span> <span class=\"title\">AbstractList</span>&lt;<span class=\"title\">E</span>&gt;</span></span><br><span class=\"line\"><span class=\"class\">        <span class=\"keyword\">implements</span> <span class=\"title\">List</span>&lt;<span class=\"title\">E</span>&gt;, <span class=\"title\">RandomAccess</span>, <span class=\"title\">Cloneable</span>, <span class=\"title\">java</span>.<span class=\"title\">io</span>.<span class=\"title\">Serializable</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * The array buffer into which the elements of the ArrayList are stored.</span></span><br><span class=\"line\"><span class=\"comment\">     * The capacity of the ArrayList is the length of this array buffer. Any</span></span><br><span class=\"line\"><span class=\"comment\">     * empty ArrayList with elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA</span></span><br><span class=\"line\"><span class=\"comment\">     * will be expanded to DEFAULT_CAPACITY when the first element is added.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">transient</span> Object[] elementData; <span class=\"comment\">// non-private to simplify nested class access</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">E <span class=\"title\">elementData</span><span class=\"params\">(<span class=\"keyword\">int</span> index)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// elementData</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> (E) elementData[index];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Removes the element at the specified position in this list.</span></span><br><span class=\"line\"><span class=\"comment\">     * Shifts any subsequent elements to the left (subtracts one from their</span></span><br><span class=\"line\"><span class=\"comment\">     * indices).</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> index the index of the element to be removed</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> the element that was removed from the list</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IndexOutOfBoundsException &#123;<span class=\"doctag\">@inheritDoc</span>&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> E <span class=\"title\">remove</span><span class=\"params\">(<span class=\"keyword\">int</span> index)</span> </span>&#123;</span><br><span class=\"line\">        rangeCheck(index);</span><br><span class=\"line\"></span><br><span class=\"line\">        modCount++;</span><br><span class=\"line\">        E oldValue = elementData(index);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// numMoved</span></span><br><span class=\"line\">        <span class=\"comment\">// 0, , , null</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> numMoved = size - index - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (numMoved &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">            System.arraycopy(elementData, index+<span class=\"number\">1</span>, elementData, index,</span><br><span class=\"line\">                             numMoved);</span><br><span class=\"line\">        elementData[--size] = <span class=\"keyword\">null</span>; <span class=\"comment\">// clear to let GC do its work</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> oldValue;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ArrayList<code>elementData</code>. remove, <code>System.arraycopy</code>index, null.<br>System.arraycopynative</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * srcsrcPoslength, destdescPos</span></span><br><span class=\"line\"><span class=\"comment\"> * , length2, srcPos=3, destPos=0</span></span><br><span class=\"line\"><span class=\"comment\"> * src: [a, b, c, d, e]</span></span><br><span class=\"line\"><span class=\"comment\"> *                  </span></span><br><span class=\"line\"><span class=\"comment\"> * dest:         [1, 2, 3, 4, 5]</span></span><br><span class=\"line\"><span class=\"comment\"> * output: [a, b, 3, 4, 5](dest)</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> src     the source array.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> srcPos  starting position in the source array.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> dest    the destination array.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> destPos starting position in the destination data.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> length  the number of array elements to be copied.</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title\">arraycopy</span><span class=\"params\">(Object src,  <span class=\"keyword\">int</span>  srcPos, Object dest, <span class=\"keyword\">int</span> destPos, <span class=\"keyword\">int</span> length)</span></span>;</span><br></pre></td></tr></table></figure>\n<p>nativeC++, <a href=\"https://github.com/openjdk/jdk/tags?after=jdk8-b114\">OpenJDK</a>, <code>jdk\\src\\share\\native</code>C/C++</p>\n<ul>\n<li>jdk\\src\\linux source for linux.</li>\n<li>jdk\\src\\windows source for windows.</li>\n<li>jdk\\src\\solaris souce for solaris.</li>\n<li>jd\\src\\share common source.</li>\n</ul>\n<p><code>hotspot\\src\\share\\vm\\oops\\objArrayKlass.cpp</code>168, copy_array, :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span>(length &gt; <span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">    dest[destPos] = src[srcPos]</span><br><span class=\"line\">    destPos++;</span><br><span class=\"line\">    srcPos++;</span><br><span class=\"line\">    length--;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>List<code>[a, b, c, d, e]</code>, <code>.remove(0)</code>, <code>System.arraycopy(elementData, 1, elementData, 0, 4)</code><code>elementData</code><code>[b, c, d, e, e]</code>, . <code>elementData[--size] = null</code>, <code>[b, c, d, e, null]</code>, . : <strong>clear to let GC do its work</strong>, GC, ArrayList.size1, , <code>elementData</code>.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">elementData[--size] = <span class=\"keyword\">null</span>; <span class=\"comment\">// clear to let GC do its work</span></span><br></pre></td></tr></table></figure>\n<p>. , , ; , (List), , null, .</p>\n"},{"title":"","date":"2021-11-02T12:31:25.000Z","_content":"\nSpring AOP.\n\n# \nOnJava8\n\n{% blockquote Bruce Eckel, OnJava8 %}\nIn recursion, one method calls itself over and over until it reaches a termination condition; with **Chain of Responsibility**, a method calls the same base-class method (with a different implementation) which calls another implementation of the base-class method, etc., until it reaches a termination condition.\n{% endblockquote %}\n\n: Java, List, List, . \n\n\nSpring AOP, Joinpoint. , MethodInterceptor, invoke, invoke. `invocation.proceed()`, \"\". \n\nMethodInterceptor, invoke(), interceptor, `ReflectiveMethodInvocation.interceptorsAndDynamicMethodMatchers`List, `proceed()`. , \"\"\n\nReflectiveMethodInvocation\n\n```java\n\n/**\n * Spring's implementation of the AOP Alliance\n * {@link org.aopalliance.intercept.MethodInvocation} interface,\n * implementing the extended\n * {@link org.springframework.aop.ProxyMethodInvocation} interface.\n *\n * <p>Invokes the target object using reflection. Subclasses can override the\n * {@link #invokeJoinpoint()} method to change this behavior, so this is also\n * a useful base class for more specialized MethodInvocation implementations.\n *\n * <p>It is possible to clone an invocation, to invoke {@link #proceed()}\n * repeatedly (once per clone), using the {@link #invocableClone()} method.\n * It is also possible to attach custom attributes to the invocation,\n * using the {@link #setUserAttribute} / {@link #getUserAttribute} methods.\n *\n * <p><b>NOTE:</b> This class is considered internal and should not be\n * directly accessed. The sole reason for it being public is compatibility\n * with existing framework integrations (e.g. Pitchfork). For any other\n * purposes, use the {@link ProxyMethodInvocation} interface instead.\n *\n * @author Rod Johnson\n * @author Juergen Hoeller\n * @author Adrian Colyer\n * @see #invokeJoinpoint\n * @see #proceed\n * @see #invocableClone\n * @see #setUserAttribute\n * @see #getUserAttribute\n */\npublic class ReflectiveMethodInvocation implements ProxyMethodInvocation, Cloneable {\n\n\tprotected final Object proxy;\n\n\t@Nullable\n\tprotected final Object target;\n\n\tprotected final Method method;\n\n\tprotected Object[] arguments = new Object[0];\n\n\t@Nullable\n\tprivate final Class<?> targetClass;\n\n\t/**\n\t * Lazily initialized map of user-specific attributes for this invocation.\n\t */\n\t@Nullable\n\tprivate Map<String, Object> userAttributes;\n\n\t/**\n\t * List of MethodInterceptor and InterceptorAndDynamicMethodMatcher\n\t * that need dynamic checks.\n\t */\n\tprotected final List<?> interceptorsAndDynamicMethodMatchers;\n\n\t/**\n\t * Index from 0 of the current interceptor we're invoking.\n\t * -1 until we invoke: then the current interceptor.\n\t */\n\tprivate int currentInterceptorIndex = -1;\n\n\n\t/**\n\t * Construct a new ReflectiveMethodInvocation with the given arguments.\n\t * @param proxy the proxy object that the invocation was made on\n\t * @param target the target object to invoke\n\t * @param method the method to invoke\n\t * @param arguments the arguments to invoke the method with\n\t * @param targetClass the target class, for MethodMatcher invocations\n\t * @param interceptorsAndDynamicMethodMatchers interceptors that should be applied,\n\t * along with any InterceptorAndDynamicMethodMatchers that need evaluation at runtime.\n\t * MethodMatchers included in this struct must already have been found to have matched\n\t * as far as was possibly statically. Passing an array might be about 10% faster,\n\t * but would complicate the code. And it would work only for static pointcuts.\n\t */\n\tprotected ReflectiveMethodInvocation(\n\tprotected ReflectiveMethodInvocation(\n\t\t\tObject proxy, @Nullable Object target, Method method, @Nullable Object[] arguments,\n\t\t\t@Nullable Class<?> targetClass, List<Object> interceptorsAndDynamicMethodMatchers) {\n\n\t\tthis.proxy = proxy;\n\t\tthis.target = target;\n\t\tthis.targetClass = targetClass;\n\t\t// bridge method\n\t\t//  JDK 1.5 Java 1.5 \n\t\tthis.method = BridgeMethodResolver.findBridgedMethod(method);\n\t\t// \n\t\tthis.arguments = AopProxyUtils.adaptArgumentsIfNecessary(method, arguments);\n\t\tthis.interceptorsAndDynamicMethodMatchers = interceptorsAndDynamicMethodMatchers;\n\t}\n\n\t@Override\n\tpublic final Object getProxy() {\n\t\treturn this.proxy;\n\t}\n\t@Override\n\t@Nullable\n\tpublic final Object getThis() {\n\t\treturn this.target;\n\t}\n\t// getStaticPartmethod\n\t@Override\n\tpublic final AccessibleObject getStaticPart() {\n\t\treturn this.method;\n\t}\n\t// \n\t@Override\n\tpublic final Method getMethod() {\n\t\treturn this.method;\n\t}\n\t@Override\n\tpublic final Object[] getArguments() {\n\t\treturn this.arguments;\n\t}\n\t@Override\n\tpublic void setArguments(Object... arguments) {\n\t\tthis.arguments = arguments;\n\t}\n\n    // \n    @Override\n\t@Nullable\n\tpublic Object proceed() throws Throwable {\n\t\t//\tWe start with an index of -1 and increment early.\n\t\tif (this.currentInterceptorIndex == this.interceptorsAndDynamicMethodMatchers.size() - 1) {\n            // \n\t\t\treturn invokeJoinpoint();\n\t\t}\n\n        //  MethodInterceptorcurrentInterceptorIndex + 1\n\t\tObject interceptorOrInterceptionAdvice =\n\t\t\t\tthis.interceptorsAndDynamicMethodMatchers.get(++this.currentInterceptorIndex);\n\t\tif (interceptorOrInterceptionAdvice instanceof InterceptorAndDynamicMethodMatcher) {\n\t\t\t// Evaluate dynamic method matcher here: static part will already have\n\t\t\t// been evaluated and found to match.\n\t\t\tInterceptorAndDynamicMethodMatcher dm =\n\t\t\t\t\t(InterceptorAndDynamicMethodMatcher) interceptorOrInterceptionAdvice;\n\t\t\tClass<?> targetClass = (this.targetClass != null ? this.targetClass : this.method.getDeclaringClass());\n\n\t\t\tif (dm.methodMatcher.matches(this.method, targetClass, this.arguments)) {\n                // invoke\n                // interceptor.invoke, invocation.proceed(), ; , \"\". invokeJoinpoint();\n\t\t\t\treturn dm.interceptor.invoke(this);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Dynamic matching failed.\n\t\t\t\t// Skip this interceptor and invoke the next in the chain.\n\t\t\t\treturn proceed();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// It's an interceptor, so we just invoke it: The pointcut will have\n\t\t\t// been evaluated statically before this object was constructed.\n\t\t\treturn ((MethodInterceptor) interceptorOrInterceptionAdvice).invoke(this);\n\t\t}\n\t}\n\n    \n\t/**\n\t * Invoke the joinpoint using reflection.\n\t * Subclasses can override this to use custom invocation.\n\t * @return the return value of the joinpoint\n\t * @throws Throwable if invoking the joinpoint resulted in an exception\n\t */\n\t@Nullable\n\tprotected Object invokeJoinpoint() throws Throwable {\n        // this.target\n        // invokeJoinpointUsingReflectionmethod.invoke(arguments);Joinpoint\n\t\treturn AopUtils.invokeJoinpointUsingReflection(this.target, this.method, this.arguments);\n\t}\n\n    // ...    \n\n}\n```\n\n, , AOP Joinpoint\n{% plantuml %}\nJoinpoint <|-- Invocation\ninterface Joinpoint {}\ninterface Invocation {}\n\nInvocation <|-- MethodInvocation\ninterface MethodInvocation {}\n\nMethodInvocation <|-- ProxyMethodInvocation\ninterface ProxyMethodInvocation {}\n\nProxyMethodInvocation <|.. ReflectiveMethodInvocation\n{% endplantuml %}\n\n```java\npackage org.aopalliance.intercept;\n\nimport java.lang.reflect.AccessibleObject;\n\n/**\n * This interface represents a generic runtime joinpoint (in the AOP\n * terminology).\n *\n * <p>A runtime joinpoint is an <i>event</i> that occurs on a static\n * joinpoint (i.e. a location in a the program). For instance, an\n * invocation is the runtime joinpoint on a method (static joinpoint).\n * The static part of a given joinpoint can be generically retrieved\n * using the {@link #getStaticPart()} method.\n *\n * <p>In the context of an interception framework, a runtime joinpoint\n * is then the reification of an access to an accessible object (a\n * method, a constructor, a field), i.e. the static part of the\n * joinpoint. It is passed to the interceptors that are installed on\n * the static joinpoint.\n *\n * @author Rod Johnson\n * @see Interceptor\n */\npublic interface Joinpoint {\n\n\t/**\n\t * Proceed to the next interceptor in the chain.\n\t * <p>The implementation and the semantics of this method depends\n\t * on the actual joinpoint type (see the children interfaces).\n\t * @return see the children interfaces' proceed definition\n\t * @throws Throwable if the joinpoint throws an exception\n\t */\n\tObject proceed() throws Throwable;\n\n\t/**\n\t * Return the object that holds the current joinpoint's static part.\n\t * <p>For instance, the target object for an invocation.\n\t * @return the object (can be null if the accessible object is static)\n\t */\n\tObject getThis();\n\n\t/**\n\t * Return the static part of this joinpoint.\n\t * <p>The static part is an accessible object on which a chain of\n\t * interceptors are installed.\n\t */\n\tAccessibleObject getStaticPart();\n\n}\n```\n\n","source":"_posts/java-chain-of-responsibility.md","raw":"---\ntitle: \ndate: 2021-11-02 20:31:25\ncategories:\n- Pattern\n---\n\nSpring AOP.\n\n# \nOnJava8\n\n{% blockquote Bruce Eckel, OnJava8 %}\nIn recursion, one method calls itself over and over until it reaches a termination condition; with **Chain of Responsibility**, a method calls the same base-class method (with a different implementation) which calls another implementation of the base-class method, etc., until it reaches a termination condition.\n{% endblockquote %}\n\n: Java, List, List, . \n\n\nSpring AOP, Joinpoint. , MethodInterceptor, invoke, invoke. `invocation.proceed()`, \"\". \n\nMethodInterceptor, invoke(), interceptor, `ReflectiveMethodInvocation.interceptorsAndDynamicMethodMatchers`List, `proceed()`. , \"\"\n\nReflectiveMethodInvocation\n\n```java\n\n/**\n * Spring's implementation of the AOP Alliance\n * {@link org.aopalliance.intercept.MethodInvocation} interface,\n * implementing the extended\n * {@link org.springframework.aop.ProxyMethodInvocation} interface.\n *\n * <p>Invokes the target object using reflection. Subclasses can override the\n * {@link #invokeJoinpoint()} method to change this behavior, so this is also\n * a useful base class for more specialized MethodInvocation implementations.\n *\n * <p>It is possible to clone an invocation, to invoke {@link #proceed()}\n * repeatedly (once per clone), using the {@link #invocableClone()} method.\n * It is also possible to attach custom attributes to the invocation,\n * using the {@link #setUserAttribute} / {@link #getUserAttribute} methods.\n *\n * <p><b>NOTE:</b> This class is considered internal and should not be\n * directly accessed. The sole reason for it being public is compatibility\n * with existing framework integrations (e.g. Pitchfork). For any other\n * purposes, use the {@link ProxyMethodInvocation} interface instead.\n *\n * @author Rod Johnson\n * @author Juergen Hoeller\n * @author Adrian Colyer\n * @see #invokeJoinpoint\n * @see #proceed\n * @see #invocableClone\n * @see #setUserAttribute\n * @see #getUserAttribute\n */\npublic class ReflectiveMethodInvocation implements ProxyMethodInvocation, Cloneable {\n\n\tprotected final Object proxy;\n\n\t@Nullable\n\tprotected final Object target;\n\n\tprotected final Method method;\n\n\tprotected Object[] arguments = new Object[0];\n\n\t@Nullable\n\tprivate final Class<?> targetClass;\n\n\t/**\n\t * Lazily initialized map of user-specific attributes for this invocation.\n\t */\n\t@Nullable\n\tprivate Map<String, Object> userAttributes;\n\n\t/**\n\t * List of MethodInterceptor and InterceptorAndDynamicMethodMatcher\n\t * that need dynamic checks.\n\t */\n\tprotected final List<?> interceptorsAndDynamicMethodMatchers;\n\n\t/**\n\t * Index from 0 of the current interceptor we're invoking.\n\t * -1 until we invoke: then the current interceptor.\n\t */\n\tprivate int currentInterceptorIndex = -1;\n\n\n\t/**\n\t * Construct a new ReflectiveMethodInvocation with the given arguments.\n\t * @param proxy the proxy object that the invocation was made on\n\t * @param target the target object to invoke\n\t * @param method the method to invoke\n\t * @param arguments the arguments to invoke the method with\n\t * @param targetClass the target class, for MethodMatcher invocations\n\t * @param interceptorsAndDynamicMethodMatchers interceptors that should be applied,\n\t * along with any InterceptorAndDynamicMethodMatchers that need evaluation at runtime.\n\t * MethodMatchers included in this struct must already have been found to have matched\n\t * as far as was possibly statically. Passing an array might be about 10% faster,\n\t * but would complicate the code. And it would work only for static pointcuts.\n\t */\n\tprotected ReflectiveMethodInvocation(\n\tprotected ReflectiveMethodInvocation(\n\t\t\tObject proxy, @Nullable Object target, Method method, @Nullable Object[] arguments,\n\t\t\t@Nullable Class<?> targetClass, List<Object> interceptorsAndDynamicMethodMatchers) {\n\n\t\tthis.proxy = proxy;\n\t\tthis.target = target;\n\t\tthis.targetClass = targetClass;\n\t\t// bridge method\n\t\t//  JDK 1.5 Java 1.5 \n\t\tthis.method = BridgeMethodResolver.findBridgedMethod(method);\n\t\t// \n\t\tthis.arguments = AopProxyUtils.adaptArgumentsIfNecessary(method, arguments);\n\t\tthis.interceptorsAndDynamicMethodMatchers = interceptorsAndDynamicMethodMatchers;\n\t}\n\n\t@Override\n\tpublic final Object getProxy() {\n\t\treturn this.proxy;\n\t}\n\t@Override\n\t@Nullable\n\tpublic final Object getThis() {\n\t\treturn this.target;\n\t}\n\t// getStaticPartmethod\n\t@Override\n\tpublic final AccessibleObject getStaticPart() {\n\t\treturn this.method;\n\t}\n\t// \n\t@Override\n\tpublic final Method getMethod() {\n\t\treturn this.method;\n\t}\n\t@Override\n\tpublic final Object[] getArguments() {\n\t\treturn this.arguments;\n\t}\n\t@Override\n\tpublic void setArguments(Object... arguments) {\n\t\tthis.arguments = arguments;\n\t}\n\n    // \n    @Override\n\t@Nullable\n\tpublic Object proceed() throws Throwable {\n\t\t//\tWe start with an index of -1 and increment early.\n\t\tif (this.currentInterceptorIndex == this.interceptorsAndDynamicMethodMatchers.size() - 1) {\n            // \n\t\t\treturn invokeJoinpoint();\n\t\t}\n\n        //  MethodInterceptorcurrentInterceptorIndex + 1\n\t\tObject interceptorOrInterceptionAdvice =\n\t\t\t\tthis.interceptorsAndDynamicMethodMatchers.get(++this.currentInterceptorIndex);\n\t\tif (interceptorOrInterceptionAdvice instanceof InterceptorAndDynamicMethodMatcher) {\n\t\t\t// Evaluate dynamic method matcher here: static part will already have\n\t\t\t// been evaluated and found to match.\n\t\t\tInterceptorAndDynamicMethodMatcher dm =\n\t\t\t\t\t(InterceptorAndDynamicMethodMatcher) interceptorOrInterceptionAdvice;\n\t\t\tClass<?> targetClass = (this.targetClass != null ? this.targetClass : this.method.getDeclaringClass());\n\n\t\t\tif (dm.methodMatcher.matches(this.method, targetClass, this.arguments)) {\n                // invoke\n                // interceptor.invoke, invocation.proceed(), ; , \"\". invokeJoinpoint();\n\t\t\t\treturn dm.interceptor.invoke(this);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Dynamic matching failed.\n\t\t\t\t// Skip this interceptor and invoke the next in the chain.\n\t\t\t\treturn proceed();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// It's an interceptor, so we just invoke it: The pointcut will have\n\t\t\t// been evaluated statically before this object was constructed.\n\t\t\treturn ((MethodInterceptor) interceptorOrInterceptionAdvice).invoke(this);\n\t\t}\n\t}\n\n    \n\t/**\n\t * Invoke the joinpoint using reflection.\n\t * Subclasses can override this to use custom invocation.\n\t * @return the return value of the joinpoint\n\t * @throws Throwable if invoking the joinpoint resulted in an exception\n\t */\n\t@Nullable\n\tprotected Object invokeJoinpoint() throws Throwable {\n        // this.target\n        // invokeJoinpointUsingReflectionmethod.invoke(arguments);Joinpoint\n\t\treturn AopUtils.invokeJoinpointUsingReflection(this.target, this.method, this.arguments);\n\t}\n\n    // ...    \n\n}\n```\n\n, , AOP Joinpoint\n{% plantuml %}\nJoinpoint <|-- Invocation\ninterface Joinpoint {}\ninterface Invocation {}\n\nInvocation <|-- MethodInvocation\ninterface MethodInvocation {}\n\nMethodInvocation <|-- ProxyMethodInvocation\ninterface ProxyMethodInvocation {}\n\nProxyMethodInvocation <|.. ReflectiveMethodInvocation\n{% endplantuml %}\n\n```java\npackage org.aopalliance.intercept;\n\nimport java.lang.reflect.AccessibleObject;\n\n/**\n * This interface represents a generic runtime joinpoint (in the AOP\n * terminology).\n *\n * <p>A runtime joinpoint is an <i>event</i> that occurs on a static\n * joinpoint (i.e. a location in a the program). For instance, an\n * invocation is the runtime joinpoint on a method (static joinpoint).\n * The static part of a given joinpoint can be generically retrieved\n * using the {@link #getStaticPart()} method.\n *\n * <p>In the context of an interception framework, a runtime joinpoint\n * is then the reification of an access to an accessible object (a\n * method, a constructor, a field), i.e. the static part of the\n * joinpoint. It is passed to the interceptors that are installed on\n * the static joinpoint.\n *\n * @author Rod Johnson\n * @see Interceptor\n */\npublic interface Joinpoint {\n\n\t/**\n\t * Proceed to the next interceptor in the chain.\n\t * <p>The implementation and the semantics of this method depends\n\t * on the actual joinpoint type (see the children interfaces).\n\t * @return see the children interfaces' proceed definition\n\t * @throws Throwable if the joinpoint throws an exception\n\t */\n\tObject proceed() throws Throwable;\n\n\t/**\n\t * Return the object that holds the current joinpoint's static part.\n\t * <p>For instance, the target object for an invocation.\n\t * @return the object (can be null if the accessible object is static)\n\t */\n\tObject getThis();\n\n\t/**\n\t * Return the static part of this joinpoint.\n\t * <p>The static part is an accessible object on which a chain of\n\t * interceptors are installed.\n\t */\n\tAccessibleObject getStaticPart();\n\n}\n```\n\n","slug":"java-chain-of-responsibility","published":1,"updated":"2021-12-30T02:47:48.767Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpye000axotg528s5jom","content":"<p>Spring AOP.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>OnJava8</p>\n<blockquote><p>In recursion, one method calls itself over and over until it reaches a termination condition; with <strong>Chain of Responsibility</strong>, a method calls the same base-class method (with a different implementation) which calls another implementation of the base-class method, etc., until it reaches a termination condition.</p>\n<footer><strong>Bruce Eckel</strong><cite>OnJava8</cite></footer></blockquote>\n\n<p>: Java, List, List, . </p>\n<p>Spring AOP, Joinpoint. , MethodInterceptor, invoke, invoke. <code>invocation.proceed()</code>, . </p>\n<p>MethodInterceptor, invoke(), interceptor, <code>ReflectiveMethodInvocation.interceptorsAndDynamicMethodMatchers</code>List, <code>proceed()</code>. , </p>\n<p>ReflectiveMethodInvocation</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Spring&#x27;s implementation of the AOP Alliance</span></span><br><span class=\"line\"><span class=\"comment\"> * &#123;<span class=\"doctag\">@link</span> org.aopalliance.intercept.MethodInvocation&#125; interface,</span></span><br><span class=\"line\"><span class=\"comment\"> * implementing the extended</span></span><br><span class=\"line\"><span class=\"comment\"> * &#123;<span class=\"doctag\">@link</span> org.springframework.aop.ProxyMethodInvocation&#125; interface.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;Invokes the target object using reflection. Subclasses can override the</span></span><br><span class=\"line\"><span class=\"comment\"> * &#123;<span class=\"doctag\">@link</span> #invokeJoinpoint()&#125; method to change this behavior, so this is also</span></span><br><span class=\"line\"><span class=\"comment\"> * a useful base class for more specialized MethodInvocation implementations.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;It is possible to clone an invocation, to invoke &#123;<span class=\"doctag\">@link</span> #proceed()&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * repeatedly (once per clone), using the &#123;<span class=\"doctag\">@link</span> #invocableClone()&#125; method.</span></span><br><span class=\"line\"><span class=\"comment\"> * It is also possible to attach custom attributes to the invocation,</span></span><br><span class=\"line\"><span class=\"comment\"> * using the &#123;<span class=\"doctag\">@link</span> #setUserAttribute&#125; / &#123;<span class=\"doctag\">@link</span> #getUserAttribute&#125; methods.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;&lt;b&gt;<span class=\"doctag\">NOTE:</span>&lt;/b&gt; This class is considered internal and should not be</span></span><br><span class=\"line\"><span class=\"comment\"> * directly accessed. The sole reason for it being public is compatibility</span></span><br><span class=\"line\"><span class=\"comment\"> * with existing framework integrations (e.g. Pitchfork). For any other</span></span><br><span class=\"line\"><span class=\"comment\"> * purposes, use the &#123;<span class=\"doctag\">@link</span> ProxyMethodInvocation&#125; interface instead.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Rod Johnson</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Juergen Hoeller</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Adrian Colyer</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #invokeJoinpoint</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #proceed</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #invocableClone</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #setUserAttribute</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #getUserAttribute</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ReflectiveMethodInvocation</span> <span class=\"keyword\">implements</span> <span class=\"title\">ProxyMethodInvocation</span>, <span class=\"title\">Cloneable</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> Object proxy;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\t<span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> Object target;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> Method method;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">protected</span> Object[] arguments = <span class=\"keyword\">new</span> Object[<span class=\"number\">0</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Class&lt;?&gt; targetClass;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Lazily initialized map of user-specific attributes for this invocation.</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> Map&lt;String, Object&gt; userAttributes;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * List of MethodInterceptor and InterceptorAndDynamicMethodMatcher</span></span><br><span class=\"line\"><span class=\"comment\">\t * that need dynamic checks.</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> List&lt;?&gt; interceptorsAndDynamicMethodMatchers;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Index from 0 of the current interceptor we&#x27;re invoking.</span></span><br><span class=\"line\"><span class=\"comment\">\t * -1 until we invoke: then the current interceptor.</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span> currentInterceptorIndex = -<span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Construct a new ReflectiveMethodInvocation with the given arguments.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> proxy the proxy object that the invocation was made on</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> target the target object to invoke</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> method the method to invoke</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> arguments the arguments to invoke the method with</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> targetClass the target class, for MethodMatcher invocations</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> interceptorsAndDynamicMethodMatchers interceptors that should be applied,</span></span><br><span class=\"line\"><span class=\"comment\">\t * along with any InterceptorAndDynamicMethodMatchers that need evaluation at runtime.</span></span><br><span class=\"line\"><span class=\"comment\">\t * MethodMatchers included in this struct must already have been found to have matched</span></span><br><span class=\"line\"><span class=\"comment\">\t * as far as was possibly statically. Passing an array might be about 10% faster,</span></span><br><span class=\"line\"><span class=\"comment\">\t * but would complicate the code. And it would work only for static pointcuts.</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"title\">ReflectiveMethodInvocation</span><span class=\"params\">(</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">\t<span class=\"keyword\">protected</span> ReflectiveMethodInvocation(</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">\t\t\tObject proxy, <span class=\"meta\">@Nullable</span> Object target, Method method, <span class=\"meta\">@Nullable</span> Object[] arguments,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">\t\t\t<span class=\"meta\">@Nullable</span> Class&lt;?&gt; targetClass, List&lt;Object&gt; interceptorsAndDynamicMethodMatchers)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.proxy = proxy;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.target = target;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.targetClass = targetClass;</span><br><span class=\"line\">\t\t<span class=\"comment\">// bridge method</span></span><br><span class=\"line\">\t\t<span class=\"comment\">//  JDK 1.5 Java 1.5 </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.method = BridgeMethodResolver.findBridgedMethod(method);</span><br><span class=\"line\">\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.arguments = AopProxyUtils.adaptArgumentsIfNecessary(method, arguments);</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.interceptorsAndDynamicMethodMatchers = interceptorsAndDynamicMethodMatchers;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> Object <span class=\"title\">getProxy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.proxy;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> Object <span class=\"title\">getThis</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.target;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">// getStaticPartmethod</span></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> AccessibleObject <span class=\"title\">getStaticPart</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.method;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> Method <span class=\"title\">getMethod</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.method;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">final</span> Object[] getArguments() &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.arguments;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setArguments</span><span class=\"params\">(Object... arguments)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.arguments = arguments;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">proceed</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//\tWe start with an index of -1 and increment early.</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.currentInterceptorIndex == <span class=\"keyword\">this</span>.interceptorsAndDynamicMethodMatchers.size() - <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> invokeJoinpoint();</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//  MethodInterceptorcurrentInterceptorIndex + 1</span></span><br><span class=\"line\">\t\tObject interceptorOrInterceptionAdvice =</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">this</span>.interceptorsAndDynamicMethodMatchers.get(++<span class=\"keyword\">this</span>.currentInterceptorIndex);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (interceptorOrInterceptionAdvice <span class=\"keyword\">instanceof</span> InterceptorAndDynamicMethodMatcher) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// Evaluate dynamic method matcher here: static part will already have</span></span><br><span class=\"line\">\t\t\t<span class=\"comment\">// been evaluated and found to match.</span></span><br><span class=\"line\">\t\t\tInterceptorAndDynamicMethodMatcher dm =</span><br><span class=\"line\">\t\t\t\t\t(InterceptorAndDynamicMethodMatcher) interceptorOrInterceptionAdvice;</span><br><span class=\"line\">\t\t\tClass&lt;?&gt; targetClass = (<span class=\"keyword\">this</span>.targetClass != <span class=\"keyword\">null</span> ? <span class=\"keyword\">this</span>.targetClass : <span class=\"keyword\">this</span>.method.getDeclaringClass());</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (dm.methodMatcher.matches(<span class=\"keyword\">this</span>.method, targetClass, <span class=\"keyword\">this</span>.arguments)) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// invoke</span></span><br><span class=\"line\">                <span class=\"comment\">// interceptor.invoke, invocation.proceed(), ; , &quot;&quot;. invokeJoinpoint();</span></span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> dm.interceptor.invoke(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">// Dynamic matching failed.</span></span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">// Skip this interceptor and invoke the next in the chain.</span></span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> proceed();</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// It&#x27;s an interceptor, so we just invoke it: The pointcut will have</span></span><br><span class=\"line\">\t\t\t<span class=\"comment\">// been evaluated statically before this object was constructed.</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> ((MethodInterceptor) interceptorOrInterceptionAdvice).invoke(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Invoke the joinpoint using reflection.</span></span><br><span class=\"line\"><span class=\"comment\">\t * Subclasses can override this to use custom invocation.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> the return value of the joinpoint</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@throws</span> Throwable if invoking the joinpoint resulted in an exception</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">protected</span> Object <span class=\"title\">invokeJoinpoint</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// this.target</span></span><br><span class=\"line\">        <span class=\"comment\">// invokeJoinpointUsingReflectionmethod.invoke(arguments);Joinpoint</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> AopUtils.invokeJoinpointUsingReflection(<span class=\"keyword\">this</span>.target, <span class=\"keyword\">this</span>.method, <span class=\"keyword\">this</span>.arguments);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...    </span></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>, , AOP Joinpoint</p>\n<img  src=http://www.plantuml.com/plantuml/svg/yyhFp2i0uX85cnfTNGNFlBByvCIIpFmyBg1OQb5QOdAgWXTSJNKjaZ12BKYS2uaBDietjIGZFmMhWUXIOFqOWc1J0ehoAohn68LL7cmUTXcR6ZqzXQ3Kj9pKv9BCibHqUG00>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.aopalliance.intercept;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.lang.reflect.AccessibleObject;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * This interface represents a generic runtime joinpoint (in the AOP</span></span><br><span class=\"line\"><span class=\"comment\"> * terminology).</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;A runtime joinpoint is an &lt;i&gt;event&lt;/i&gt; that occurs on a static</span></span><br><span class=\"line\"><span class=\"comment\"> * joinpoint (i.e. a location in a the program). For instance, an</span></span><br><span class=\"line\"><span class=\"comment\"> * invocation is the runtime joinpoint on a method (static joinpoint).</span></span><br><span class=\"line\"><span class=\"comment\"> * The static part of a given joinpoint can be generically retrieved</span></span><br><span class=\"line\"><span class=\"comment\"> * using the &#123;<span class=\"doctag\">@link</span> #getStaticPart()&#125; method.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;In the context of an interception framework, a runtime joinpoint</span></span><br><span class=\"line\"><span class=\"comment\"> * is then the reification of an access to an accessible object (a</span></span><br><span class=\"line\"><span class=\"comment\"> * method, a constructor, a field), i.e. the static part of the</span></span><br><span class=\"line\"><span class=\"comment\"> * joinpoint. It is passed to the interceptors that are installed on</span></span><br><span class=\"line\"><span class=\"comment\"> * the static joinpoint.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Rod Johnson</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> Interceptor</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Joinpoint</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Proceed to the next interceptor in the chain.</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;p&gt;The implementation and the semantics of this method depends</span></span><br><span class=\"line\"><span class=\"comment\">\t * on the actual joinpoint type (see the children interfaces).</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> see the children interfaces&#x27; proceed definition</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@throws</span> Throwable if the joinpoint throws an exception</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\">Object <span class=\"title\">proceed</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Throwable</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Return the object that holds the current joinpoint&#x27;s static part.</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;p&gt;For instance, the target object for an invocation.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> the object (can be null if the accessible object is static)</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\">Object <span class=\"title\">getThis</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Return the static part of this joinpoint.</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;p&gt;The static part is an accessible object on which a chain of</span></span><br><span class=\"line\"><span class=\"comment\">\t * interceptors are installed.</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\">AccessibleObject <span class=\"title\">getStaticPart</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<p>Spring AOP.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>OnJava8</p>\n<blockquote><p>In recursion, one method calls itself over and over until it reaches a termination condition; with <strong>Chain of Responsibility</strong>, a method calls the same base-class method (with a different implementation) which calls another implementation of the base-class method, etc., until it reaches a termination condition.</p>\n<footer><strong>Bruce Eckel</strong><cite>OnJava8</cite></footer></blockquote>\n\n<p>: Java, List, List, . </p>\n<p>Spring AOP, Joinpoint. , MethodInterceptor, invoke, invoke. <code>invocation.proceed()</code>, . </p>\n<p>MethodInterceptor, invoke(), interceptor, <code>ReflectiveMethodInvocation.interceptorsAndDynamicMethodMatchers</code>List, <code>proceed()</code>. , </p>\n<p>ReflectiveMethodInvocation</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Spring&#x27;s implementation of the AOP Alliance</span></span><br><span class=\"line\"><span class=\"comment\"> * &#123;<span class=\"doctag\">@link</span> org.aopalliance.intercept.MethodInvocation&#125; interface,</span></span><br><span class=\"line\"><span class=\"comment\"> * implementing the extended</span></span><br><span class=\"line\"><span class=\"comment\"> * &#123;<span class=\"doctag\">@link</span> org.springframework.aop.ProxyMethodInvocation&#125; interface.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;Invokes the target object using reflection. Subclasses can override the</span></span><br><span class=\"line\"><span class=\"comment\"> * &#123;<span class=\"doctag\">@link</span> #invokeJoinpoint()&#125; method to change this behavior, so this is also</span></span><br><span class=\"line\"><span class=\"comment\"> * a useful base class for more specialized MethodInvocation implementations.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;It is possible to clone an invocation, to invoke &#123;<span class=\"doctag\">@link</span> #proceed()&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * repeatedly (once per clone), using the &#123;<span class=\"doctag\">@link</span> #invocableClone()&#125; method.</span></span><br><span class=\"line\"><span class=\"comment\"> * It is also possible to attach custom attributes to the invocation,</span></span><br><span class=\"line\"><span class=\"comment\"> * using the &#123;<span class=\"doctag\">@link</span> #setUserAttribute&#125; / &#123;<span class=\"doctag\">@link</span> #getUserAttribute&#125; methods.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;&lt;b&gt;<span class=\"doctag\">NOTE:</span>&lt;/b&gt; This class is considered internal and should not be</span></span><br><span class=\"line\"><span class=\"comment\"> * directly accessed. The sole reason for it being public is compatibility</span></span><br><span class=\"line\"><span class=\"comment\"> * with existing framework integrations (e.g. Pitchfork). For any other</span></span><br><span class=\"line\"><span class=\"comment\"> * purposes, use the &#123;<span class=\"doctag\">@link</span> ProxyMethodInvocation&#125; interface instead.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Rod Johnson</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Juergen Hoeller</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Adrian Colyer</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #invokeJoinpoint</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #proceed</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #invocableClone</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #setUserAttribute</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> #getUserAttribute</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ReflectiveMethodInvocation</span> <span class=\"keyword\">implements</span> <span class=\"title\">ProxyMethodInvocation</span>, <span class=\"title\">Cloneable</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> Object proxy;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\t<span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> Object target;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> Method method;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">protected</span> Object[] arguments = <span class=\"keyword\">new</span> Object[<span class=\"number\">0</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Class&lt;?&gt; targetClass;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Lazily initialized map of user-specific attributes for this invocation.</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> Map&lt;String, Object&gt; userAttributes;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * List of MethodInterceptor and InterceptorAndDynamicMethodMatcher</span></span><br><span class=\"line\"><span class=\"comment\">\t * that need dynamic checks.</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> List&lt;?&gt; interceptorsAndDynamicMethodMatchers;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Index from 0 of the current interceptor we&#x27;re invoking.</span></span><br><span class=\"line\"><span class=\"comment\">\t * -1 until we invoke: then the current interceptor.</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span> currentInterceptorIndex = -<span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Construct a new ReflectiveMethodInvocation with the given arguments.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> proxy the proxy object that the invocation was made on</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> target the target object to invoke</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> method the method to invoke</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> arguments the arguments to invoke the method with</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> targetClass the target class, for MethodMatcher invocations</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> interceptorsAndDynamicMethodMatchers interceptors that should be applied,</span></span><br><span class=\"line\"><span class=\"comment\">\t * along with any InterceptorAndDynamicMethodMatchers that need evaluation at runtime.</span></span><br><span class=\"line\"><span class=\"comment\">\t * MethodMatchers included in this struct must already have been found to have matched</span></span><br><span class=\"line\"><span class=\"comment\">\t * as far as was possibly statically. Passing an array might be about 10% faster,</span></span><br><span class=\"line\"><span class=\"comment\">\t * but would complicate the code. And it would work only for static pointcuts.</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"title\">ReflectiveMethodInvocation</span><span class=\"params\">(</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">\t<span class=\"keyword\">protected</span> ReflectiveMethodInvocation(</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">\t\t\tObject proxy, <span class=\"meta\">@Nullable</span> Object target, Method method, <span class=\"meta\">@Nullable</span> Object[] arguments,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">\t\t\t<span class=\"meta\">@Nullable</span> Class&lt;?&gt; targetClass, List&lt;Object&gt; interceptorsAndDynamicMethodMatchers)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.proxy = proxy;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.target = target;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.targetClass = targetClass;</span><br><span class=\"line\">\t\t<span class=\"comment\">// bridge method</span></span><br><span class=\"line\">\t\t<span class=\"comment\">//  JDK 1.5 Java 1.5 </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.method = BridgeMethodResolver.findBridgedMethod(method);</span><br><span class=\"line\">\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.arguments = AopProxyUtils.adaptArgumentsIfNecessary(method, arguments);</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.interceptorsAndDynamicMethodMatchers = interceptorsAndDynamicMethodMatchers;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> Object <span class=\"title\">getProxy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.proxy;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> Object <span class=\"title\">getThis</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.target;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">// getStaticPartmethod</span></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> AccessibleObject <span class=\"title\">getStaticPart</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.method;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> Method <span class=\"title\">getMethod</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.method;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">final</span> Object[] getArguments() &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.arguments;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setArguments</span><span class=\"params\">(Object... arguments)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.arguments = arguments;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">proceed</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//\tWe start with an index of -1 and increment early.</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.currentInterceptorIndex == <span class=\"keyword\">this</span>.interceptorsAndDynamicMethodMatchers.size() - <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> invokeJoinpoint();</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//  MethodInterceptorcurrentInterceptorIndex + 1</span></span><br><span class=\"line\">\t\tObject interceptorOrInterceptionAdvice =</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">this</span>.interceptorsAndDynamicMethodMatchers.get(++<span class=\"keyword\">this</span>.currentInterceptorIndex);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (interceptorOrInterceptionAdvice <span class=\"keyword\">instanceof</span> InterceptorAndDynamicMethodMatcher) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// Evaluate dynamic method matcher here: static part will already have</span></span><br><span class=\"line\">\t\t\t<span class=\"comment\">// been evaluated and found to match.</span></span><br><span class=\"line\">\t\t\tInterceptorAndDynamicMethodMatcher dm =</span><br><span class=\"line\">\t\t\t\t\t(InterceptorAndDynamicMethodMatcher) interceptorOrInterceptionAdvice;</span><br><span class=\"line\">\t\t\tClass&lt;?&gt; targetClass = (<span class=\"keyword\">this</span>.targetClass != <span class=\"keyword\">null</span> ? <span class=\"keyword\">this</span>.targetClass : <span class=\"keyword\">this</span>.method.getDeclaringClass());</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (dm.methodMatcher.matches(<span class=\"keyword\">this</span>.method, targetClass, <span class=\"keyword\">this</span>.arguments)) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// invoke</span></span><br><span class=\"line\">                <span class=\"comment\">// interceptor.invoke, invocation.proceed(), ; , &quot;&quot;. invokeJoinpoint();</span></span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> dm.interceptor.invoke(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">// Dynamic matching failed.</span></span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">// Skip this interceptor and invoke the next in the chain.</span></span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> proceed();</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// It&#x27;s an interceptor, so we just invoke it: The pointcut will have</span></span><br><span class=\"line\">\t\t\t<span class=\"comment\">// been evaluated statically before this object was constructed.</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> ((MethodInterceptor) interceptorOrInterceptionAdvice).invoke(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Invoke the joinpoint using reflection.</span></span><br><span class=\"line\"><span class=\"comment\">\t * Subclasses can override this to use custom invocation.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> the return value of the joinpoint</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@throws</span> Throwable if invoking the joinpoint resulted in an exception</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">protected</span> Object <span class=\"title\">invokeJoinpoint</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// this.target</span></span><br><span class=\"line\">        <span class=\"comment\">// invokeJoinpointUsingReflectionmethod.invoke(arguments);Joinpoint</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> AopUtils.invokeJoinpointUsingReflection(<span class=\"keyword\">this</span>.target, <span class=\"keyword\">this</span>.method, <span class=\"keyword\">this</span>.arguments);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...    </span></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>, , AOP Joinpoint</p>\n<img  src=http://www.plantuml.com/plantuml/svg/yyhFp2i0uX85cnfTNGNFlBByvCIIpFmyBg1OQb5QOdAgWXTSJNKjaZ12BKYS2uaBDietjIGZFmMhWUXIOFqOWc1J0ehoAohn68LL7cmUTXcR6ZqzXQ3Kj9pKv9BCibHqUG00>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.aopalliance.intercept;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.lang.reflect.AccessibleObject;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * This interface represents a generic runtime joinpoint (in the AOP</span></span><br><span class=\"line\"><span class=\"comment\"> * terminology).</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;A runtime joinpoint is an &lt;i&gt;event&lt;/i&gt; that occurs on a static</span></span><br><span class=\"line\"><span class=\"comment\"> * joinpoint (i.e. a location in a the program). For instance, an</span></span><br><span class=\"line\"><span class=\"comment\"> * invocation is the runtime joinpoint on a method (static joinpoint).</span></span><br><span class=\"line\"><span class=\"comment\"> * The static part of a given joinpoint can be generically retrieved</span></span><br><span class=\"line\"><span class=\"comment\"> * using the &#123;<span class=\"doctag\">@link</span> #getStaticPart()&#125; method.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;In the context of an interception framework, a runtime joinpoint</span></span><br><span class=\"line\"><span class=\"comment\"> * is then the reification of an access to an accessible object (a</span></span><br><span class=\"line\"><span class=\"comment\"> * method, a constructor, a field), i.e. the static part of the</span></span><br><span class=\"line\"><span class=\"comment\"> * joinpoint. It is passed to the interceptors that are installed on</span></span><br><span class=\"line\"><span class=\"comment\"> * the static joinpoint.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Rod Johnson</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> Interceptor</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Joinpoint</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Proceed to the next interceptor in the chain.</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;p&gt;The implementation and the semantics of this method depends</span></span><br><span class=\"line\"><span class=\"comment\">\t * on the actual joinpoint type (see the children interfaces).</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> see the children interfaces&#x27; proceed definition</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@throws</span> Throwable if the joinpoint throws an exception</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\">Object <span class=\"title\">proceed</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Throwable</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Return the object that holds the current joinpoint&#x27;s static part.</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;p&gt;For instance, the target object for an invocation.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> the object (can be null if the accessible object is static)</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\">Object <span class=\"title\">getThis</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Return the static part of this joinpoint.</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;p&gt;The static part is an accessible object on which a chain of</span></span><br><span class=\"line\"><span class=\"comment\">\t * interceptors are installed.</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\">AccessibleObject <span class=\"title\">getStaticPart</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n"},{"title":"Java","date":"2021-06-15T02:50:33.000Z","_content":"\n# ClassLoader\nA class loader is an object that is responsible for loading classes. The class ClassLoader is an abstract class. Given the binary name of a class, a class loader should attempt to locate or generate data that constitutes a definition for the class. A typical strategy is to transform the name into a file name and then read a \"class file\" of that name from a file system.\n. ClassLoader. , . , class file.\n\nEvery Class object contains a reference to the ClassLoader that defined it.\nClass, ClassLoader.\n> , Class, FiledClassLoader\n```java\npublic final class Class<T> implements java.io.Serializable,\n                              GenericDeclaration,\n                              Type,\n                              AnnotatedElement {\n\n    // ...\n\n    /*\n     * Private constructor. Only the Java Virtual Machine creates Class objects.\n     * This constructor is not used and prevents the default constructor being\n     * generated.\n     */\n    // NOTE: , Class\n    private Class(ClassLoader loader) {\n        // Initialize final field for classLoader.  The initialization value of non-null\n        // prevents future JIT optimizations from assuming this final field is null.\n        classLoader = loader;\n    }\n\n    // ...\n\n    // Initialized in JVM not by private constructor\n    // This field is filtered from reflection access, i.e. getDeclaredField\n    // will throw NoSuchFieldException\n    private final ClassLoader classLoader;\n\n    // ...\n}\n```\n\nApplications implement subclasses of ClassLoader in order to extend the manner in which the Java virtual machine dynamically loads classes.\nClassLoader, JVM.\n\nThe ClassLoader class uses a delegation model to search for classes and resources. Each instance of ClassLoader has an associated parent class loader. When requested to find a class or resource, a ClassLoader instance will delegate the search for the class or resource to its parent class loader before attempting to find the class or resource itself. The virtual machine's built-in class loader, called the \"bootstrap class loader\", does not itself have a parent but may serve as the parent of a ClassLoader instance.\nClassLoader  ClassLoader ClassLoader  ClassLoader \n\nNormally, the Java virtual machine loads classes from the local file system in a platform-dependent manner. For example, on UNIX systems, the virtual machine loads classes from the directory defined by the CLASSPATH environment variable.\n, JVM. , UNIX, JVNCLASSPATH.\n\nHowever, some classes may not originate from a file; they may originate from other sources, such as the network, or they could be constructed by an application. The method defineClass converts an array of bytes into an instance of class Class. Instances of this newly defined class can be created using Class.newInstance.\n, ; , . `defineClass`Class. `Class.newInstace`.\n\nThe methods and constructors of objects created by a class loader may reference other classes. To determine the class(es) referred to, the Java virtual machine invokes the loadClass method of the class loader that originally created the class.\n, . \n\nFor example, an application could create a network class loader to download class files from a server. Sample code might look like:\n\n   ClassLoader loader = new NetworkClassLoader(host, port);\n   Object main = loader.loadClass(\"Main\", true).newInstance();\n        . . .\n \n\nThe network class loader subclass must define the methods findClass and loadClassData to load a class from the network. Once it has downloaded the bytes that make up the class, it should use the method defineClass to create a class instance. A sample implementation is:\n\n     class NetworkClassLoader extends ClassLoader {\n         String host;\n         int port;\n\n         public Class findClass(String name) {\n             byte[] b = loadClassData(name);\n             return defineClass(name, b, 0, b.length);\n         }\n\n         private byte[] loadClassData(String name) {\n             // load the class data from the connection\n              . . .\n         }\n     }\n","source":"_posts/java-classloader.md","raw":"---\ntitle: Java\ndate: 2021-06-15 10:50:33\ncategories:\n- Java\ntags:\n- ClassLoader\n---\n\n# ClassLoader\nA class loader is an object that is responsible for loading classes. The class ClassLoader is an abstract class. Given the binary name of a class, a class loader should attempt to locate or generate data that constitutes a definition for the class. A typical strategy is to transform the name into a file name and then read a \"class file\" of that name from a file system.\n. ClassLoader. , . , class file.\n\nEvery Class object contains a reference to the ClassLoader that defined it.\nClass, ClassLoader.\n> , Class, FiledClassLoader\n```java\npublic final class Class<T> implements java.io.Serializable,\n                              GenericDeclaration,\n                              Type,\n                              AnnotatedElement {\n\n    // ...\n\n    /*\n     * Private constructor. Only the Java Virtual Machine creates Class objects.\n     * This constructor is not used and prevents the default constructor being\n     * generated.\n     */\n    // NOTE: , Class\n    private Class(ClassLoader loader) {\n        // Initialize final field for classLoader.  The initialization value of non-null\n        // prevents future JIT optimizations from assuming this final field is null.\n        classLoader = loader;\n    }\n\n    // ...\n\n    // Initialized in JVM not by private constructor\n    // This field is filtered from reflection access, i.e. getDeclaredField\n    // will throw NoSuchFieldException\n    private final ClassLoader classLoader;\n\n    // ...\n}\n```\n\nApplications implement subclasses of ClassLoader in order to extend the manner in which the Java virtual machine dynamically loads classes.\nClassLoader, JVM.\n\nThe ClassLoader class uses a delegation model to search for classes and resources. Each instance of ClassLoader has an associated parent class loader. When requested to find a class or resource, a ClassLoader instance will delegate the search for the class or resource to its parent class loader before attempting to find the class or resource itself. The virtual machine's built-in class loader, called the \"bootstrap class loader\", does not itself have a parent but may serve as the parent of a ClassLoader instance.\nClassLoader  ClassLoader ClassLoader  ClassLoader \n\nNormally, the Java virtual machine loads classes from the local file system in a platform-dependent manner. For example, on UNIX systems, the virtual machine loads classes from the directory defined by the CLASSPATH environment variable.\n, JVM. , UNIX, JVNCLASSPATH.\n\nHowever, some classes may not originate from a file; they may originate from other sources, such as the network, or they could be constructed by an application. The method defineClass converts an array of bytes into an instance of class Class. Instances of this newly defined class can be created using Class.newInstance.\n, ; , . `defineClass`Class. `Class.newInstace`.\n\nThe methods and constructors of objects created by a class loader may reference other classes. To determine the class(es) referred to, the Java virtual machine invokes the loadClass method of the class loader that originally created the class.\n, . \n\nFor example, an application could create a network class loader to download class files from a server. Sample code might look like:\n\n   ClassLoader loader = new NetworkClassLoader(host, port);\n   Object main = loader.loadClass(\"Main\", true).newInstance();\n        . . .\n \n\nThe network class loader subclass must define the methods findClass and loadClassData to load a class from the network. Once it has downloaded the bytes that make up the class, it should use the method defineClass to create a class instance. A sample implementation is:\n\n     class NetworkClassLoader extends ClassLoader {\n         String host;\n         int port;\n\n         public Class findClass(String name) {\n             byte[] b = loadClassData(name);\n             return defineClass(name, b, 0, b.length);\n         }\n\n         private byte[] loadClassData(String name) {\n             // load the class data from the connection\n              . . .\n         }\n     }\n","slug":"java-classloader","published":1,"updated":"2021-12-30T03:01:15.553Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpyf000bxotg7gxz7t70","content":"<h1 id=\"ClassLoader\"><a href=\"#ClassLoader\" class=\"headerlink\" title=\"ClassLoader\"></a>ClassLoader</h1><p>A class loader is an object that is responsible for loading classes. The class ClassLoader is an abstract class. Given the binary name of a class, a class loader should attempt to locate or generate data that constitutes a definition for the class. A typical strategy is to transform the name into a file name and then read a class file of that name from a file system.<br>. ClassLoader. , . , class file.</p>\n<p>Every Class object contains a reference to the ClassLoader that defined it.<br>Class, ClassLoader.</p>\n<blockquote>\n<p>, Class, FiledClassLoader</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Class</span>&lt;<span class=\"title\">T</span>&gt; <span class=\"keyword\">implements</span> <span class=\"title\">java</span>.<span class=\"title\">io</span>.<span class=\"title\">Serializable</span>,</span></span><br><span class=\"line\"><span class=\"class\">                              <span class=\"title\">GenericDeclaration</span>,</span></span><br><span class=\"line\"><span class=\"class\">                              <span class=\"title\">Type</span>,</span></span><br><span class=\"line\"><span class=\"class\">                              <span class=\"title\">AnnotatedElement</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     * Private constructor. Only the Java Virtual Machine creates Class objects.</span></span><br><span class=\"line\"><span class=\"comment\">     * This constructor is not used and prevents the default constructor being</span></span><br><span class=\"line\"><span class=\"comment\">     * generated.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"comment\">// <span class=\"doctag\">NOTE:</span> , Class</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Class</span><span class=\"params\">(ClassLoader loader)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// Initialize final field for classLoader.  The initialization value of non-null</span></span><br><span class=\"line\">        <span class=\"comment\">// prevents future JIT optimizations from assuming this final field is null.</span></span><br><span class=\"line\">        classLoader = loader;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Initialized in JVM not by private constructor</span></span><br><span class=\"line\">    <span class=\"comment\">// This field is filtered from reflection access, i.e. getDeclaredField</span></span><br><span class=\"line\">    <span class=\"comment\">// will throw NoSuchFieldException</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> ClassLoader classLoader;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Applications implement subclasses of ClassLoader in order to extend the manner in which the Java virtual machine dynamically loads classes.<br>ClassLoader, JVM.</p>\n<p>The ClassLoader class uses a delegation model to search for classes and resources. Each instance of ClassLoader has an associated parent class loader. When requested to find a class or resource, a ClassLoader instance will delegate the search for the class or resource to its parent class loader before attempting to find the class or resource itself. The virtual machines built-in class loader, called the bootstrap class loader, does not itself have a parent but may serve as the parent of a ClassLoader instance.<br>ClassLoader  ClassLoader ClassLoader  ClassLoader </p>\n<p>Normally, the Java virtual machine loads classes from the local file system in a platform-dependent manner. For example, on UNIX systems, the virtual machine loads classes from the directory defined by the CLASSPATH environment variable.<br>, JVM. , UNIX, JVNCLASSPATH.</p>\n<p>However, some classes may not originate from a file; they may originate from other sources, such as the network, or they could be constructed by an application. The method defineClass converts an array of bytes into an instance of class Class. Instances of this newly defined class can be created using Class.newInstance.<br>, ; , . <code>defineClass</code>Class. <code>Class.newInstace</code>.</p>\n<p>The methods and constructors of objects created by a class loader may reference other classes. To determine the class(es) referred to, the Java virtual machine invokes the loadClass method of the class loader that originally created the class.<br>, . </p>\n<p>For example, an application could create a network class loader to download class files from a server. Sample code might look like:</p>\n<p>   ClassLoader loader = new NetworkClassLoader(host, port);<br>   Object main = loader.loadClass(Main, true).newInstance();<br>        . . .</p>\n<p>The network class loader subclass must define the methods findClass and loadClassData to load a class from the network. Once it has downloaded the bytes that make up the class, it should use the method defineClass to create a class instance. A sample implementation is:</p>\n<pre><code> class NetworkClassLoader extends ClassLoader &#123;\n     String host;\n     int port;\n\n     public Class findClass(String name) &#123;\n         byte[] b = loadClassData(name);\n         return defineClass(name, b, 0, b.length);\n     &#125;\n\n     private byte[] loadClassData(String name) &#123;\n         // load the class data from the connection\n          . . .\n     &#125;\n &#125;\n</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"ClassLoader\"><a href=\"#ClassLoader\" class=\"headerlink\" title=\"ClassLoader\"></a>ClassLoader</h1><p>A class loader is an object that is responsible for loading classes. The class ClassLoader is an abstract class. Given the binary name of a class, a class loader should attempt to locate or generate data that constitutes a definition for the class. A typical strategy is to transform the name into a file name and then read a class file of that name from a file system.<br>. ClassLoader. , . , class file.</p>\n<p>Every Class object contains a reference to the ClassLoader that defined it.<br>Class, ClassLoader.</p>\n<blockquote>\n<p>, Class, FiledClassLoader</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Class</span>&lt;<span class=\"title\">T</span>&gt; <span class=\"keyword\">implements</span> <span class=\"title\">java</span>.<span class=\"title\">io</span>.<span class=\"title\">Serializable</span>,</span></span><br><span class=\"line\"><span class=\"class\">                              <span class=\"title\">GenericDeclaration</span>,</span></span><br><span class=\"line\"><span class=\"class\">                              <span class=\"title\">Type</span>,</span></span><br><span class=\"line\"><span class=\"class\">                              <span class=\"title\">AnnotatedElement</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     * Private constructor. Only the Java Virtual Machine creates Class objects.</span></span><br><span class=\"line\"><span class=\"comment\">     * This constructor is not used and prevents the default constructor being</span></span><br><span class=\"line\"><span class=\"comment\">     * generated.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"comment\">// <span class=\"doctag\">NOTE:</span> , Class</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Class</span><span class=\"params\">(ClassLoader loader)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// Initialize final field for classLoader.  The initialization value of non-null</span></span><br><span class=\"line\">        <span class=\"comment\">// prevents future JIT optimizations from assuming this final field is null.</span></span><br><span class=\"line\">        classLoader = loader;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Initialized in JVM not by private constructor</span></span><br><span class=\"line\">    <span class=\"comment\">// This field is filtered from reflection access, i.e. getDeclaredField</span></span><br><span class=\"line\">    <span class=\"comment\">// will throw NoSuchFieldException</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> ClassLoader classLoader;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Applications implement subclasses of ClassLoader in order to extend the manner in which the Java virtual machine dynamically loads classes.<br>ClassLoader, JVM.</p>\n<p>The ClassLoader class uses a delegation model to search for classes and resources. Each instance of ClassLoader has an associated parent class loader. When requested to find a class or resource, a ClassLoader instance will delegate the search for the class or resource to its parent class loader before attempting to find the class or resource itself. The virtual machines built-in class loader, called the bootstrap class loader, does not itself have a parent but may serve as the parent of a ClassLoader instance.<br>ClassLoader  ClassLoader ClassLoader  ClassLoader </p>\n<p>Normally, the Java virtual machine loads classes from the local file system in a platform-dependent manner. For example, on UNIX systems, the virtual machine loads classes from the directory defined by the CLASSPATH environment variable.<br>, JVM. , UNIX, JVNCLASSPATH.</p>\n<p>However, some classes may not originate from a file; they may originate from other sources, such as the network, or they could be constructed by an application. The method defineClass converts an array of bytes into an instance of class Class. Instances of this newly defined class can be created using Class.newInstance.<br>, ; , . <code>defineClass</code>Class. <code>Class.newInstace</code>.</p>\n<p>The methods and constructors of objects created by a class loader may reference other classes. To determine the class(es) referred to, the Java virtual machine invokes the loadClass method of the class loader that originally created the class.<br>, . </p>\n<p>For example, an application could create a network class loader to download class files from a server. Sample code might look like:</p>\n<p>   ClassLoader loader = new NetworkClassLoader(host, port);<br>   Object main = loader.loadClass(Main, true).newInstance();<br>        . . .</p>\n<p>The network class loader subclass must define the methods findClass and loadClassData to load a class from the network. Once it has downloaded the bytes that make up the class, it should use the method defineClass to create a class instance. A sample implementation is:</p>\n<pre><code> class NetworkClassLoader extends ClassLoader &#123;\n     String host;\n     int port;\n\n     public Class findClass(String name) &#123;\n         byte[] b = loadClassData(name);\n         return defineClass(name, b, 0, b.length);\n     &#125;\n\n     private byte[] loadClassData(String name) &#123;\n         // load the class data from the connection\n          . . .\n     &#125;\n &#125;\n</code></pre>\n"},{"title":"","date":"2021-07-03T12:01:57.000Z","_content":"\n# \n{% blockquote Bruce Eckel, On Java 8 %}\nFactories: Encapsulating Object Creation\n\nA Factory forces object creation to occur through a common point, preventing creational code from appearing throught your system.\n{% endblockquote %}\n. , .\n\n, , new.\n, , , , `xxx.getNewInstance()`, :\n```java\nclass Shape {\n  @Override\n  public String toString() {\n    return getClass().getSimpleName();\n  }\n}\n\ninterface ShapeFactory {\n  Shape create(String type);\n}\n\nclass Circle extends Shape {\n  public Circle() {}\n}\n\nclass Square extends Shape {}\n\nclass Triangle extends Shape {}\n\npublic class DynamicFactory implements ShapeFactory {\n\n  @Override\n  public Shape create(String type) {\n    try {\n      return (Shape)\n          Class.forName(\"package.name.\" + type).getConstructor().newInstance();\n    } catch (Exception e) {\n      System.out.println(e.getLocalizedMessage());\n      return null;\n    }\n  }\n\n  public static void main(String[] args) {\n    Shape s = new DynamicFactory().create(\"Circle\");\n    System.out.println(s.toString());\n  }\n}\n```\n\n# \n, \n```java\nclass AbstractFactory {\n    Supplier<Player> player;\n    Supplier<Obstacle> obstacle;\n}\n\nclass ConcreteFactory1 extends AbstractFactory {\n    ConcreteFactory() {\n        player = Player1::new;\n        obstacle = Obstacle1::new;\n    }\n}\npublic class GameEnvironment {\n  private Player p;\n  private Obstacle ob;\n  public getInstance(AbstractFactory factory) {\n        p = factory.player.get();\n        ob = factory.obstacle.get();\n    }\n}\n\n```\n","source":"_posts/java-factory-pattern.md","raw":"---\ntitle: \ndate: 2021-07-03 20:01:57\ncategories:\n- Java\n- Pattern\ntags:\n- factory pattern\n---\n\n# \n{% blockquote Bruce Eckel, On Java 8 %}\nFactories: Encapsulating Object Creation\n\nA Factory forces object creation to occur through a common point, preventing creational code from appearing throught your system.\n{% endblockquote %}\n. , .\n\n, , new.\n, , , , `xxx.getNewInstance()`, :\n```java\nclass Shape {\n  @Override\n  public String toString() {\n    return getClass().getSimpleName();\n  }\n}\n\ninterface ShapeFactory {\n  Shape create(String type);\n}\n\nclass Circle extends Shape {\n  public Circle() {}\n}\n\nclass Square extends Shape {}\n\nclass Triangle extends Shape {}\n\npublic class DynamicFactory implements ShapeFactory {\n\n  @Override\n  public Shape create(String type) {\n    try {\n      return (Shape)\n          Class.forName(\"package.name.\" + type).getConstructor().newInstance();\n    } catch (Exception e) {\n      System.out.println(e.getLocalizedMessage());\n      return null;\n    }\n  }\n\n  public static void main(String[] args) {\n    Shape s = new DynamicFactory().create(\"Circle\");\n    System.out.println(s.toString());\n  }\n}\n```\n\n# \n, \n```java\nclass AbstractFactory {\n    Supplier<Player> player;\n    Supplier<Obstacle> obstacle;\n}\n\nclass ConcreteFactory1 extends AbstractFactory {\n    ConcreteFactory() {\n        player = Player1::new;\n        obstacle = Obstacle1::new;\n    }\n}\npublic class GameEnvironment {\n  private Player p;\n  private Obstacle ob;\n  public getInstance(AbstractFactory factory) {\n        p = factory.player.get();\n        ob = factory.obstacle.get();\n    }\n}\n\n```\n","slug":"java-factory-pattern","published":1,"updated":"2021-12-30T03:01:28.015Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpyh000exotg922w7a6o","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><blockquote><p>Factories: Encapsulating Object Creation</p>\n<p>A Factory forces object creation to occur through a common point, preventing creational code from appearing throught your system.</p>\n<footer><strong>Bruce Eckel</strong><cite>On Java 8</cite></footer></blockquote>\n<p>. , .</p>\n<p>, , new.<br>, , , , <code>xxx.getNewInstance()</code>, :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Shape</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"meta\">@Override</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">toString</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> getClass().getSimpleName();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">ShapeFactory</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">Shape <span class=\"title\">create</span><span class=\"params\">(String type)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Circle</span> <span class=\"keyword\">extends</span> <span class=\"title\">Shape</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Circle</span><span class=\"params\">()</span> </span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Square</span> <span class=\"keyword\">extends</span> <span class=\"title\">Shape</span> </span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Triangle</span> <span class=\"keyword\">extends</span> <span class=\"title\">Shape</span> </span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DynamicFactory</span> <span class=\"keyword\">implements</span> <span class=\"title\">ShapeFactory</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"meta\">@Override</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> Shape <span class=\"title\">create</span><span class=\"params\">(String type)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> (Shape)</span><br><span class=\"line\">          Class.forName(<span class=\"string\">&quot;package.name.&quot;</span> + type).getConstructor().newInstance();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">      System.out.println(e.getLocalizedMessage());</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    Shape s = <span class=\"keyword\">new</span> DynamicFactory().create(<span class=\"string\">&quot;Circle&quot;</span>);</span><br><span class=\"line\">    System.out.println(s.toString());</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>, </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AbstractFactory</span> </span>&#123;</span><br><span class=\"line\">    Supplier&lt;Player&gt; player;</span><br><span class=\"line\">    Supplier&lt;Obstacle&gt; obstacle;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ConcreteFactory1</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractFactory</span> </span>&#123;</span><br><span class=\"line\">    ConcreteFactory() &#123;</span><br><span class=\"line\">        player = Player1::<span class=\"keyword\">new</span>;</span><br><span class=\"line\">        obstacle = Obstacle1::<span class=\"keyword\">new</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">GameEnvironment</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> Player p;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> Obstacle ob;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">getInstance</span><span class=\"params\">(AbstractFactory factory)</span> </span>&#123;</span><br><span class=\"line\">        p = factory.player.get();</span><br><span class=\"line\">        ob = factory.obstacle.get();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><blockquote><p>Factories: Encapsulating Object Creation</p>\n<p>A Factory forces object creation to occur through a common point, preventing creational code from appearing throught your system.</p>\n<footer><strong>Bruce Eckel</strong><cite>On Java 8</cite></footer></blockquote>\n<p>. , .</p>\n<p>, , new.<br>, , , , <code>xxx.getNewInstance()</code>, :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Shape</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"meta\">@Override</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">toString</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> getClass().getSimpleName();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">ShapeFactory</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">Shape <span class=\"title\">create</span><span class=\"params\">(String type)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Circle</span> <span class=\"keyword\">extends</span> <span class=\"title\">Shape</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Circle</span><span class=\"params\">()</span> </span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Square</span> <span class=\"keyword\">extends</span> <span class=\"title\">Shape</span> </span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Triangle</span> <span class=\"keyword\">extends</span> <span class=\"title\">Shape</span> </span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DynamicFactory</span> <span class=\"keyword\">implements</span> <span class=\"title\">ShapeFactory</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"meta\">@Override</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> Shape <span class=\"title\">create</span><span class=\"params\">(String type)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> (Shape)</span><br><span class=\"line\">          Class.forName(<span class=\"string\">&quot;package.name.&quot;</span> + type).getConstructor().newInstance();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">      System.out.println(e.getLocalizedMessage());</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    Shape s = <span class=\"keyword\">new</span> DynamicFactory().create(<span class=\"string\">&quot;Circle&quot;</span>);</span><br><span class=\"line\">    System.out.println(s.toString());</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>, </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AbstractFactory</span> </span>&#123;</span><br><span class=\"line\">    Supplier&lt;Player&gt; player;</span><br><span class=\"line\">    Supplier&lt;Obstacle&gt; obstacle;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ConcreteFactory1</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractFactory</span> </span>&#123;</span><br><span class=\"line\">    ConcreteFactory() &#123;</span><br><span class=\"line\">        player = Player1::<span class=\"keyword\">new</span>;</span><br><span class=\"line\">        obstacle = Obstacle1::<span class=\"keyword\">new</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">GameEnvironment</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> Player p;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> Obstacle ob;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">getInstance</span><span class=\"params\">(AbstractFactory factory)</span> </span>&#123;</span><br><span class=\"line\">        p = factory.player.get();</span><br><span class=\"line\">        ob = factory.obstacle.get();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n"},{"title":"Java","date":"2021-08-04T03:10:25.000Z","_content":"(Imperative)(Declarative), , . \n.\n\n# Lambda\n, Lambda, , \nJVM, everything is a class, , **Lambda**\n```java\ninterface IntCall {\n\tint call(int arg);\n}\n\nclass IntCallImpl implements IntCall {\n\n\t@Override\n\tpublic int call(int arg) {\n\t\tif (arg == 0) {\n\t\t\treturn 1;\n\t\t} else {\n\t\t\treturn arg * call(arg - 1);\n\t\t}\n\t}\n}\npublic class FunctionalPrograming {\n\tstatic IntCall fact;\n\n\t/**\n\t * \n\t */\n\tpublic static void oldApproach() {\n\t\tIntCallImpl intCall = new IntCallImpl();\n\t\tfor (int i = 0; i <= 10; i++) {\n\t\t\tSystem.out.println(\"oldApproach --> \" + intCall.call(i));\n\t\t}\n\t}\n\n\t/**\n\t * \n\t */\n\tpublic static void functionalApproach() {\n        // Lambda, , IntCallImpl, .\n\t\tfact = n -> n == 0 ? 1 : n * fact.call(n - 1);\n\t\tfor (int i = 0; i <= 10; i++) {\n\t\t\tSystem.out.println(\"functionalApproach --> \" + fact.call(i));\n\t\t}\n\t}\n\n    public static void anonymousInnerClassApproach() {\n        IntCall fact = IntCallImpl::call\n    }\n\n\tpublic static void main(String[] args) {\n\t\tFunctionalPrograming.oldApproach();\n\t\tFunctionalPrograming.functionalApproach();\n\t}\n}\n```\n\n# Mehtod References\n:\n{% blockquote %}\nA method reference is a class name or an object name, follow by a ::, then the name of the method \n{% endblockquote %}\n\n```java\nclass X {\n   String f() {\n      return \"X::f\";\n   }\n}\n\ninterface MarkString0 {\n   String make();\n}\n\ninterface MarkString1 {\n   String make(X x);\n}\n\npublic class UnboundMethodReferences {\n   public static void main(String[] args) {\n      // MarkString0 n = X::f                             [1]\n      X x = new X();\n      MarkString0 n = x::f;   // method references        [2]\n      System.out.println(n.make());\n\n      \n      MarkString1 m = X::f;   //unbound method references [3]\n      System.out.println(m.make(new X()));\n\n   }\n}\n```\n, Method, . , `[2]`, `[1]`. `[1]`, `class X``interface MarkString0``X`, f()? Unbound Method References\n\n## Unbound Method References\n(), ()X. , :\n```java\nclass This {\n  void two(int i, double d) {}\n  void three(int i, double d, String s) {}\n  void four(int i, double d, String s, char c) {}\n}\ninterface TwoArgs {\n  void call2(This athis, int i, double d);\n}\ninterface ThreeArgs {\n  void call3(This athis, int i, double d, String s);\n}\npublic class MultiUnbound {\n  public static void main(String[] args) {\n    TwoArgs twoargs = This::two;\n    ThreeArgs threeargs = This::three;\n    This athis = new This();\n    twoargs.call2(athis, 11, 3.14);\n    threeargs.call3(athis, 11, 3.14, \"Three\");\n  }\n}\n```\n\n## \n```java\nclass Dog {\n  String name;\n  int age = -1; // For \"unknown\"\n  Dog() { name = \"stray\"; }\n  Dog(String nm) { name = nm; }\n  Dog(String nm, int yrs) { name = nm; age = yrs; }\n}\ninterface MakeNoArgs {\n  Dog make();\n}\ninterface Make1Arg {\n  Dog make(String nm);\n}\ninterface Make2Args {\n  Dog make(String nm, int age);\n}\npublic class CtorReference {\n  public static void main(String[] args) {\n    MakeNoArgs mna = Dog::new; // [1]\n    Make1Arg m1a = Dog::new;   // [2]\n    Make2Args m2a = Dog::new;  // [3]\n    Dog dn = mna.make();\n    Dog d1 = m1a.make(\"Comet\");\n    Dog d2 = m2a.make(\"Ralph\", 4);\n  }\n}\n```\nDog  make()  make() \n\n [1][2]  [3]  Dog :: new :: new\n\n\n# \n. Java, , method referenceLambda. . :\n```java\nx -> x.toString()\n```\nString, x? Lambda. :\n```java\n(x, y) -> x + y\n```\nLambda, . : \n```java\n@FunctionalInterface\ninterface Functional {\n  String goodbye(String arg);\n}\ninterface FunctionalNoAnn {\n  String goodbye(String arg);\n}\n/*\n@FunctionalInterface\ninterface NotFunctional {\n  String goodbye(String arg);\n  String hello(String arg);\n}\n:\nNotFunctional is not a functional interface\nmultiple non-overriding abstract methods\nfound in interface NotFunctional\n*/\npublic class FunctionalAnnotation {\n  public String goodbye(String arg) {\n    return \"Goodbye, \" + arg;\n  }\n  public static void main(String[] args) {\n    FunctionalAnnotation fa =\n      new FunctionalAnnotation();\n    Functional f = fa::goodbye;\n    FunctionalNoAnn fna = fa::goodbye;\n    // Functional fac = fa; // Incompatible\n    Functional fl = a -> \"Goodbye, \" + a;\n    FunctionalNoAnn fnal = a -> \"Goodbye, \" + a;\n  }\n}\n```\n\n, `@FunctionalInterface`, . \n, Lambda. \n\n{% blockquote Bruce Eckel, OnJava8 %}\nLook closely at what happens in the definitions of f and fna. Functional and\nFunctionalNoAnn define interfaces. Yet what is assigned is just the method goodbye.\nFirst, this is only a method and not a class. Second, its not even a method of a class\nthat implements one of those interfaces. This is a bit of magic that was added to Java\n8: if you assign a method reference or a lambda expression to a functional interface\n(and the types fit), Java will adapt your assignment to the target interface. **Under\nthe covers, the compiler wraps your method reference or lambda expression in an\ninstance of a class that implements the target interface.**\n\nA @FunctionalInterface is also called a Single Abstract Method (SAM) type.\n{% endblockquote %}\n\n\nLambda, , `Stream.of(...).map((x, y) -> x + y))`, map. :\n\n```java\n<R> Stream<R> map(Function<? super T, ? extends R> mapper);\n```\n\n, Function:\n```java\npackage java.util.function;\n\nimport java.util.Objects;\n\n/**\n * Represents a function that accepts one argument and produces a result.\n *\n * <p>This is a <a href=\"package-summary.html\">functional interface</a>\n * whose functional method is {@link #apply(Object)}.\n *\n * @param <T> the type of the input to the function  \n * @param <R> the type of the result of the function \n *\n * @since 1.8\n */\n@FunctionalInterface\npublic interface Function<T, R> {\n\n    /**\n     * Applies this function to the given argument.\n     *\n     * @param t the function argument\n     * @return the function result\n     */\n    R apply(T t);\n\n    // ...\n}\n```\nFunction`apply`, Lambda. `<T, R> `.\n\n@FunctionalInterface, :\n\n```java\npackage java.lang;\n\nimport java.lang.annotation.*;\n\n/**\n * An informative annotation type used to indicate that an interface\n * type declaration is intended to be a <i>functional interface</i> as\n * defined by the Java Language Specification.\n *\n * Conceptually, a functional interface has exactly one abstract\n * method.  Since {@linkplain java.lang.reflect.Method#isDefault()\n * default methods} have an implementation, they are not abstract.  If\n * an interface declares an abstract method overriding one of the\n * public methods of {@code java.lang.Object}, that also does\n * <em>not</em> count toward the interface's abstract method count\n * since any implementation of the interface will have an\n * implementation from {@code java.lang.Object} or elsewhere.\n *\n * <p>Note that instances of functional interfaces can be created with\n * lambda expressions, method references, or constructor references.\n *\n * <p>If a type is annotated with this annotation type, compilers are\n * required to generate an error message unless:\n *\n * <ul>\n * <li> The type is an interface type and not an annotation type, enum, or class.\n * <li> The annotated type satisfies the requirements of a functional interface.\n * </ul>\n *\n * <p>However, the compiler will treat any interface meeting the\n * definition of a functional interface as a functional interface\n * regardless of whether or not a {@code FunctionalInterface}\n * annotation is present on the interface declaration.\n *\n * @jls 4.3.2. The Class Object\n * @jls 9.8 Functional Interfaces\n * @jls 9.4.3 Interface Method Body\n * @since 1.8\n */\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\npublic @interface FunctionalInterface {}\n```\n\n`@FunctionalInterface`, .\n\n`java.util.function`, .\n\n\n## \n, Lambda.\n```java\npublic Function<String, String> a() {\n\t\treturn s -> s.toLowerCase();\n\t}\n```\n\n## (Closure)\n, , , . , , , .\n\n```java\nimport java.util.function.IntSupplier;\n\npublic class Closure2 {\n  IntSupplier makeFun(int x) {\n    int i = 0;\n    return () -> x + i;\n  }\n}\n```\nmakeFunIntSupplierix\"close over\", makeFun, xi, , .\n\n, :\n```java\nimport java.util.function.IntSupplier;\n\npublic class Closure3 {\n  IntSupplier makeFun(int x) {\n    int i = 0;\n    // , x++  i++ \n    return () -> x++ + i++;\n  }\n}\n```\n*Variable used in lambda expression should be final or effectively final*\nLambdafinal, final. , final. \n\n, ?\n, Lambda, :\n```java\nimport java.util.function.IntSupplier;\n\npublic class Closure3 {\n  void makeFun(int x) {\n    int i = 0;\n    lambda(x, i);\n  }\n  void lambda(int x, int i) {\n      x++;\n      i++;\n  }\n}\n```\nxilambda, , , . Lambda, Java.\n\n#### \n```java\nimport java.util.function.*;\npublic class Closure1 {\n  int i;\n  IntSupplier makeFun(int x) {\n    // , i, .\n    return () -> x + i++;\n  }\n}\n```\nLambda(members), (local variable), final.\n\n# \nLambdaMethod Reference, , , . , Lambda, .\n\n, \n```java\ninterface TargetInterface {\n  String apply(String str);\n}\nclass Tool {\n  String connect(String data) {\n    return data + \"<--->\" + data;\n  }\n}\npublic class MethodReferencesNature {\n  public static void main(String[] args) {\n    Tool tool = new Tool();\n    TargetInterface t = tool::connect;\n    System.out.println(t.apply(\"you\"));\n  }\n}\n```\n\n, `$Example1`\n```java\n/** :  */\nclass $Example1 implements TargetInterface {\n  private final Tool tool;\n  $Example1(Tool tool) {\n    this.tool = tool;\n  }\n  @Override\n  public String apply(String data) {\n    return tool.connect(data);\n  }\n}\n\n// Method Reference(main)\n$Example1 example1 = new $Example1(new Tool());\nexample1.apply(\"you\");\n```\n\nLambda, . , . , `Tool``$Example1`, LambdaMethod References.\n","source":"_posts/java-functional-programming.md","raw":"---\ntitle: Java\ndate: 2021-08-04 11:10:25\ncategories:\n- Java\n---\n(Imperative)(Declarative), , . \n.\n\n# Lambda\n, Lambda, , \nJVM, everything is a class, , **Lambda**\n```java\ninterface IntCall {\n\tint call(int arg);\n}\n\nclass IntCallImpl implements IntCall {\n\n\t@Override\n\tpublic int call(int arg) {\n\t\tif (arg == 0) {\n\t\t\treturn 1;\n\t\t} else {\n\t\t\treturn arg * call(arg - 1);\n\t\t}\n\t}\n}\npublic class FunctionalPrograming {\n\tstatic IntCall fact;\n\n\t/**\n\t * \n\t */\n\tpublic static void oldApproach() {\n\t\tIntCallImpl intCall = new IntCallImpl();\n\t\tfor (int i = 0; i <= 10; i++) {\n\t\t\tSystem.out.println(\"oldApproach --> \" + intCall.call(i));\n\t\t}\n\t}\n\n\t/**\n\t * \n\t */\n\tpublic static void functionalApproach() {\n        // Lambda, , IntCallImpl, .\n\t\tfact = n -> n == 0 ? 1 : n * fact.call(n - 1);\n\t\tfor (int i = 0; i <= 10; i++) {\n\t\t\tSystem.out.println(\"functionalApproach --> \" + fact.call(i));\n\t\t}\n\t}\n\n    public static void anonymousInnerClassApproach() {\n        IntCall fact = IntCallImpl::call\n    }\n\n\tpublic static void main(String[] args) {\n\t\tFunctionalPrograming.oldApproach();\n\t\tFunctionalPrograming.functionalApproach();\n\t}\n}\n```\n\n# Mehtod References\n:\n{% blockquote %}\nA method reference is a class name or an object name, follow by a ::, then the name of the method \n{% endblockquote %}\n\n```java\nclass X {\n   String f() {\n      return \"X::f\";\n   }\n}\n\ninterface MarkString0 {\n   String make();\n}\n\ninterface MarkString1 {\n   String make(X x);\n}\n\npublic class UnboundMethodReferences {\n   public static void main(String[] args) {\n      // MarkString0 n = X::f                             [1]\n      X x = new X();\n      MarkString0 n = x::f;   // method references        [2]\n      System.out.println(n.make());\n\n      \n      MarkString1 m = X::f;   //unbound method references [3]\n      System.out.println(m.make(new X()));\n\n   }\n}\n```\n, Method, . , `[2]`, `[1]`. `[1]`, `class X``interface MarkString0``X`, f()? Unbound Method References\n\n## Unbound Method References\n(), ()X. , :\n```java\nclass This {\n  void two(int i, double d) {}\n  void three(int i, double d, String s) {}\n  void four(int i, double d, String s, char c) {}\n}\ninterface TwoArgs {\n  void call2(This athis, int i, double d);\n}\ninterface ThreeArgs {\n  void call3(This athis, int i, double d, String s);\n}\npublic class MultiUnbound {\n  public static void main(String[] args) {\n    TwoArgs twoargs = This::two;\n    ThreeArgs threeargs = This::three;\n    This athis = new This();\n    twoargs.call2(athis, 11, 3.14);\n    threeargs.call3(athis, 11, 3.14, \"Three\");\n  }\n}\n```\n\n## \n```java\nclass Dog {\n  String name;\n  int age = -1; // For \"unknown\"\n  Dog() { name = \"stray\"; }\n  Dog(String nm) { name = nm; }\n  Dog(String nm, int yrs) { name = nm; age = yrs; }\n}\ninterface MakeNoArgs {\n  Dog make();\n}\ninterface Make1Arg {\n  Dog make(String nm);\n}\ninterface Make2Args {\n  Dog make(String nm, int age);\n}\npublic class CtorReference {\n  public static void main(String[] args) {\n    MakeNoArgs mna = Dog::new; // [1]\n    Make1Arg m1a = Dog::new;   // [2]\n    Make2Args m2a = Dog::new;  // [3]\n    Dog dn = mna.make();\n    Dog d1 = m1a.make(\"Comet\");\n    Dog d2 = m2a.make(\"Ralph\", 4);\n  }\n}\n```\nDog  make()  make() \n\n [1][2]  [3]  Dog :: new :: new\n\n\n# \n. Java, , method referenceLambda. . :\n```java\nx -> x.toString()\n```\nString, x? Lambda. :\n```java\n(x, y) -> x + y\n```\nLambda, . : \n```java\n@FunctionalInterface\ninterface Functional {\n  String goodbye(String arg);\n}\ninterface FunctionalNoAnn {\n  String goodbye(String arg);\n}\n/*\n@FunctionalInterface\ninterface NotFunctional {\n  String goodbye(String arg);\n  String hello(String arg);\n}\n:\nNotFunctional is not a functional interface\nmultiple non-overriding abstract methods\nfound in interface NotFunctional\n*/\npublic class FunctionalAnnotation {\n  public String goodbye(String arg) {\n    return \"Goodbye, \" + arg;\n  }\n  public static void main(String[] args) {\n    FunctionalAnnotation fa =\n      new FunctionalAnnotation();\n    Functional f = fa::goodbye;\n    FunctionalNoAnn fna = fa::goodbye;\n    // Functional fac = fa; // Incompatible\n    Functional fl = a -> \"Goodbye, \" + a;\n    FunctionalNoAnn fnal = a -> \"Goodbye, \" + a;\n  }\n}\n```\n\n, `@FunctionalInterface`, . \n, Lambda. \n\n{% blockquote Bruce Eckel, OnJava8 %}\nLook closely at what happens in the definitions of f and fna. Functional and\nFunctionalNoAnn define interfaces. Yet what is assigned is just the method goodbye.\nFirst, this is only a method and not a class. Second, its not even a method of a class\nthat implements one of those interfaces. This is a bit of magic that was added to Java\n8: if you assign a method reference or a lambda expression to a functional interface\n(and the types fit), Java will adapt your assignment to the target interface. **Under\nthe covers, the compiler wraps your method reference or lambda expression in an\ninstance of a class that implements the target interface.**\n\nA @FunctionalInterface is also called a Single Abstract Method (SAM) type.\n{% endblockquote %}\n\n\nLambda, , `Stream.of(...).map((x, y) -> x + y))`, map. :\n\n```java\n<R> Stream<R> map(Function<? super T, ? extends R> mapper);\n```\n\n, Function:\n```java\npackage java.util.function;\n\nimport java.util.Objects;\n\n/**\n * Represents a function that accepts one argument and produces a result.\n *\n * <p>This is a <a href=\"package-summary.html\">functional interface</a>\n * whose functional method is {@link #apply(Object)}.\n *\n * @param <T> the type of the input to the function  \n * @param <R> the type of the result of the function \n *\n * @since 1.8\n */\n@FunctionalInterface\npublic interface Function<T, R> {\n\n    /**\n     * Applies this function to the given argument.\n     *\n     * @param t the function argument\n     * @return the function result\n     */\n    R apply(T t);\n\n    // ...\n}\n```\nFunction`apply`, Lambda. `<T, R> `.\n\n@FunctionalInterface, :\n\n```java\npackage java.lang;\n\nimport java.lang.annotation.*;\n\n/**\n * An informative annotation type used to indicate that an interface\n * type declaration is intended to be a <i>functional interface</i> as\n * defined by the Java Language Specification.\n *\n * Conceptually, a functional interface has exactly one abstract\n * method.  Since {@linkplain java.lang.reflect.Method#isDefault()\n * default methods} have an implementation, they are not abstract.  If\n * an interface declares an abstract method overriding one of the\n * public methods of {@code java.lang.Object}, that also does\n * <em>not</em> count toward the interface's abstract method count\n * since any implementation of the interface will have an\n * implementation from {@code java.lang.Object} or elsewhere.\n *\n * <p>Note that instances of functional interfaces can be created with\n * lambda expressions, method references, or constructor references.\n *\n * <p>If a type is annotated with this annotation type, compilers are\n * required to generate an error message unless:\n *\n * <ul>\n * <li> The type is an interface type and not an annotation type, enum, or class.\n * <li> The annotated type satisfies the requirements of a functional interface.\n * </ul>\n *\n * <p>However, the compiler will treat any interface meeting the\n * definition of a functional interface as a functional interface\n * regardless of whether or not a {@code FunctionalInterface}\n * annotation is present on the interface declaration.\n *\n * @jls 4.3.2. The Class Object\n * @jls 9.8 Functional Interfaces\n * @jls 9.4.3 Interface Method Body\n * @since 1.8\n */\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\npublic @interface FunctionalInterface {}\n```\n\n`@FunctionalInterface`, .\n\n`java.util.function`, .\n\n\n## \n, Lambda.\n```java\npublic Function<String, String> a() {\n\t\treturn s -> s.toLowerCase();\n\t}\n```\n\n## (Closure)\n, , , . , , , .\n\n```java\nimport java.util.function.IntSupplier;\n\npublic class Closure2 {\n  IntSupplier makeFun(int x) {\n    int i = 0;\n    return () -> x + i;\n  }\n}\n```\nmakeFunIntSupplierix\"close over\", makeFun, xi, , .\n\n, :\n```java\nimport java.util.function.IntSupplier;\n\npublic class Closure3 {\n  IntSupplier makeFun(int x) {\n    int i = 0;\n    // , x++  i++ \n    return () -> x++ + i++;\n  }\n}\n```\n*Variable used in lambda expression should be final or effectively final*\nLambdafinal, final. , final. \n\n, ?\n, Lambda, :\n```java\nimport java.util.function.IntSupplier;\n\npublic class Closure3 {\n  void makeFun(int x) {\n    int i = 0;\n    lambda(x, i);\n  }\n  void lambda(int x, int i) {\n      x++;\n      i++;\n  }\n}\n```\nxilambda, , , . Lambda, Java.\n\n#### \n```java\nimport java.util.function.*;\npublic class Closure1 {\n  int i;\n  IntSupplier makeFun(int x) {\n    // , i, .\n    return () -> x + i++;\n  }\n}\n```\nLambda(members), (local variable), final.\n\n# \nLambdaMethod Reference, , , . , Lambda, .\n\n, \n```java\ninterface TargetInterface {\n  String apply(String str);\n}\nclass Tool {\n  String connect(String data) {\n    return data + \"<--->\" + data;\n  }\n}\npublic class MethodReferencesNature {\n  public static void main(String[] args) {\n    Tool tool = new Tool();\n    TargetInterface t = tool::connect;\n    System.out.println(t.apply(\"you\"));\n  }\n}\n```\n\n, `$Example1`\n```java\n/** :  */\nclass $Example1 implements TargetInterface {\n  private final Tool tool;\n  $Example1(Tool tool) {\n    this.tool = tool;\n  }\n  @Override\n  public String apply(String data) {\n    return tool.connect(data);\n  }\n}\n\n// Method Reference(main)\n$Example1 example1 = new $Example1(new Tool());\nexample1.apply(\"you\");\n```\n\nLambda, . , . , `Tool``$Example1`, LambdaMethod References.\n","slug":"java-functional-programming","published":1,"updated":"2021-12-30T03:01:37.188Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpyj000gxotgc1s61qa7","content":"<p>(Imperative)(Declarative), , .<br>.</p>\n<h1 id=\"Lambda\"><a href=\"#Lambda\" class=\"headerlink\" title=\"Lambda\"></a>Lambda</h1><p>, Lambda, , <br>JVM, everything is a class, , <strong>Lambda</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">IntCall</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">call</span><span class=\"params\">(<span class=\"keyword\">int</span> arg)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">IntCallImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">IntCall</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">call</span><span class=\"params\">(<span class=\"keyword\">int</span> arg)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (arg == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> arg * call(arg - <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FunctionalPrograming</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">static</span> IntCall fact;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * </span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">oldApproach</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\tIntCallImpl intCall = <span class=\"keyword\">new</span> IntCallImpl();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt;= <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">&quot;oldApproach --&gt; &quot;</span> + intCall.call(i));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * </span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">functionalApproach</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// Lambda, , IntCallImpl, .</span></span><br><span class=\"line\">\t\tfact = n -&gt; n == <span class=\"number\">0</span> ? <span class=\"number\">1</span> : n * fact.call(n - <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt;= <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">&quot;functionalApproach --&gt; &quot;</span> + fact.call(i));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">anonymousInnerClassApproach</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        IntCall fact = IntCallImpl::call</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">\t\tFunctionalPrograming.oldApproach();</span><br><span class=\"line\">\t\tFunctionalPrograming.functionalApproach();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Mehtod-References\"><a href=\"#Mehtod-References\" class=\"headerlink\" title=\"Mehtod References\"></a>Mehtod References</h1><p>:</p>\n<blockquote><p>A method reference is a class name or an object name, follow by a ::, then the name of the method </p>\n</blockquote>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">X</span> </span>&#123;</span><br><span class=\"line\">   <span class=\"function\">String <span class=\"title\">f</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"string\">&quot;X::f&quot;</span>;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">MarkString0</span> </span>&#123;</span><br><span class=\"line\">   <span class=\"function\">String <span class=\"title\">make</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">MarkString1</span> </span>&#123;</span><br><span class=\"line\">   <span class=\"function\">String <span class=\"title\">make</span><span class=\"params\">(X x)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UnboundMethodReferences</span> </span>&#123;</span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">      <span class=\"comment\">// MarkString0 n = X::f                             [1]</span></span><br><span class=\"line\">      X x = <span class=\"keyword\">new</span> X();</span><br><span class=\"line\">      MarkString0 n = x::f;   <span class=\"comment\">// method references        [2]</span></span><br><span class=\"line\">      System.out.println(n.make());</span><br><span class=\"line\"></span><br><span class=\"line\">      </span><br><span class=\"line\">      MarkString1 m = X::f;   <span class=\"comment\">//unbound method references [3]</span></span><br><span class=\"line\">      System.out.println(m.make(<span class=\"keyword\">new</span> X()));</span><br><span class=\"line\"></span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>, Method, . , <code>[2]</code>, <code>[1]</code>. <code>[1]</code>, <code>class X</code><code>interface MarkString0</code><code>X</code>, f()? Unbound Method References</p>\n<h2 id=\"Unbound-Method-References\"><a href=\"#Unbound-Method-References\" class=\"headerlink\" title=\"Unbound Method References\"></a>Unbound Method References</h2><p>(), ()X. , :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">This</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">two</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">double</span> d)</span> </span>&#123;&#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">three</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">double</span> d, String s)</span> </span>&#123;&#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">four</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">double</span> d, String s, <span class=\"keyword\">char</span> c)</span> </span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">TwoArgs</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">call2</span><span class=\"params\">(This athis, <span class=\"keyword\">int</span> i, <span class=\"keyword\">double</span> d)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">ThreeArgs</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">call3</span><span class=\"params\">(This athis, <span class=\"keyword\">int</span> i, <span class=\"keyword\">double</span> d, String s)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MultiUnbound</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    TwoArgs twoargs = This::two;</span><br><span class=\"line\">    ThreeArgs threeargs = This::three;</span><br><span class=\"line\">    This athis = <span class=\"keyword\">new</span> This();</span><br><span class=\"line\">    twoargs.call2(athis, <span class=\"number\">11</span>, <span class=\"number\">3.14</span>);</span><br><span class=\"line\">    threeargs.call3(athis, <span class=\"number\">11</span>, <span class=\"number\">3.14</span>, <span class=\"string\">&quot;Three&quot;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Dog</span> </span>&#123;</span><br><span class=\"line\">  String name;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> age = -<span class=\"number\">1</span>; <span class=\"comment\">// For &quot;unknown&quot;</span></span><br><span class=\"line\">  Dog() &#123; name = <span class=\"string\">&quot;stray&quot;</span>; &#125;</span><br><span class=\"line\">  Dog(String nm) &#123; name = nm; &#125;</span><br><span class=\"line\">  Dog(String nm, <span class=\"keyword\">int</span> yrs) &#123; name = nm; age = yrs; &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">MakeNoArgs</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">Dog <span class=\"title\">make</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Make1Arg</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">Dog <span class=\"title\">make</span><span class=\"params\">(String nm)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Make2Args</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">Dog <span class=\"title\">make</span><span class=\"params\">(String nm, <span class=\"keyword\">int</span> age)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CtorReference</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    MakeNoArgs mna = Dog::<span class=\"keyword\">new</span>; <span class=\"comment\">// [1]</span></span><br><span class=\"line\">    Make1Arg m1a = Dog::<span class=\"keyword\">new</span>;   <span class=\"comment\">// [2]</span></span><br><span class=\"line\">    Make2Args m2a = Dog::<span class=\"keyword\">new</span>;  <span class=\"comment\">// [3]</span></span><br><span class=\"line\">    Dog dn = mna.make();</span><br><span class=\"line\">    Dog d1 = m1a.make(<span class=\"string\">&quot;Comet&quot;</span>);</span><br><span class=\"line\">    Dog d2 = m2a.make(<span class=\"string\">&quot;Ralph&quot;</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Dog  make()  make() </p>\n<p> [1][2]  [3]  Dog :: new :: new</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>. Java, , method referenceLambda. . :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x -&gt; x.toString()</span><br></pre></td></tr></table></figure>\n<p>String, x? Lambda. :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(x, y) -&gt; x + y</span><br></pre></td></tr></table></figure>\n<p>Lambda, . : </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@FunctionalInterface</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Functional</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">String <span class=\"title\">goodbye</span><span class=\"params\">(String arg)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">FunctionalNoAnn</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">String <span class=\"title\">goodbye</span><span class=\"params\">(String arg)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">@FunctionalInterface</span></span><br><span class=\"line\"><span class=\"comment\">interface NotFunctional &#123;</span></span><br><span class=\"line\"><span class=\"comment\">  String goodbye(String arg);</span></span><br><span class=\"line\"><span class=\"comment\">  String hello(String arg);</span></span><br><span class=\"line\"><span class=\"comment\">&#125;</span></span><br><span class=\"line\"><span class=\"comment\">:</span></span><br><span class=\"line\"><span class=\"comment\">NotFunctional is not a functional interface</span></span><br><span class=\"line\"><span class=\"comment\">multiple non-overriding abstract methods</span></span><br><span class=\"line\"><span class=\"comment\">found in interface NotFunctional</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FunctionalAnnotation</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">goodbye</span><span class=\"params\">(String arg)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">&quot;Goodbye, &quot;</span> + arg;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    FunctionalAnnotation fa =</span><br><span class=\"line\">      <span class=\"keyword\">new</span> FunctionalAnnotation();</span><br><span class=\"line\">    Functional f = fa::goodbye;</span><br><span class=\"line\">    FunctionalNoAnn fna = fa::goodbye;</span><br><span class=\"line\">    <span class=\"comment\">// Functional fac = fa; // Incompatible</span></span><br><span class=\"line\">    Functional fl = a -&gt; <span class=\"string\">&quot;Goodbye, &quot;</span> + a;</span><br><span class=\"line\">    FunctionalNoAnn fnal = a -&gt; <span class=\"string\">&quot;Goodbye, &quot;</span> + a;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>, <code>@FunctionalInterface</code>, .<br>, Lambda. </p>\n<blockquote><p>Look closely at what happens in the definitions of f and fna. Functional and<br>FunctionalNoAnn define interfaces. Yet what is assigned is just the method goodbye.<br>First, this is only a method and not a class. Second, its not even a method of a class<br>that implements one of those interfaces. This is a bit of magic that was added to Java<br>8: if you assign a method reference or a lambda expression to a functional interface<br>(and the types fit), Java will adapt your assignment to the target interface. <strong>Under<br>the covers, the compiler wraps your method reference or lambda expression in an<br>instance of a class that implements the target interface.</strong></p>\n<p>A @FunctionalInterface is also called a Single Abstract Method (SAM) type.</p>\n<footer><strong>Bruce Eckel</strong><cite>OnJava8</cite></footer></blockquote>\n\n\n<p>Lambda, , <code>Stream.of(...).map((x, y) -&gt; x + y))</code>, map. :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;R&gt; <span class=\"function\">Stream&lt;R&gt; <span class=\"title\">map</span><span class=\"params\">(Function&lt;? <span class=\"keyword\">super</span> T, ? extends R&gt; mapper)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>, Function:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> java.util.function;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Objects;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Represents a function that accepts one argument and produces a result.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;This is a &lt;a href=&quot;package-summary.html&quot;&gt;functional interface&lt;/a&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * whose functional method is &#123;<span class=\"doctag\">@link</span> #apply(Object)&#125;.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &lt;T&gt; the type of the input to the function  </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &lt;R&gt; the type of the result of the function </span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 1.8</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@FunctionalInterface</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Function</span>&lt;<span class=\"title\">T</span>, <span class=\"title\">R</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Applies this function to the given argument.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> t the function argument</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> the function result</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\">R <span class=\"title\">apply</span><span class=\"params\">(T t)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Function<code>apply</code>, Lambda. <code>&lt;T, R&gt; </code>.</p>\n<p>@FunctionalInterface, :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> java.lang;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.lang.annotation.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * An informative annotation type used to indicate that an interface</span></span><br><span class=\"line\"><span class=\"comment\"> * type declaration is intended to be a &lt;i&gt;functional interface&lt;/i&gt; as</span></span><br><span class=\"line\"><span class=\"comment\"> * defined by the Java Language Specification.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * Conceptually, a functional interface has exactly one abstract</span></span><br><span class=\"line\"><span class=\"comment\"> * method.  Since &#123;<span class=\"doctag\">@linkplain</span> java.lang.reflect.Method#isDefault()</span></span><br><span class=\"line\"><span class=\"comment\"> * default methods&#125; have an implementation, they are not abstract.  If</span></span><br><span class=\"line\"><span class=\"comment\"> * an interface declares an abstract method overriding one of the</span></span><br><span class=\"line\"><span class=\"comment\"> * public methods of &#123;<span class=\"doctag\">@code</span> java.lang.Object&#125;, that also does</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;em&gt;not&lt;/em&gt; count toward the interface&#x27;s abstract method count</span></span><br><span class=\"line\"><span class=\"comment\"> * since any implementation of the interface will have an</span></span><br><span class=\"line\"><span class=\"comment\"> * implementation from &#123;<span class=\"doctag\">@code</span> java.lang.Object&#125; or elsewhere.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;Note that instances of functional interfaces can be created with</span></span><br><span class=\"line\"><span class=\"comment\"> * lambda expressions, method references, or constructor references.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;If a type is annotated with this annotation type, compilers are</span></span><br><span class=\"line\"><span class=\"comment\"> * required to generate an error message unless:</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;ul&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;li&gt; The type is an interface type and not an annotation type, enum, or class.</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;li&gt; The annotated type satisfies the requirements of a functional interface.</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/ul&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;However, the compiler will treat any interface meeting the</span></span><br><span class=\"line\"><span class=\"comment\"> * definition of a functional interface as a functional interface</span></span><br><span class=\"line\"><span class=\"comment\"> * regardless of whether or not a &#123;<span class=\"doctag\">@code</span> FunctionalInterface&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * annotation is present on the interface declaration.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@jls</span> 4.3.2. The Class Object</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@jls</span> 9.8 Functional Interfaces</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@jls</span> 9.4.3 Interface Method Body</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 1.8</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Target(ElementType.TYPE)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> FunctionalInterface &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@FunctionalInterface</code>, .</p>\n<p><code>java.util.function</code>, .</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>, Lambda.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Function&lt;String, String&gt; <span class=\"title\">a</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> s -&gt; s.toLowerCase();</span><br><span class=\"line\">\t&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-Closure\"><a href=\"#-Closure\" class=\"headerlink\" title=\"(Closure)\"></a>(Closure)</h2><p>, , , . , , , .</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.function.IntSupplier;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Closure2</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">IntSupplier <span class=\"title\">makeFun</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> () -&gt; x + i;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>makeFunIntSupplierixclose over, makeFun, xi, , .</p>\n<p>, :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.function.IntSupplier;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Closure3</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">IntSupplier <span class=\"title\">makeFun</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"comment\">// , x++  i++ </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> () -&gt; x++ + i++;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><em>Variable used in lambda expression should be final or effectively final</em><br>Lambdafinal, final. , final. </p>\n<p>, ?<br>, Lambda, :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.function.IntSupplier;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Closure3</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">makeFun</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i = <span class=\"number\">0</span>;</span><br><span class=\"line\">    lambda(x, i);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">lambda</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">      x++;</span><br><span class=\"line\">      i++;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>xilambda, , , . Lambda, Java.</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.function.*;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Closure1</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> i;</span><br><span class=\"line\">  <span class=\"function\">IntSupplier <span class=\"title\">makeFun</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// , i, .</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> () -&gt; x + i++;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Lambda(members), (local variable), final.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>LambdaMethod Reference, , , . , Lambda, .</p>\n<p>, </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">TargetInterface</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">String <span class=\"title\">apply</span><span class=\"params\">(String str)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Tool</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">String <span class=\"title\">connect</span><span class=\"params\">(String data)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> data + <span class=\"string\">&quot;&lt;---&gt;&quot;</span> + data;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MethodReferencesNature</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    Tool tool = <span class=\"keyword\">new</span> Tool();</span><br><span class=\"line\">    TargetInterface t = tool::connect;</span><br><span class=\"line\">    System.out.println(t.apply(<span class=\"string\">&quot;you&quot;</span>));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>, <code>$Example1</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/** :  */</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> $<span class=\"title\">Example1</span> <span class=\"keyword\">implements</span> <span class=\"title\">TargetInterface</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Tool tool;</span><br><span class=\"line\">  $Example1(Tool tool) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.tool = tool;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"meta\">@Override</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">apply</span><span class=\"params\">(String data)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> tool.connect(data);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Method Reference(main)</span></span><br><span class=\"line\">$Example1 example1 = <span class=\"keyword\">new</span> $Example1(<span class=\"keyword\">new</span> Tool());</span><br><span class=\"line\">example1.apply(<span class=\"string\">&quot;you&quot;</span>);</span><br></pre></td></tr></table></figure>\n\n<p>Lambda, . , . , <code>Tool</code><code>$Example1</code>, LambdaMethod References.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>(Imperative)(Declarative), , .<br>.</p>\n<h1 id=\"Lambda\"><a href=\"#Lambda\" class=\"headerlink\" title=\"Lambda\"></a>Lambda</h1><p>, Lambda, , <br>JVM, everything is a class, , <strong>Lambda</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">IntCall</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">call</span><span class=\"params\">(<span class=\"keyword\">int</span> arg)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">IntCallImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">IntCall</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">call</span><span class=\"params\">(<span class=\"keyword\">int</span> arg)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (arg == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> arg * call(arg - <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FunctionalPrograming</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">static</span> IntCall fact;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * </span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">oldApproach</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\tIntCallImpl intCall = <span class=\"keyword\">new</span> IntCallImpl();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt;= <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">&quot;oldApproach --&gt; &quot;</span> + intCall.call(i));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * </span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">functionalApproach</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// Lambda, , IntCallImpl, .</span></span><br><span class=\"line\">\t\tfact = n -&gt; n == <span class=\"number\">0</span> ? <span class=\"number\">1</span> : n * fact.call(n - <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt;= <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">&quot;functionalApproach --&gt; &quot;</span> + fact.call(i));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">anonymousInnerClassApproach</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        IntCall fact = IntCallImpl::call</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">\t\tFunctionalPrograming.oldApproach();</span><br><span class=\"line\">\t\tFunctionalPrograming.functionalApproach();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Mehtod-References\"><a href=\"#Mehtod-References\" class=\"headerlink\" title=\"Mehtod References\"></a>Mehtod References</h1><p>:</p>\n<blockquote><p>A method reference is a class name or an object name, follow by a ::, then the name of the method </p>\n</blockquote>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">X</span> </span>&#123;</span><br><span class=\"line\">   <span class=\"function\">String <span class=\"title\">f</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"string\">&quot;X::f&quot;</span>;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">MarkString0</span> </span>&#123;</span><br><span class=\"line\">   <span class=\"function\">String <span class=\"title\">make</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">MarkString1</span> </span>&#123;</span><br><span class=\"line\">   <span class=\"function\">String <span class=\"title\">make</span><span class=\"params\">(X x)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UnboundMethodReferences</span> </span>&#123;</span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">      <span class=\"comment\">// MarkString0 n = X::f                             [1]</span></span><br><span class=\"line\">      X x = <span class=\"keyword\">new</span> X();</span><br><span class=\"line\">      MarkString0 n = x::f;   <span class=\"comment\">// method references        [2]</span></span><br><span class=\"line\">      System.out.println(n.make());</span><br><span class=\"line\"></span><br><span class=\"line\">      </span><br><span class=\"line\">      MarkString1 m = X::f;   <span class=\"comment\">//unbound method references [3]</span></span><br><span class=\"line\">      System.out.println(m.make(<span class=\"keyword\">new</span> X()));</span><br><span class=\"line\"></span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>, Method, . , <code>[2]</code>, <code>[1]</code>. <code>[1]</code>, <code>class X</code><code>interface MarkString0</code><code>X</code>, f()? Unbound Method References</p>\n<h2 id=\"Unbound-Method-References\"><a href=\"#Unbound-Method-References\" class=\"headerlink\" title=\"Unbound Method References\"></a>Unbound Method References</h2><p>(), ()X. , :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">This</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">two</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">double</span> d)</span> </span>&#123;&#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">three</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">double</span> d, String s)</span> </span>&#123;&#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">four</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">double</span> d, String s, <span class=\"keyword\">char</span> c)</span> </span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">TwoArgs</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">call2</span><span class=\"params\">(This athis, <span class=\"keyword\">int</span> i, <span class=\"keyword\">double</span> d)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">ThreeArgs</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">call3</span><span class=\"params\">(This athis, <span class=\"keyword\">int</span> i, <span class=\"keyword\">double</span> d, String s)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MultiUnbound</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    TwoArgs twoargs = This::two;</span><br><span class=\"line\">    ThreeArgs threeargs = This::three;</span><br><span class=\"line\">    This athis = <span class=\"keyword\">new</span> This();</span><br><span class=\"line\">    twoargs.call2(athis, <span class=\"number\">11</span>, <span class=\"number\">3.14</span>);</span><br><span class=\"line\">    threeargs.call3(athis, <span class=\"number\">11</span>, <span class=\"number\">3.14</span>, <span class=\"string\">&quot;Three&quot;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Dog</span> </span>&#123;</span><br><span class=\"line\">  String name;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> age = -<span class=\"number\">1</span>; <span class=\"comment\">// For &quot;unknown&quot;</span></span><br><span class=\"line\">  Dog() &#123; name = <span class=\"string\">&quot;stray&quot;</span>; &#125;</span><br><span class=\"line\">  Dog(String nm) &#123; name = nm; &#125;</span><br><span class=\"line\">  Dog(String nm, <span class=\"keyword\">int</span> yrs) &#123; name = nm; age = yrs; &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">MakeNoArgs</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">Dog <span class=\"title\">make</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Make1Arg</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">Dog <span class=\"title\">make</span><span class=\"params\">(String nm)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Make2Args</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">Dog <span class=\"title\">make</span><span class=\"params\">(String nm, <span class=\"keyword\">int</span> age)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CtorReference</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    MakeNoArgs mna = Dog::<span class=\"keyword\">new</span>; <span class=\"comment\">// [1]</span></span><br><span class=\"line\">    Make1Arg m1a = Dog::<span class=\"keyword\">new</span>;   <span class=\"comment\">// [2]</span></span><br><span class=\"line\">    Make2Args m2a = Dog::<span class=\"keyword\">new</span>;  <span class=\"comment\">// [3]</span></span><br><span class=\"line\">    Dog dn = mna.make();</span><br><span class=\"line\">    Dog d1 = m1a.make(<span class=\"string\">&quot;Comet&quot;</span>);</span><br><span class=\"line\">    Dog d2 = m2a.make(<span class=\"string\">&quot;Ralph&quot;</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Dog  make()  make() </p>\n<p> [1][2]  [3]  Dog :: new :: new</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>. Java, , method referenceLambda. . :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x -&gt; x.toString()</span><br></pre></td></tr></table></figure>\n<p>String, x? Lambda. :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(x, y) -&gt; x + y</span><br></pre></td></tr></table></figure>\n<p>Lambda, . : </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@FunctionalInterface</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Functional</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">String <span class=\"title\">goodbye</span><span class=\"params\">(String arg)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">FunctionalNoAnn</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">String <span class=\"title\">goodbye</span><span class=\"params\">(String arg)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">@FunctionalInterface</span></span><br><span class=\"line\"><span class=\"comment\">interface NotFunctional &#123;</span></span><br><span class=\"line\"><span class=\"comment\">  String goodbye(String arg);</span></span><br><span class=\"line\"><span class=\"comment\">  String hello(String arg);</span></span><br><span class=\"line\"><span class=\"comment\">&#125;</span></span><br><span class=\"line\"><span class=\"comment\">:</span></span><br><span class=\"line\"><span class=\"comment\">NotFunctional is not a functional interface</span></span><br><span class=\"line\"><span class=\"comment\">multiple non-overriding abstract methods</span></span><br><span class=\"line\"><span class=\"comment\">found in interface NotFunctional</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FunctionalAnnotation</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">goodbye</span><span class=\"params\">(String arg)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">&quot;Goodbye, &quot;</span> + arg;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    FunctionalAnnotation fa =</span><br><span class=\"line\">      <span class=\"keyword\">new</span> FunctionalAnnotation();</span><br><span class=\"line\">    Functional f = fa::goodbye;</span><br><span class=\"line\">    FunctionalNoAnn fna = fa::goodbye;</span><br><span class=\"line\">    <span class=\"comment\">// Functional fac = fa; // Incompatible</span></span><br><span class=\"line\">    Functional fl = a -&gt; <span class=\"string\">&quot;Goodbye, &quot;</span> + a;</span><br><span class=\"line\">    FunctionalNoAnn fnal = a -&gt; <span class=\"string\">&quot;Goodbye, &quot;</span> + a;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>, <code>@FunctionalInterface</code>, .<br>, Lambda. </p>\n<blockquote><p>Look closely at what happens in the definitions of f and fna. Functional and<br>FunctionalNoAnn define interfaces. Yet what is assigned is just the method goodbye.<br>First, this is only a method and not a class. Second, its not even a method of a class<br>that implements one of those interfaces. This is a bit of magic that was added to Java<br>8: if you assign a method reference or a lambda expression to a functional interface<br>(and the types fit), Java will adapt your assignment to the target interface. <strong>Under<br>the covers, the compiler wraps your method reference or lambda expression in an<br>instance of a class that implements the target interface.</strong></p>\n<p>A @FunctionalInterface is also called a Single Abstract Method (SAM) type.</p>\n<footer><strong>Bruce Eckel</strong><cite>OnJava8</cite></footer></blockquote>\n\n\n<p>Lambda, , <code>Stream.of(...).map((x, y) -&gt; x + y))</code>, map. :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;R&gt; <span class=\"function\">Stream&lt;R&gt; <span class=\"title\">map</span><span class=\"params\">(Function&lt;? <span class=\"keyword\">super</span> T, ? extends R&gt; mapper)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>, Function:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> java.util.function;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Objects;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Represents a function that accepts one argument and produces a result.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;This is a &lt;a href=&quot;package-summary.html&quot;&gt;functional interface&lt;/a&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * whose functional method is &#123;<span class=\"doctag\">@link</span> #apply(Object)&#125;.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &lt;T&gt; the type of the input to the function  </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &lt;R&gt; the type of the result of the function </span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 1.8</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@FunctionalInterface</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Function</span>&lt;<span class=\"title\">T</span>, <span class=\"title\">R</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Applies this function to the given argument.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> t the function argument</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> the function result</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\">R <span class=\"title\">apply</span><span class=\"params\">(T t)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Function<code>apply</code>, Lambda. <code>&lt;T, R&gt; </code>.</p>\n<p>@FunctionalInterface, :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> java.lang;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.lang.annotation.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * An informative annotation type used to indicate that an interface</span></span><br><span class=\"line\"><span class=\"comment\"> * type declaration is intended to be a &lt;i&gt;functional interface&lt;/i&gt; as</span></span><br><span class=\"line\"><span class=\"comment\"> * defined by the Java Language Specification.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * Conceptually, a functional interface has exactly one abstract</span></span><br><span class=\"line\"><span class=\"comment\"> * method.  Since &#123;<span class=\"doctag\">@linkplain</span> java.lang.reflect.Method#isDefault()</span></span><br><span class=\"line\"><span class=\"comment\"> * default methods&#125; have an implementation, they are not abstract.  If</span></span><br><span class=\"line\"><span class=\"comment\"> * an interface declares an abstract method overriding one of the</span></span><br><span class=\"line\"><span class=\"comment\"> * public methods of &#123;<span class=\"doctag\">@code</span> java.lang.Object&#125;, that also does</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;em&gt;not&lt;/em&gt; count toward the interface&#x27;s abstract method count</span></span><br><span class=\"line\"><span class=\"comment\"> * since any implementation of the interface will have an</span></span><br><span class=\"line\"><span class=\"comment\"> * implementation from &#123;<span class=\"doctag\">@code</span> java.lang.Object&#125; or elsewhere.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;Note that instances of functional interfaces can be created with</span></span><br><span class=\"line\"><span class=\"comment\"> * lambda expressions, method references, or constructor references.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;If a type is annotated with this annotation type, compilers are</span></span><br><span class=\"line\"><span class=\"comment\"> * required to generate an error message unless:</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;ul&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;li&gt; The type is an interface type and not an annotation type, enum, or class.</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;li&gt; The annotated type satisfies the requirements of a functional interface.</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/ul&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;However, the compiler will treat any interface meeting the</span></span><br><span class=\"line\"><span class=\"comment\"> * definition of a functional interface as a functional interface</span></span><br><span class=\"line\"><span class=\"comment\"> * regardless of whether or not a &#123;<span class=\"doctag\">@code</span> FunctionalInterface&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * annotation is present on the interface declaration.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@jls</span> 4.3.2. The Class Object</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@jls</span> 9.8 Functional Interfaces</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@jls</span> 9.4.3 Interface Method Body</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 1.8</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Target(ElementType.TYPE)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> FunctionalInterface &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@FunctionalInterface</code>, .</p>\n<p><code>java.util.function</code>, .</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>, Lambda.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Function&lt;String, String&gt; <span class=\"title\">a</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> s -&gt; s.toLowerCase();</span><br><span class=\"line\">\t&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"-Closure\"><a href=\"#-Closure\" class=\"headerlink\" title=\"(Closure)\"></a>(Closure)</h2><p>, , , . , , , .</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.function.IntSupplier;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Closure2</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">IntSupplier <span class=\"title\">makeFun</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> () -&gt; x + i;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>makeFunIntSupplierixclose over, makeFun, xi, , .</p>\n<p>, :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.function.IntSupplier;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Closure3</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">IntSupplier <span class=\"title\">makeFun</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"comment\">// , x++  i++ </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> () -&gt; x++ + i++;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><em>Variable used in lambda expression should be final or effectively final</em><br>Lambdafinal, final. , final. </p>\n<p>, ?<br>, Lambda, :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.function.IntSupplier;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Closure3</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">makeFun</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i = <span class=\"number\">0</span>;</span><br><span class=\"line\">    lambda(x, i);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">lambda</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">      x++;</span><br><span class=\"line\">      i++;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>xilambda, , , . Lambda, Java.</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.function.*;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Closure1</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> i;</span><br><span class=\"line\">  <span class=\"function\">IntSupplier <span class=\"title\">makeFun</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// , i, .</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> () -&gt; x + i++;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Lambda(members), (local variable), final.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>LambdaMethod Reference, , , . , Lambda, .</p>\n<p>, </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">TargetInterface</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">String <span class=\"title\">apply</span><span class=\"params\">(String str)</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Tool</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">String <span class=\"title\">connect</span><span class=\"params\">(String data)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> data + <span class=\"string\">&quot;&lt;---&gt;&quot;</span> + data;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MethodReferencesNature</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">    Tool tool = <span class=\"keyword\">new</span> Tool();</span><br><span class=\"line\">    TargetInterface t = tool::connect;</span><br><span class=\"line\">    System.out.println(t.apply(<span class=\"string\">&quot;you&quot;</span>));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>, <code>$Example1</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/** :  */</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> $<span class=\"title\">Example1</span> <span class=\"keyword\">implements</span> <span class=\"title\">TargetInterface</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Tool tool;</span><br><span class=\"line\">  $Example1(Tool tool) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.tool = tool;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"meta\">@Override</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">apply</span><span class=\"params\">(String data)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> tool.connect(data);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Method Reference(main)</span></span><br><span class=\"line\">$Example1 example1 = <span class=\"keyword\">new</span> $Example1(<span class=\"keyword\">new</span> Tool());</span><br><span class=\"line\">example1.apply(<span class=\"string\">&quot;you&quot;</span>);</span><br></pre></td></tr></table></figure>\n\n<p>Lambda, . , . , <code>Tool</code><code>$Example1</code>, LambdaMethod References.</p>\n"},{"title":"Java","date":"2021-11-04T02:24:37.000Z","_content":"\n## \n{% blockquote %}\nAnonymous classes enable you to make your code more concise. They enable you to declare and instantiate a class at the same time. They are like local classes except that they do not have a name. Use them if you need to use a local class only once.\n{% endblockquote %}\n\n\n:\n```java\ninterface Contents {\n\tint value();\n}\npublic class Parcel {\n\tpublic Contents getContents () {\n\t\treturn new Contents() {\n\t\t\tprivate int i = 11;\n\t\t\t@Override\n\t\t\tpublic int value() {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t};\n\t}\n    public static void main(String[] args) {\n\t\tParcel p = new Parcel();\n\t\tp.getContents().value();\n\t}\n\n// output:\n// 11\n}\n```\n, new(), ()()","source":"_posts/java-inner-class.md","raw":"---\ntitle: Java\ndate: 2021-11-04 10:24:37\ncategories:\n- Java\n---\n\n## \n{% blockquote %}\nAnonymous classes enable you to make your code more concise. They enable you to declare and instantiate a class at the same time. They are like local classes except that they do not have a name. Use them if you need to use a local class only once.\n{% endblockquote %}\n\n\n:\n```java\ninterface Contents {\n\tint value();\n}\npublic class Parcel {\n\tpublic Contents getContents () {\n\t\treturn new Contents() {\n\t\t\tprivate int i = 11;\n\t\t\t@Override\n\t\t\tpublic int value() {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t};\n\t}\n    public static void main(String[] args) {\n\t\tParcel p = new Parcel();\n\t\tp.getContents().value();\n\t}\n\n// output:\n// 11\n}\n```\n, new(), ()()","slug":"java-inner-class","published":1,"updated":"2021-12-30T02:50:21.081Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpym000jxotg96oo7rra","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote><p>Anonymous classes enable you to make your code more concise. They enable you to declare and instantiate a class at the same time. They are like local classes except that they do not have a name. Use them if you need to use a local class only once.</p>\n</blockquote>\n<p></p>\n<p>:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Contents</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">value</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Parcel</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> Contents <span class=\"title\">getContents</span> <span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Contents() &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span> i = <span class=\"number\">11</span>;</span><br><span class=\"line\">\t\t\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">value</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> i;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">\t\tParcel p = <span class=\"keyword\">new</span> Parcel();</span><br><span class=\"line\">\t\tp.getContents().value();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// output:</span></span><br><span class=\"line\"><span class=\"comment\">// 11</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>, new(), ()()</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote><p>Anonymous classes enable you to make your code more concise. They enable you to declare and instantiate a class at the same time. They are like local classes except that they do not have a name. Use them if you need to use a local class only once.</p>\n</blockquote>\n<p></p>\n<p>:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Contents</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">value</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Parcel</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> Contents <span class=\"title\">getContents</span> <span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Contents() &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span> i = <span class=\"number\">11</span>;</span><br><span class=\"line\">\t\t\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">value</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> i;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">\t\tParcel p = <span class=\"keyword\">new</span> Parcel();</span><br><span class=\"line\">\t\tp.getContents().value();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// output:</span></span><br><span class=\"line\"><span class=\"comment\">// 11</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>, new(), ()()</p>\n"},{"title":"Java","date":"2021-08-01T01:23:05.000Z","_content":"\nSpringAOP.\n\n# Static Proxy\n, , . , .\n - ISubject \n - SubjectImpl \n - SubjectProxy \n - Client \n> \n```java\npublic class Client {\n    private ISubject subject;\n    Client(ISubject subject){\n        this.subject = subject;\n    }\n\n    public void doSomething() {\n        String url = ...;\n\t\tsubject.request(url);\n\t}\n    public static void main(String[] args) {\n        Client client = new Client(new SubjectImpl());\n        client.doSomething();\n    }\n}\npublic class SubjectImpl implements ISubject {\n    @Override\n    public String request(url) {\n        return \"OK\" + url;\n    }\n}\n```\n\n> \n```java\npublic class Client {\n    private ISubject subject;\n    Client(ISubject subject){\n        this.subject = subject;\n    }\n\n    public void doSomething() {\n        String url = ...;\n\t\tsubject.request(url);\n\t}\n    public static void main(String[] args) {\n        // \n        ISubject proxy = (ISubject)new SubjectProxy(new SubjectImpl());\n        Client client = new Client(proxy);\n        client.doSomething();\n    }\n\t\n}\npublic class SubjectImpl implements ISubject {\n    @Override\n    public String request(url) {\n        return \"OK\" + url;\n    }\n}\npublic class SubjectProxy implements ISubject {\n    private ISubject subject;\n    SubjectProxy(ISubject subject){\n        this.subject = subject;\n    }\n    @Override\n    public String request(String url){\n        // add pre-process logic if neccessary\n        String res = subject.request(url);\n        // add post process logic if neccessary\n        return \"Proxy:\" + res;\n    }\n}\n```\n\n, , , , . , , TM? SubjectProxy, . , pre-processpost-process. Subject. Python.\n\n, SubjectImpl.request()? ? , , , , ? , , .\n\n# Dynamic Proxy\nrequest, , , . , , . \n, ProxyInvocationHandler.\n\n\"request\":\n```java\npublic class RequestCtrlInvocationHandler implements InvocationHandler {\n    private static final Log logger = LogFactory.getLog(RequestCtrlInvocationHandler.class);\n    private Object target;\n    public RequestCtrlInvocationHandler(Objec target) {\n        this.target = target;\n    }\n    public Objec invoke(Object proxy, Method method, Object[] args) throws Throwable {\n        if(method.getName.equal(\"request\")) {\n            TimeOfDay startTime = new TiemOfDay(0, 0, 0);\n            TimeOfDay endTime = new TiemOfDay(5, 59, 59);\n            TiemOfDay currentTime = new TimeDay();\n            if(currentTime.isAfter(startTime) && currentTime.isBefore(endTime)) {\n                logger.warn(\"Service is not available now.\");\n                return null;\n            }\n            return method.invoke(target, args);\n        }\n        return null;\n    }\n}\n\npublic class Client{\n    public static void main(String[] args) {\n        ISubject subject = (ISubject)Proxy.newProxyInstance(ISubject.class.getClassLoader(), new Class[]{ISubject.class}, new RequestCtrlInvocationHandler(new ISubjectImpl()));\n        // doSomething, \n        String url = ...;\n        subject.request(url);\n    }\n}\n```\n, JVMclass, :\n```Java\npublic class $Proxy0 implements ISubject {\n    InvocationHandler handler;\n    public $Proxy0(InvocationHandler handler) {\n        this.handler = handler;\n    }\n    public void request(String url){\n        handler.invoke(this, ISubject.class.getMethod(\"request\", String.class), new Object[]{url});\n    }\n}\n```\n\n## \n\n```java\npublic class Proxy implements java.io.Serializable {\n\n    /** parameter types of a proxy class constructor */\n    private static final Class<?>[] constructorParams =\n        { InvocationHandler.class };\n    \n    /**\n     * a cache of proxy classes\n     */\n    private static final WeakCache<ClassLoader, Class<?>[], Class<?>>\n        proxyClassCache = new WeakCache<>(new KeyFactory(), new ProxyClassFactory());\n\n    // ...\n    \n    /**\n     * Generate a proxy class.  Must call the checkProxyAccess method\n     * to perform permission checks before calling this.\n     */\n    private static Class<?> getProxyClass0(ClassLoader loader,\n                                           Class<?>... interfaces) {\n        if (interfaces.length > 65535) {\n            throw new IllegalArgumentException(\"interface limit exceeded\");\n        }\n\n        // If the proxy class defined by the given loader implementing\n        // the given interfaces exists, this will simply return the cached copy;\n        // otherwise, it will create the proxy class via the ProxyClassFactory\n        return proxyClassCache.get(loader, interfaces);\n    }\n\n    \n    /**\n     * A factory function that generates, defines and returns the proxy class given\n     * the ClassLoader and array of interfaces.\n     */\n    private static final class ProxyClassFactory\n        implements BiFunction<ClassLoader, Class<?>[], Class<?>>\n    {\n        // prefix for all proxy class names\n        private static final String proxyClassNamePrefix = \"$Proxy\";\n\n        @Override\n        public Class<?> apply(ClassLoader loader, Class<?>[] interfaces) {\n\n            Map<Class<?>, Boolean> interfaceSet = new IdentityHashMap<>(interfaces.length);\n\n            //... \n\n            /*\n             * Choose a name for the proxy class to generate.\n             */\n            long num = nextUniqueNumber.getAndIncrement();\n            String proxyName = proxyPkg + proxyClassNamePrefix + num;\n\n            /*\n             * Generate the specified proxy class.\n             */\n            byte[] proxyClassFile = ProxyGenerator.generateProxyClass(\n                proxyName, interfaces, accessFlags);\n            // ...\n        }\n    }\n    \n    @CallerSensitive\n    public static Object newProxyInstance(ClassLoader loader,\n                                          Class<?>[] interfaces,\n                                          InvocationHandler h)\n        throws IllegalArgumentException\n    {\n        // ...\n\n        final Class<?>[] intfs = interfaces.clone();\n        final SecurityManager sm = System.getSecurityManager();\n        if (sm != null) {\n            checkProxyAccess(Reflection.getCallerClass(), loader, intfs);\n        }\n\n        /*\n         * Look up or generate the designated proxy class.\n         */\n        Class<?> cl = getProxyClass0(loader, intfs);\n\n        /*\n         * Invoke its constructor with the designated invocation handler.\n         */\n        try {\n            if (sm != null) {\n                checkNewProxyPermission(Reflection.getCallerClass(), cl);\n            }\n\n            final Constructor<?> cons = cl.getConstructor(constructorParams);\n            final InvocationHandler ih = h;\n            if (!Modifier.isPublic(cl.getModifiers())) {\n                AccessController.doPrivileged(new PrivilegedAction<Void>() {\n                    public Void run() {\n                        cons.setAccessible(true);\n                        return null;\n                    }\n                });\n            }\n            return cons.newInstance(new Object[]{h});\n        } catch (IllegalAccessException|InstantiationException e) {\n            // ...\n        } catch (InvocationTargetException e) {\n            // ...\n        } catch (NoSuchMethodException e) {\n            // ...\n        }\n    }\n}\n```\n> newProxyInstance\n - `checkProxyAccess``System.getSecurityManager().checkxxxPermission(...)`socket\n - , `getProxyClass0(loader, intfs)``newProxyInstance(...)`, proxyClassCache`ProxyClassFactory``ProxyClassFactory`, `apply(..)``ProxyGenerator.generateProxyClass(proxyName...)`(`ProxyGenerator`)`generateProxyClass``generateClassFile()`class(, `$Proxy0`)Java\n ```Java\npublic class ProxyGenerator {\n    // ...\n    public static byte[] generateProxyClass(final String var0, Class<?>[] var1, int var2) {\n        ProxyGenerator var3 = new ProxyGenerator(var0, var1, var2);\n        final byte[] var4 = var3.generateClassFile();\n        if (saveGeneratedFiles) {\n            // ...\n            // , .class, `saveGeneratedFiles`false\n        }\n        \n        return var4;\n    }\n}\n```\n - `cl.getConstructor({ InvocationHandler.class })`, , `cons.newInstance(new RequestCtrlInvocationHandler(new ISubjectImpl()))`ISubject\n - `ISubject``request``RequestCtrlInvocationHandler`invokemethod.invoke(...)`ISubjectImpl.request`\n\n 1: , , ?\n : , , , . , CGLIB, , , pre-processpost-process\n\n\n\n","source":"_posts/java-proxy-and-dynamic-proxy.md","raw":"---\ntitle: Java\ndate: 2021-08-01 09:23:05\ncategories:\n- Java\n- Pattern\ntags:\n- Proxy\n---\n\nSpringAOP.\n\n# Static Proxy\n, , . , .\n - ISubject \n - SubjectImpl \n - SubjectProxy \n - Client \n> \n```java\npublic class Client {\n    private ISubject subject;\n    Client(ISubject subject){\n        this.subject = subject;\n    }\n\n    public void doSomething() {\n        String url = ...;\n\t\tsubject.request(url);\n\t}\n    public static void main(String[] args) {\n        Client client = new Client(new SubjectImpl());\n        client.doSomething();\n    }\n}\npublic class SubjectImpl implements ISubject {\n    @Override\n    public String request(url) {\n        return \"OK\" + url;\n    }\n}\n```\n\n> \n```java\npublic class Client {\n    private ISubject subject;\n    Client(ISubject subject){\n        this.subject = subject;\n    }\n\n    public void doSomething() {\n        String url = ...;\n\t\tsubject.request(url);\n\t}\n    public static void main(String[] args) {\n        // \n        ISubject proxy = (ISubject)new SubjectProxy(new SubjectImpl());\n        Client client = new Client(proxy);\n        client.doSomething();\n    }\n\t\n}\npublic class SubjectImpl implements ISubject {\n    @Override\n    public String request(url) {\n        return \"OK\" + url;\n    }\n}\npublic class SubjectProxy implements ISubject {\n    private ISubject subject;\n    SubjectProxy(ISubject subject){\n        this.subject = subject;\n    }\n    @Override\n    public String request(String url){\n        // add pre-process logic if neccessary\n        String res = subject.request(url);\n        // add post process logic if neccessary\n        return \"Proxy:\" + res;\n    }\n}\n```\n\n, , , , . , , TM? SubjectProxy, . , pre-processpost-process. Subject. Python.\n\n, SubjectImpl.request()? ? , , , , ? , , .\n\n# Dynamic Proxy\nrequest, , , . , , . \n, ProxyInvocationHandler.\n\n\"request\":\n```java\npublic class RequestCtrlInvocationHandler implements InvocationHandler {\n    private static final Log logger = LogFactory.getLog(RequestCtrlInvocationHandler.class);\n    private Object target;\n    public RequestCtrlInvocationHandler(Objec target) {\n        this.target = target;\n    }\n    public Objec invoke(Object proxy, Method method, Object[] args) throws Throwable {\n        if(method.getName.equal(\"request\")) {\n            TimeOfDay startTime = new TiemOfDay(0, 0, 0);\n            TimeOfDay endTime = new TiemOfDay(5, 59, 59);\n            TiemOfDay currentTime = new TimeDay();\n            if(currentTime.isAfter(startTime) && currentTime.isBefore(endTime)) {\n                logger.warn(\"Service is not available now.\");\n                return null;\n            }\n            return method.invoke(target, args);\n        }\n        return null;\n    }\n}\n\npublic class Client{\n    public static void main(String[] args) {\n        ISubject subject = (ISubject)Proxy.newProxyInstance(ISubject.class.getClassLoader(), new Class[]{ISubject.class}, new RequestCtrlInvocationHandler(new ISubjectImpl()));\n        // doSomething, \n        String url = ...;\n        subject.request(url);\n    }\n}\n```\n, JVMclass, :\n```Java\npublic class $Proxy0 implements ISubject {\n    InvocationHandler handler;\n    public $Proxy0(InvocationHandler handler) {\n        this.handler = handler;\n    }\n    public void request(String url){\n        handler.invoke(this, ISubject.class.getMethod(\"request\", String.class), new Object[]{url});\n    }\n}\n```\n\n## \n\n```java\npublic class Proxy implements java.io.Serializable {\n\n    /** parameter types of a proxy class constructor */\n    private static final Class<?>[] constructorParams =\n        { InvocationHandler.class };\n    \n    /**\n     * a cache of proxy classes\n     */\n    private static final WeakCache<ClassLoader, Class<?>[], Class<?>>\n        proxyClassCache = new WeakCache<>(new KeyFactory(), new ProxyClassFactory());\n\n    // ...\n    \n    /**\n     * Generate a proxy class.  Must call the checkProxyAccess method\n     * to perform permission checks before calling this.\n     */\n    private static Class<?> getProxyClass0(ClassLoader loader,\n                                           Class<?>... interfaces) {\n        if (interfaces.length > 65535) {\n            throw new IllegalArgumentException(\"interface limit exceeded\");\n        }\n\n        // If the proxy class defined by the given loader implementing\n        // the given interfaces exists, this will simply return the cached copy;\n        // otherwise, it will create the proxy class via the ProxyClassFactory\n        return proxyClassCache.get(loader, interfaces);\n    }\n\n    \n    /**\n     * A factory function that generates, defines and returns the proxy class given\n     * the ClassLoader and array of interfaces.\n     */\n    private static final class ProxyClassFactory\n        implements BiFunction<ClassLoader, Class<?>[], Class<?>>\n    {\n        // prefix for all proxy class names\n        private static final String proxyClassNamePrefix = \"$Proxy\";\n\n        @Override\n        public Class<?> apply(ClassLoader loader, Class<?>[] interfaces) {\n\n            Map<Class<?>, Boolean> interfaceSet = new IdentityHashMap<>(interfaces.length);\n\n            //... \n\n            /*\n             * Choose a name for the proxy class to generate.\n             */\n            long num = nextUniqueNumber.getAndIncrement();\n            String proxyName = proxyPkg + proxyClassNamePrefix + num;\n\n            /*\n             * Generate the specified proxy class.\n             */\n            byte[] proxyClassFile = ProxyGenerator.generateProxyClass(\n                proxyName, interfaces, accessFlags);\n            // ...\n        }\n    }\n    \n    @CallerSensitive\n    public static Object newProxyInstance(ClassLoader loader,\n                                          Class<?>[] interfaces,\n                                          InvocationHandler h)\n        throws IllegalArgumentException\n    {\n        // ...\n\n        final Class<?>[] intfs = interfaces.clone();\n        final SecurityManager sm = System.getSecurityManager();\n        if (sm != null) {\n            checkProxyAccess(Reflection.getCallerClass(), loader, intfs);\n        }\n\n        /*\n         * Look up or generate the designated proxy class.\n         */\n        Class<?> cl = getProxyClass0(loader, intfs);\n\n        /*\n         * Invoke its constructor with the designated invocation handler.\n         */\n        try {\n            if (sm != null) {\n                checkNewProxyPermission(Reflection.getCallerClass(), cl);\n            }\n\n            final Constructor<?> cons = cl.getConstructor(constructorParams);\n            final InvocationHandler ih = h;\n            if (!Modifier.isPublic(cl.getModifiers())) {\n                AccessController.doPrivileged(new PrivilegedAction<Void>() {\n                    public Void run() {\n                        cons.setAccessible(true);\n                        return null;\n                    }\n                });\n            }\n            return cons.newInstance(new Object[]{h});\n        } catch (IllegalAccessException|InstantiationException e) {\n            // ...\n        } catch (InvocationTargetException e) {\n            // ...\n        } catch (NoSuchMethodException e) {\n            // ...\n        }\n    }\n}\n```\n> newProxyInstance\n - `checkProxyAccess``System.getSecurityManager().checkxxxPermission(...)`socket\n - , `getProxyClass0(loader, intfs)``newProxyInstance(...)`, proxyClassCache`ProxyClassFactory``ProxyClassFactory`, `apply(..)``ProxyGenerator.generateProxyClass(proxyName...)`(`ProxyGenerator`)`generateProxyClass``generateClassFile()`class(, `$Proxy0`)Java\n ```Java\npublic class ProxyGenerator {\n    // ...\n    public static byte[] generateProxyClass(final String var0, Class<?>[] var1, int var2) {\n        ProxyGenerator var3 = new ProxyGenerator(var0, var1, var2);\n        final byte[] var4 = var3.generateClassFile();\n        if (saveGeneratedFiles) {\n            // ...\n            // , .class, `saveGeneratedFiles`false\n        }\n        \n        return var4;\n    }\n}\n```\n - `cl.getConstructor({ InvocationHandler.class })`, , `cons.newInstance(new RequestCtrlInvocationHandler(new ISubjectImpl()))`ISubject\n - `ISubject``request``RequestCtrlInvocationHandler`invokemethod.invoke(...)`ISubjectImpl.request`\n\n 1: , , ?\n : , , , . , CGLIB, , , pre-processpost-process\n\n\n\n","slug":"java-proxy-and-dynamic-proxy","published":1,"updated":"2021-12-30T03:03:23.209Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpyp000kxotg3azoa26w","content":"<p>SpringAOP.</p>\n<h1 id=\"Static-Proxy\"><a href=\"#Static-Proxy\" class=\"headerlink\" title=\"Static Proxy\"></a>Static Proxy</h1><p>, , . , .</p>\n<ul>\n<li>ISubject </li>\n<li>SubjectImpl </li>\n<li>SubjectProxy </li>\n<li>Client <blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Client</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ISubject subject;</span><br><span class=\"line\">    Client(ISubject subject)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.subject = subject;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">doSomething</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        String url = ...;</span><br><span class=\"line\">\t\tsubject.request(url);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        Client client = <span class=\"keyword\">new</span> Client(<span class=\"keyword\">new</span> SubjectImpl());</span><br><span class=\"line\">        client.doSomething();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SubjectImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">ISubject</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">request</span><span class=\"params\">(url)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;OK&quot;</span> + url;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Client</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ISubject subject;</span><br><span class=\"line\">    Client(ISubject subject)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.subject = subject;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">doSomething</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        String url = ...;</span><br><span class=\"line\">\t\tsubject.request(url);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        ISubject proxy = (ISubject)<span class=\"keyword\">new</span> SubjectProxy(<span class=\"keyword\">new</span> SubjectImpl());</span><br><span class=\"line\">        Client client = <span class=\"keyword\">new</span> Client(proxy);</span><br><span class=\"line\">        client.doSomething();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SubjectImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">ISubject</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">request</span><span class=\"params\">(url)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;OK&quot;</span> + url;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SubjectProxy</span> <span class=\"keyword\">implements</span> <span class=\"title\">ISubject</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ISubject subject;</span><br><span class=\"line\">    SubjectProxy(ISubject subject)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.subject = subject;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">request</span><span class=\"params\">(String url)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// add pre-process logic if neccessary</span></span><br><span class=\"line\">        String res = subject.request(url);</span><br><span class=\"line\">        <span class=\"comment\">// add post process logic if neccessary</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;Proxy:&quot;</span> + res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>, , , , . , , TM? SubjectProxy, . , pre-processpost-process. Subject. Python.</p>\n<p>, SubjectImpl.request()? ? , , , , ? , , .</p>\n<h1 id=\"Dynamic-Proxy\"><a href=\"#Dynamic-Proxy\" class=\"headerlink\" title=\"Dynamic Proxy\"></a>Dynamic Proxy</h1><p>request, , , . , , .<br>, ProxyInvocationHandler.</p>\n<p>request:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RequestCtrlInvocationHandler</span> <span class=\"keyword\">implements</span> <span class=\"title\">InvocationHandler</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Log logger = LogFactory.getLog(RequestCtrlInvocationHandler.class);</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Object target;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">RequestCtrlInvocationHandler</span><span class=\"params\">(Objec target)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.target = target;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Objec <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(method.getName.equal(<span class=\"string\">&quot;request&quot;</span>)) &#123;</span><br><span class=\"line\">            TimeOfDay startTime = <span class=\"keyword\">new</span> TiemOfDay(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">            TimeOfDay endTime = <span class=\"keyword\">new</span> TiemOfDay(<span class=\"number\">5</span>, <span class=\"number\">59</span>, <span class=\"number\">59</span>);</span><br><span class=\"line\">            TiemOfDay currentTime = <span class=\"keyword\">new</span> TimeDay();</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(currentTime.isAfter(startTime) &amp;&amp; currentTime.isBefore(endTime)) &#123;</span><br><span class=\"line\">                logger.warn(<span class=\"string\">&quot;Service is not available now.&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> method.invoke(target, args);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Client</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        ISubject subject = (ISubject)Proxy.newProxyInstance(ISubject.class.getClassLoader(), <span class=\"keyword\">new</span> Class[]&#123;ISubject.class&#125;, <span class=\"keyword\">new</span> RequestCtrlInvocationHandler(<span class=\"keyword\">new</span> ISubjectImpl()));</span><br><span class=\"line\">        <span class=\"comment\">// doSomething, </span></span><br><span class=\"line\">        String url = ...;</span><br><span class=\"line\">        subject.request(url);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>, JVMclass, :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> $<span class=\"title\">Proxy0</span> <span class=\"keyword\">implements</span> <span class=\"title\">ISubject</span> </span>&#123;</span><br><span class=\"line\">    InvocationHandler handler;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> $Proxy0(InvocationHandler handler) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.handler = handler;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">request</span><span class=\"params\">(String url)</span></span>&#123;</span><br><span class=\"line\">        handler.invoke(<span class=\"keyword\">this</span>, ISubject.class.getMethod(<span class=\"string\">&quot;request&quot;</span>, String.class), <span class=\"keyword\">new</span> Object[]&#123;url&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Proxy</span> <span class=\"keyword\">implements</span> <span class=\"title\">java</span>.<span class=\"title\">io</span>.<span class=\"title\">Serializable</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** parameter types of a proxy class constructor */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Class&lt;?&gt;[] constructorParams =</span><br><span class=\"line\">        &#123; InvocationHandler.class &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * a cache of proxy classes</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> WeakCache&lt;ClassLoader, Class&lt;?&gt;[], Class&lt;?&gt;&gt;</span><br><span class=\"line\">        proxyClassCache = <span class=\"keyword\">new</span> WeakCache&lt;&gt;(<span class=\"keyword\">new</span> KeyFactory(), <span class=\"keyword\">new</span> ProxyClassFactory());</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Generate a proxy class.  Must call the checkProxyAccess method</span></span><br><span class=\"line\"><span class=\"comment\">     * to perform permission checks before calling this.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Class&lt;?&gt; getProxyClass0(ClassLoader loader,</span><br><span class=\"line\">                                           Class&lt;?&gt;... interfaces) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (interfaces.length &gt; <span class=\"number\">65535</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalArgumentException(<span class=\"string\">&quot;interface limit exceeded&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// If the proxy class defined by the given loader implementing</span></span><br><span class=\"line\">        <span class=\"comment\">// the given interfaces exists, this will simply return the cached copy;</span></span><br><span class=\"line\">        <span class=\"comment\">// otherwise, it will create the proxy class via the ProxyClassFactory</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> proxyClassCache.get(loader, interfaces);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * A factory function that generates, defines and returns the proxy class given</span></span><br><span class=\"line\"><span class=\"comment\">     * the ClassLoader and array of interfaces.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ProxyClassFactory</span></span></span><br><span class=\"line\"><span class=\"class\">        <span class=\"keyword\">implements</span> <span class=\"title\">BiFunction</span>&lt;<span class=\"title\">ClassLoader</span>, <span class=\"title\">Class</span>&lt;?&gt;[], <span class=\"title\">Class</span>&lt;?&gt;&gt;</span></span><br><span class=\"line\"><span class=\"class\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// prefix for all proxy class names</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String proxyClassNamePrefix = <span class=\"string\">&quot;$Proxy&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> Class&lt;?&gt; apply(ClassLoader loader, Class&lt;?&gt;[] interfaces) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            Map&lt;Class&lt;?&gt;, Boolean&gt; interfaceSet = <span class=\"keyword\">new</span> IdentityHashMap&lt;&gt;(interfaces.length);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">//... </span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">             * Choose a name for the proxy class to generate.</span></span><br><span class=\"line\"><span class=\"comment\">             */</span></span><br><span class=\"line\">            <span class=\"keyword\">long</span> num = nextUniqueNumber.getAndIncrement();</span><br><span class=\"line\">            String proxyName = proxyPkg + proxyClassNamePrefix + num;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">             * Generate the specified proxy class.</span></span><br><span class=\"line\"><span class=\"comment\">             */</span></span><br><span class=\"line\">            <span class=\"keyword\">byte</span>[] proxyClassFile = ProxyGenerator.generateProxyClass(</span><br><span class=\"line\">                proxyName, interfaces, accessFlags);</span><br><span class=\"line\">            <span class=\"comment\">// ...</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@CallerSensitive</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Object <span class=\"title\">newProxyInstance</span><span class=\"params\">(ClassLoader loader,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                          Class&lt;?&gt;[] interfaces,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                          InvocationHandler h)</span></span></span><br><span class=\"line\"><span class=\"function\">        <span class=\"keyword\">throws</span> IllegalArgumentException</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// ...</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">final</span> Class&lt;?&gt;[] intfs = interfaces.clone();</span><br><span class=\"line\">        <span class=\"keyword\">final</span> SecurityManager sm = System.getSecurityManager();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (sm != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            checkProxyAccess(Reflection.getCallerClass(), loader, intfs);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * Look up or generate the designated proxy class.</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        Class&lt;?&gt; cl = getProxyClass0(loader, intfs);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * Invoke its constructor with the designated invocation handler.</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (sm != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                checkNewProxyPermission(Reflection.getCallerClass(), cl);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">final</span> Constructor&lt;?&gt; cons = cl.getConstructor(constructorParams);</span><br><span class=\"line\">            <span class=\"keyword\">final</span> InvocationHandler ih = h;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!Modifier.isPublic(cl.getModifiers())) &#123;</span><br><span class=\"line\">                AccessController.doPrivileged(<span class=\"keyword\">new</span> PrivilegedAction&lt;Void&gt;() &#123;</span><br><span class=\"line\">                    <span class=\"function\"><span class=\"keyword\">public</span> Void <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">                        cons.setAccessible(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">                        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> cons.newInstance(<span class=\"keyword\">new</span> Object[]&#123;h&#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IllegalAccessException|InstantiationException e) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// ...</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InvocationTargetException e) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// ...</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (NoSuchMethodException e) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// ...</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>newProxyInstance</p>\n</blockquote>\n<ul>\n<li><code>checkProxyAccess</code><code>System.getSecurityManager().checkxxxPermission(...)</code>socket</li>\n<li>, <code>getProxyClass0(loader, intfs)</code><code>newProxyInstance(...)</code>, proxyClassCache<code>ProxyClassFactory</code><code>ProxyClassFactory</code>, <code>apply(..)</code><code>ProxyGenerator.generateProxyClass(proxyName...)</code>(<code>ProxyGenerator</code>)<code>generateProxyClass</code><code>generateClassFile()</code>class(, <code>$Proxy0</code>)Java<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ProxyGenerator</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">byte</span>[] generateProxyClass(<span class=\"keyword\">final</span> String var0, Class&lt;?&gt;[] var1, <span class=\"keyword\">int</span> var2) &#123;</span><br><span class=\"line\">        ProxyGenerator var3 = <span class=\"keyword\">new</span> ProxyGenerator(var0, var1, var2);</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"keyword\">byte</span>[] var4 = var3.generateClassFile();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (saveGeneratedFiles) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// ...</span></span><br><span class=\"line\">            <span class=\"comment\">// , .class, `saveGeneratedFiles`false</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> var4;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li><code>cl.getConstructor(&#123; InvocationHandler.class &#125;)</code>, , <code>cons.newInstance(new RequestCtrlInvocationHandler(new ISubjectImpl()))</code>ISubject</li>\n<li><code>ISubject</code><code>request</code><code>RequestCtrlInvocationHandler</code>invokemethod.invoke()<code>ISubjectImpl.request</code></li>\n</ul>\n<p> 1: , , ?<br> : , , , . , CGLIB, , , pre-processpost-process</p>\n","site":{"data":{}},"excerpt":"","more":"<p>SpringAOP.</p>\n<h1 id=\"Static-Proxy\"><a href=\"#Static-Proxy\" class=\"headerlink\" title=\"Static Proxy\"></a>Static Proxy</h1><p>, , . , .</p>\n<ul>\n<li>ISubject </li>\n<li>SubjectImpl </li>\n<li>SubjectProxy </li>\n<li>Client <blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Client</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ISubject subject;</span><br><span class=\"line\">    Client(ISubject subject)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.subject = subject;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">doSomething</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        String url = ...;</span><br><span class=\"line\">\t\tsubject.request(url);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        Client client = <span class=\"keyword\">new</span> Client(<span class=\"keyword\">new</span> SubjectImpl());</span><br><span class=\"line\">        client.doSomething();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SubjectImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">ISubject</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">request</span><span class=\"params\">(url)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;OK&quot;</span> + url;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Client</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ISubject subject;</span><br><span class=\"line\">    Client(ISubject subject)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.subject = subject;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">doSomething</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        String url = ...;</span><br><span class=\"line\">\t\tsubject.request(url);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        ISubject proxy = (ISubject)<span class=\"keyword\">new</span> SubjectProxy(<span class=\"keyword\">new</span> SubjectImpl());</span><br><span class=\"line\">        Client client = <span class=\"keyword\">new</span> Client(proxy);</span><br><span class=\"line\">        client.doSomething();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SubjectImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">ISubject</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">request</span><span class=\"params\">(url)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;OK&quot;</span> + url;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SubjectProxy</span> <span class=\"keyword\">implements</span> <span class=\"title\">ISubject</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ISubject subject;</span><br><span class=\"line\">    SubjectProxy(ISubject subject)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.subject = subject;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">request</span><span class=\"params\">(String url)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// add pre-process logic if neccessary</span></span><br><span class=\"line\">        String res = subject.request(url);</span><br><span class=\"line\">        <span class=\"comment\">// add post process logic if neccessary</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;Proxy:&quot;</span> + res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>, , , , . , , TM? SubjectProxy, . , pre-processpost-process. Subject. Python.</p>\n<p>, SubjectImpl.request()? ? , , , , ? , , .</p>\n<h1 id=\"Dynamic-Proxy\"><a href=\"#Dynamic-Proxy\" class=\"headerlink\" title=\"Dynamic Proxy\"></a>Dynamic Proxy</h1><p>request, , , . , , .<br>, ProxyInvocationHandler.</p>\n<p>request:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RequestCtrlInvocationHandler</span> <span class=\"keyword\">implements</span> <span class=\"title\">InvocationHandler</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Log logger = LogFactory.getLog(RequestCtrlInvocationHandler.class);</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Object target;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">RequestCtrlInvocationHandler</span><span class=\"params\">(Objec target)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.target = target;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Objec <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(method.getName.equal(<span class=\"string\">&quot;request&quot;</span>)) &#123;</span><br><span class=\"line\">            TimeOfDay startTime = <span class=\"keyword\">new</span> TiemOfDay(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">            TimeOfDay endTime = <span class=\"keyword\">new</span> TiemOfDay(<span class=\"number\">5</span>, <span class=\"number\">59</span>, <span class=\"number\">59</span>);</span><br><span class=\"line\">            TiemOfDay currentTime = <span class=\"keyword\">new</span> TimeDay();</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(currentTime.isAfter(startTime) &amp;&amp; currentTime.isBefore(endTime)) &#123;</span><br><span class=\"line\">                logger.warn(<span class=\"string\">&quot;Service is not available now.&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> method.invoke(target, args);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Client</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        ISubject subject = (ISubject)Proxy.newProxyInstance(ISubject.class.getClassLoader(), <span class=\"keyword\">new</span> Class[]&#123;ISubject.class&#125;, <span class=\"keyword\">new</span> RequestCtrlInvocationHandler(<span class=\"keyword\">new</span> ISubjectImpl()));</span><br><span class=\"line\">        <span class=\"comment\">// doSomething, </span></span><br><span class=\"line\">        String url = ...;</span><br><span class=\"line\">        subject.request(url);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>, JVMclass, :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> $<span class=\"title\">Proxy0</span> <span class=\"keyword\">implements</span> <span class=\"title\">ISubject</span> </span>&#123;</span><br><span class=\"line\">    InvocationHandler handler;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> $Proxy0(InvocationHandler handler) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.handler = handler;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">request</span><span class=\"params\">(String url)</span></span>&#123;</span><br><span class=\"line\">        handler.invoke(<span class=\"keyword\">this</span>, ISubject.class.getMethod(<span class=\"string\">&quot;request&quot;</span>, String.class), <span class=\"keyword\">new</span> Object[]&#123;url&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Proxy</span> <span class=\"keyword\">implements</span> <span class=\"title\">java</span>.<span class=\"title\">io</span>.<span class=\"title\">Serializable</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** parameter types of a proxy class constructor */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Class&lt;?&gt;[] constructorParams =</span><br><span class=\"line\">        &#123; InvocationHandler.class &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * a cache of proxy classes</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> WeakCache&lt;ClassLoader, Class&lt;?&gt;[], Class&lt;?&gt;&gt;</span><br><span class=\"line\">        proxyClassCache = <span class=\"keyword\">new</span> WeakCache&lt;&gt;(<span class=\"keyword\">new</span> KeyFactory(), <span class=\"keyword\">new</span> ProxyClassFactory());</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Generate a proxy class.  Must call the checkProxyAccess method</span></span><br><span class=\"line\"><span class=\"comment\">     * to perform permission checks before calling this.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Class&lt;?&gt; getProxyClass0(ClassLoader loader,</span><br><span class=\"line\">                                           Class&lt;?&gt;... interfaces) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (interfaces.length &gt; <span class=\"number\">65535</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalArgumentException(<span class=\"string\">&quot;interface limit exceeded&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// If the proxy class defined by the given loader implementing</span></span><br><span class=\"line\">        <span class=\"comment\">// the given interfaces exists, this will simply return the cached copy;</span></span><br><span class=\"line\">        <span class=\"comment\">// otherwise, it will create the proxy class via the ProxyClassFactory</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> proxyClassCache.get(loader, interfaces);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * A factory function that generates, defines and returns the proxy class given</span></span><br><span class=\"line\"><span class=\"comment\">     * the ClassLoader and array of interfaces.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ProxyClassFactory</span></span></span><br><span class=\"line\"><span class=\"class\">        <span class=\"keyword\">implements</span> <span class=\"title\">BiFunction</span>&lt;<span class=\"title\">ClassLoader</span>, <span class=\"title\">Class</span>&lt;?&gt;[], <span class=\"title\">Class</span>&lt;?&gt;&gt;</span></span><br><span class=\"line\"><span class=\"class\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// prefix for all proxy class names</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String proxyClassNamePrefix = <span class=\"string\">&quot;$Proxy&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> Class&lt;?&gt; apply(ClassLoader loader, Class&lt;?&gt;[] interfaces) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            Map&lt;Class&lt;?&gt;, Boolean&gt; interfaceSet = <span class=\"keyword\">new</span> IdentityHashMap&lt;&gt;(interfaces.length);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">//... </span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">             * Choose a name for the proxy class to generate.</span></span><br><span class=\"line\"><span class=\"comment\">             */</span></span><br><span class=\"line\">            <span class=\"keyword\">long</span> num = nextUniqueNumber.getAndIncrement();</span><br><span class=\"line\">            String proxyName = proxyPkg + proxyClassNamePrefix + num;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">             * Generate the specified proxy class.</span></span><br><span class=\"line\"><span class=\"comment\">             */</span></span><br><span class=\"line\">            <span class=\"keyword\">byte</span>[] proxyClassFile = ProxyGenerator.generateProxyClass(</span><br><span class=\"line\">                proxyName, interfaces, accessFlags);</span><br><span class=\"line\">            <span class=\"comment\">// ...</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@CallerSensitive</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Object <span class=\"title\">newProxyInstance</span><span class=\"params\">(ClassLoader loader,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                          Class&lt;?&gt;[] interfaces,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                          InvocationHandler h)</span></span></span><br><span class=\"line\"><span class=\"function\">        <span class=\"keyword\">throws</span> IllegalArgumentException</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// ...</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">final</span> Class&lt;?&gt;[] intfs = interfaces.clone();</span><br><span class=\"line\">        <span class=\"keyword\">final</span> SecurityManager sm = System.getSecurityManager();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (sm != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            checkProxyAccess(Reflection.getCallerClass(), loader, intfs);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * Look up or generate the designated proxy class.</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        Class&lt;?&gt; cl = getProxyClass0(loader, intfs);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * Invoke its constructor with the designated invocation handler.</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (sm != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                checkNewProxyPermission(Reflection.getCallerClass(), cl);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">final</span> Constructor&lt;?&gt; cons = cl.getConstructor(constructorParams);</span><br><span class=\"line\">            <span class=\"keyword\">final</span> InvocationHandler ih = h;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!Modifier.isPublic(cl.getModifiers())) &#123;</span><br><span class=\"line\">                AccessController.doPrivileged(<span class=\"keyword\">new</span> PrivilegedAction&lt;Void&gt;() &#123;</span><br><span class=\"line\">                    <span class=\"function\"><span class=\"keyword\">public</span> Void <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">                        cons.setAccessible(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">                        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> cons.newInstance(<span class=\"keyword\">new</span> Object[]&#123;h&#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IllegalAccessException|InstantiationException e) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// ...</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InvocationTargetException e) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// ...</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (NoSuchMethodException e) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// ...</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>newProxyInstance</p>\n</blockquote>\n<ul>\n<li><code>checkProxyAccess</code><code>System.getSecurityManager().checkxxxPermission(...)</code>socket</li>\n<li>, <code>getProxyClass0(loader, intfs)</code><code>newProxyInstance(...)</code>, proxyClassCache<code>ProxyClassFactory</code><code>ProxyClassFactory</code>, <code>apply(..)</code><code>ProxyGenerator.generateProxyClass(proxyName...)</code>(<code>ProxyGenerator</code>)<code>generateProxyClass</code><code>generateClassFile()</code>class(, <code>$Proxy0</code>)Java<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ProxyGenerator</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">byte</span>[] generateProxyClass(<span class=\"keyword\">final</span> String var0, Class&lt;?&gt;[] var1, <span class=\"keyword\">int</span> var2) &#123;</span><br><span class=\"line\">        ProxyGenerator var3 = <span class=\"keyword\">new</span> ProxyGenerator(var0, var1, var2);</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"keyword\">byte</span>[] var4 = var3.generateClassFile();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (saveGeneratedFiles) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// ...</span></span><br><span class=\"line\">            <span class=\"comment\">// , .class, `saveGeneratedFiles`false</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> var4;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li><code>cl.getConstructor(&#123; InvocationHandler.class &#125;)</code>, , <code>cons.newInstance(new RequestCtrlInvocationHandler(new ISubjectImpl()))</code>ISubject</li>\n<li><code>ISubject</code><code>request</code><code>RequestCtrlInvocationHandler</code>invokemethod.invoke()<code>ISubjectImpl.request</code></li>\n</ul>\n<p> 1: , , ?<br> : , , , . , CGLIB, , , pre-processpost-process</p>\n"},{"title":"java-reflection","date":"2021-08-12T09:46:37.000Z","_content":" (Reflection)  Java  Java \n\n{% blockquote Oracle %}\nReflection enables Java code to discover information about the fields, methods and constructors of loaded classes, and to use reflected fields, methods, and constructors to operate on their underlying counterparts, within security restrictions.\nThe API accommodates applications that need access to either the public members of a target object (based on its runtime class) or the members declared by a given class. It also allows programs to suppress default reflective access control.\n{% endblockquote %}\n\n\n# \nJavamembers\n\n\n1. \n2. \n3. instanceof\n\nJavajava.lang.reflectField, MethodConstructorAccessibleObjectMemberJVMFieldMethodConstructorConstructorMethodinvokeClass.forNameClass.forNamegetClassgetSuperClassgetFieldsgetMethodsgetConstructorsMember\n\nJavaPythonJavaPythonJava\n\n Java  IDE( EclipseIDEA)\n\n Spring XML  Bean\n\n## Class.forName(...)\n, XXX.class.getClass(), \n`Class.forName(...).getContructor()``Member.PUBLIC`, , `Member.PUBLIC`, , \n\n## Method Invoke\n, method.invoke, , : \n```java\n\n    /**\n     * Invokes the underlying method represented by this {@code Method}\n     * object, on the specified object with the specified parameters.\n     * Individual parameters are automatically unwrapped to match\n     * primitive formal parameters, and both primitive and reference\n     * parameters are subject to method invocation conversions as\n     * necessary.\n     *\n     * <p>If the underlying method is static, then the specified {@code obj}\n     * argument is ignored. It may be null.\n     *\n     * <p>If the number of formal parameters required by the underlying method is\n     * 0, the supplied {@code args} array may be of length 0 or null.\n     *\n     * <p>If the underlying method is an instance method, it is invoked\n     * using dynamic method lookup as documented in The Java Language\n     * Specification, Second Edition, section 15.12.4.4; in particular,\n     * overriding based on the runtime type of the target object will occur.\n     *\n     * <p>If the underlying method is static, the class that declared\n     * the method is initialized if it has not already been initialized.\n     *\n     * <p>If the method completes normally, the value it returns is\n     * returned to the caller of invoke; if the value has a primitive\n     * type, it is first appropriately wrapped in an object. However,\n     * if the value has the type of an array of a primitive type, the\n     * elements of the array are <i>not</i> wrapped in objects; in\n     * other words, an array of primitive type is returned.  If the\n     * underlying method return type is void, the invocation returns\n     * null.\n     *\n     * @param obj  the object the underlying method is invoked from\n     * @param args the arguments used for the method call\n     * @return the result of dispatching the method represented by\n     * this object on {@code obj} with parameters\n     * {@code args}\n     *\n     * @exception IllegalAccessException    if this {@code Method} object\n     *              is enforcing Java language access control and the underlying\n     *              method is inaccessible.\n     * @exception IllegalArgumentException  if the method is an\n     *              instance method and the specified object argument\n     *              is not an instance of the class or interface\n     *              declaring the underlying method (or of a subclass\n     *              or implementor thereof); if the number of actual\n     *              and formal parameters differ; if an unwrapping\n     *              conversion for primitive arguments fails; or if,\n     *              after possible unwrapping, a parameter value\n     *              cannot be converted to the corresponding formal\n     *              parameter type by a method invocation conversion.\n     * @exception InvocationTargetException if the underlying method\n     *              throws an exception.\n     * @exception NullPointerException      if the specified object is null\n     *              and the method is an instance method.\n     * @exception ExceptionInInitializerError if the initialization\n     * provoked by this method fails.\n     */\n    @CallerSensitive\n    public Object invoke(Object obj, Object... args)\n        throws IllegalAccessException, IllegalArgumentException,\n           InvocationTargetException\n    {\n        if (!override) {\n            if (!Reflection.quickCheckMemberAccess(clazz, modifiers)) {\n                Class<?> caller = Reflection.getCallerClass();\n                checkAccess(caller, clazz, obj, modifiers);\n            }\n        }\n        MethodAccessor ma = methodAccessor;             // read volatile\n        if (ma == null) {\n            ma = acquireMethodAccessor();\n        }\n        return ma.invoke(obj, args);\n    }\n```\n, methodAccessorinvokemethodAccessor(volatile)Reflection.getCallerClass()nativenativeC/C++\n\nMethodAccessor, NativeMethodAccessorImplinvoke, nativeinvoke0:\n```java\nclass NativeMethodAccessorImpl extends MethodAccessorImpl {\n    private final Method method;\n    private DelegatingMethodAccessorImpl parent;\n    private int numInvocations;\n\n    NativeMethodAccessorImpl(Method var1) {\n        this.method = var1;\n    }\n\n    public Object invoke(Object var1, Object[] var2) throws IllegalArgumentException, InvocationTargetException {\n        if (++this.numInvocations > ReflectionFactory.inflationThreshold() && !ReflectUtil.isVMAnonymousClass(this.method.getDeclaringClass())) {\n            MethodAccessorImpl var3 = (MethodAccessorImpl)(new MethodAccessorGenerator()).generateMethod(this.method.getDeclaringClass(), this.method.getName(), this.method.getParameterTypes(), this.method.getReturnType(), this.method.getExceptionTypes(), this.method.getModifiers());\n            this.parent.setDelegate(var3);\n        }\n\n        return invoke0(this.method, var1, var2);\n    }\n\n    void setParent(DelegatingMethodAccessorImpl var1) {\n        this.parent = var1;\n    }\n\n    private static native Object invoke0(Method var0, Object var1, Object[] var2);\n}\n```\n","source":"_posts/java-reflection.md","raw":"---\ntitle: java-reflection\ndate: 2021-08-12 17:46:37\ncategories:\n- Java\ntags:\n- Reflection\n---\n (Reflection)  Java  Java \n\n{% blockquote Oracle %}\nReflection enables Java code to discover information about the fields, methods and constructors of loaded classes, and to use reflected fields, methods, and constructors to operate on their underlying counterparts, within security restrictions.\nThe API accommodates applications that need access to either the public members of a target object (based on its runtime class) or the members declared by a given class. It also allows programs to suppress default reflective access control.\n{% endblockquote %}\n\n\n# \nJavamembers\n\n\n1. \n2. \n3. instanceof\n\nJavajava.lang.reflectField, MethodConstructorAccessibleObjectMemberJVMFieldMethodConstructorConstructorMethodinvokeClass.forNameClass.forNamegetClassgetSuperClassgetFieldsgetMethodsgetConstructorsMember\n\nJavaPythonJavaPythonJava\n\n Java  IDE( EclipseIDEA)\n\n Spring XML  Bean\n\n## Class.forName(...)\n, XXX.class.getClass(), \n`Class.forName(...).getContructor()``Member.PUBLIC`, , `Member.PUBLIC`, , \n\n## Method Invoke\n, method.invoke, , : \n```java\n\n    /**\n     * Invokes the underlying method represented by this {@code Method}\n     * object, on the specified object with the specified parameters.\n     * Individual parameters are automatically unwrapped to match\n     * primitive formal parameters, and both primitive and reference\n     * parameters are subject to method invocation conversions as\n     * necessary.\n     *\n     * <p>If the underlying method is static, then the specified {@code obj}\n     * argument is ignored. It may be null.\n     *\n     * <p>If the number of formal parameters required by the underlying method is\n     * 0, the supplied {@code args} array may be of length 0 or null.\n     *\n     * <p>If the underlying method is an instance method, it is invoked\n     * using dynamic method lookup as documented in The Java Language\n     * Specification, Second Edition, section 15.12.4.4; in particular,\n     * overriding based on the runtime type of the target object will occur.\n     *\n     * <p>If the underlying method is static, the class that declared\n     * the method is initialized if it has not already been initialized.\n     *\n     * <p>If the method completes normally, the value it returns is\n     * returned to the caller of invoke; if the value has a primitive\n     * type, it is first appropriately wrapped in an object. However,\n     * if the value has the type of an array of a primitive type, the\n     * elements of the array are <i>not</i> wrapped in objects; in\n     * other words, an array of primitive type is returned.  If the\n     * underlying method return type is void, the invocation returns\n     * null.\n     *\n     * @param obj  the object the underlying method is invoked from\n     * @param args the arguments used for the method call\n     * @return the result of dispatching the method represented by\n     * this object on {@code obj} with parameters\n     * {@code args}\n     *\n     * @exception IllegalAccessException    if this {@code Method} object\n     *              is enforcing Java language access control and the underlying\n     *              method is inaccessible.\n     * @exception IllegalArgumentException  if the method is an\n     *              instance method and the specified object argument\n     *              is not an instance of the class or interface\n     *              declaring the underlying method (or of a subclass\n     *              or implementor thereof); if the number of actual\n     *              and formal parameters differ; if an unwrapping\n     *              conversion for primitive arguments fails; or if,\n     *              after possible unwrapping, a parameter value\n     *              cannot be converted to the corresponding formal\n     *              parameter type by a method invocation conversion.\n     * @exception InvocationTargetException if the underlying method\n     *              throws an exception.\n     * @exception NullPointerException      if the specified object is null\n     *              and the method is an instance method.\n     * @exception ExceptionInInitializerError if the initialization\n     * provoked by this method fails.\n     */\n    @CallerSensitive\n    public Object invoke(Object obj, Object... args)\n        throws IllegalAccessException, IllegalArgumentException,\n           InvocationTargetException\n    {\n        if (!override) {\n            if (!Reflection.quickCheckMemberAccess(clazz, modifiers)) {\n                Class<?> caller = Reflection.getCallerClass();\n                checkAccess(caller, clazz, obj, modifiers);\n            }\n        }\n        MethodAccessor ma = methodAccessor;             // read volatile\n        if (ma == null) {\n            ma = acquireMethodAccessor();\n        }\n        return ma.invoke(obj, args);\n    }\n```\n, methodAccessorinvokemethodAccessor(volatile)Reflection.getCallerClass()nativenativeC/C++\n\nMethodAccessor, NativeMethodAccessorImplinvoke, nativeinvoke0:\n```java\nclass NativeMethodAccessorImpl extends MethodAccessorImpl {\n    private final Method method;\n    private DelegatingMethodAccessorImpl parent;\n    private int numInvocations;\n\n    NativeMethodAccessorImpl(Method var1) {\n        this.method = var1;\n    }\n\n    public Object invoke(Object var1, Object[] var2) throws IllegalArgumentException, InvocationTargetException {\n        if (++this.numInvocations > ReflectionFactory.inflationThreshold() && !ReflectUtil.isVMAnonymousClass(this.method.getDeclaringClass())) {\n            MethodAccessorImpl var3 = (MethodAccessorImpl)(new MethodAccessorGenerator()).generateMethod(this.method.getDeclaringClass(), this.method.getName(), this.method.getParameterTypes(), this.method.getReturnType(), this.method.getExceptionTypes(), this.method.getModifiers());\n            this.parent.setDelegate(var3);\n        }\n\n        return invoke0(this.method, var1, var2);\n    }\n\n    void setParent(DelegatingMethodAccessorImpl var1) {\n        this.parent = var1;\n    }\n\n    private static native Object invoke0(Method var0, Object var1, Object[] var2);\n}\n```\n","slug":"java-reflection","published":1,"updated":"2021-12-30T03:03:32.637Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpys000pxotga2iw86jk","content":"<p> (Reflection)  Java  Java </p>\n<blockquote><p>Reflection enables Java code to discover information about the fields, methods and constructors of loaded classes, and to use reflected fields, methods, and constructors to operate on their underlying counterparts, within security restrictions.<br>The API accommodates applications that need access to either the public members of a target object (based on its runtime class) or the members declared by a given class. It also allows programs to suppress default reflective access control.</p>\n<footer><strong>Oracle</strong></footer></blockquote>\n\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Javamembers</p>\n<p></p>\n<ol>\n<li></li>\n<li></li>\n<li>instanceof</li>\n</ol>\n<p>Javajava.lang.reflectField, MethodConstructorAccessibleObjectMemberJVMFieldMethodConstructorConstructorMethodinvokeClass.forNameClass.forNamegetClassgetSuperClassgetFieldsgetMethodsgetConstructorsMember</p>\n<p>JavaPythonJavaPythonJava</p>\n<p> Java  IDE( EclipseIDEA)</p>\n<p> Spring XML  Bean</p>\n<h2 id=\"Class-forName-\"><a href=\"#Class-forName-\" class=\"headerlink\" title=\"Class.forName()\"></a>Class.forName()</h2><p>, XXX.class.getClass(), <br><code>Class.forName(...).getContructor()</code><code>Member.PUBLIC</code>, , <code>Member.PUBLIC</code>, , </p>\n<h2 id=\"Method-Invoke\"><a href=\"#Method-Invoke\" class=\"headerlink\" title=\"Method Invoke\"></a>Method Invoke</h2><p>, method.invoke, , : </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Invokes the underlying method represented by this &#123;<span class=\"doctag\">@code</span> Method&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * object, on the specified object with the specified parameters.</span></span><br><span class=\"line\"><span class=\"comment\"> * Individual parameters are automatically unwrapped to match</span></span><br><span class=\"line\"><span class=\"comment\"> * primitive formal parameters, and both primitive and reference</span></span><br><span class=\"line\"><span class=\"comment\"> * parameters are subject to method invocation conversions as</span></span><br><span class=\"line\"><span class=\"comment\"> * necessary.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;If the underlying method is static, then the specified &#123;<span class=\"doctag\">@code</span> obj&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * argument is ignored. It may be null.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;If the number of formal parameters required by the underlying method is</span></span><br><span class=\"line\"><span class=\"comment\"> * 0, the supplied &#123;<span class=\"doctag\">@code</span> args&#125; array may be of length 0 or null.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;If the underlying method is an instance method, it is invoked</span></span><br><span class=\"line\"><span class=\"comment\"> * using dynamic method lookup as documented in The Java Language</span></span><br><span class=\"line\"><span class=\"comment\"> * Specification, Second Edition, section 15.12.4.4; in particular,</span></span><br><span class=\"line\"><span class=\"comment\"> * overriding based on the runtime type of the target object will occur.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;If the underlying method is static, the class that declared</span></span><br><span class=\"line\"><span class=\"comment\"> * the method is initialized if it has not already been initialized.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;If the method completes normally, the value it returns is</span></span><br><span class=\"line\"><span class=\"comment\"> * returned to the caller of invoke; if the value has a primitive</span></span><br><span class=\"line\"><span class=\"comment\"> * type, it is first appropriately wrapped in an object. However,</span></span><br><span class=\"line\"><span class=\"comment\"> * if the value has the type of an array of a primitive type, the</span></span><br><span class=\"line\"><span class=\"comment\"> * elements of the array are &lt;i&gt;not&lt;/i&gt; wrapped in objects; in</span></span><br><span class=\"line\"><span class=\"comment\"> * other words, an array of primitive type is returned.  If the</span></span><br><span class=\"line\"><span class=\"comment\"> * underlying method return type is void, the invocation returns</span></span><br><span class=\"line\"><span class=\"comment\"> * null.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> obj  the object the underlying method is invoked from</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> args the arguments used for the method call</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> the result of dispatching the method represented by</span></span><br><span class=\"line\"><span class=\"comment\"> * this object on &#123;<span class=\"doctag\">@code</span> obj&#125; with parameters</span></span><br><span class=\"line\"><span class=\"comment\"> * &#123;<span class=\"doctag\">@code</span> args&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@exception</span> IllegalAccessException    if this &#123;<span class=\"doctag\">@code</span> Method&#125; object</span></span><br><span class=\"line\"><span class=\"comment\"> *              is enforcing Java language access control and the underlying</span></span><br><span class=\"line\"><span class=\"comment\"> *              method is inaccessible.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@exception</span> IllegalArgumentException  if the method is an</span></span><br><span class=\"line\"><span class=\"comment\"> *              instance method and the specified object argument</span></span><br><span class=\"line\"><span class=\"comment\"> *              is not an instance of the class or interface</span></span><br><span class=\"line\"><span class=\"comment\"> *              declaring the underlying method (or of a subclass</span></span><br><span class=\"line\"><span class=\"comment\"> *              or implementor thereof); if the number of actual</span></span><br><span class=\"line\"><span class=\"comment\"> *              and formal parameters differ; if an unwrapping</span></span><br><span class=\"line\"><span class=\"comment\"> *              conversion for primitive arguments fails; or if,</span></span><br><span class=\"line\"><span class=\"comment\"> *              after possible unwrapping, a parameter value</span></span><br><span class=\"line\"><span class=\"comment\"> *              cannot be converted to the corresponding formal</span></span><br><span class=\"line\"><span class=\"comment\"> *              parameter type by a method invocation conversion.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@exception</span> InvocationTargetException if the underlying method</span></span><br><span class=\"line\"><span class=\"comment\"> *              throws an exception.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@exception</span> NullPointerException      if the specified object is null</span></span><br><span class=\"line\"><span class=\"comment\"> *              and the method is an instance method.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@exception</span> ExceptionInInitializerError if the initialization</span></span><br><span class=\"line\"><span class=\"comment\"> * provoked by this method fails.</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@CallerSensitive</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object obj, Object... args)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"keyword\">throws</span> IllegalAccessException, IllegalArgumentException,</span></span><br><span class=\"line\"><span class=\"function\">       InvocationTargetException</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!override) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!Reflection.quickCheckMemberAccess(clazz, modifiers)) &#123;</span><br><span class=\"line\">            Class&lt;?&gt; caller = Reflection.getCallerClass();</span><br><span class=\"line\">            checkAccess(caller, clazz, obj, modifiers);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    MethodAccessor ma = methodAccessor;             <span class=\"comment\">// read volatile</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ma == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        ma = acquireMethodAccessor();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ma.invoke(obj, args);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>, methodAccessorinvokemethodAccessor(volatile)Reflection.getCallerClass()nativenativeC/C++</p>\n<p>MethodAccessor, NativeMethodAccessorImplinvoke, nativeinvoke0:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NativeMethodAccessorImpl</span> <span class=\"keyword\">extends</span> <span class=\"title\">MethodAccessorImpl</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Method method;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> DelegatingMethodAccessorImpl parent;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> numInvocations;</span><br><span class=\"line\"></span><br><span class=\"line\">    NativeMethodAccessorImpl(Method var1) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.method = var1;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object var1, Object[] var2)</span> <span class=\"keyword\">throws</span> IllegalArgumentException, InvocationTargetException </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (++<span class=\"keyword\">this</span>.numInvocations &gt; ReflectionFactory.inflationThreshold() &amp;&amp; !ReflectUtil.isVMAnonymousClass(<span class=\"keyword\">this</span>.method.getDeclaringClass())) &#123;</span><br><span class=\"line\">            MethodAccessorImpl var3 = (MethodAccessorImpl)(<span class=\"keyword\">new</span> MethodAccessorGenerator()).generateMethod(<span class=\"keyword\">this</span>.method.getDeclaringClass(), <span class=\"keyword\">this</span>.method.getName(), <span class=\"keyword\">this</span>.method.getParameterTypes(), <span class=\"keyword\">this</span>.method.getReturnType(), <span class=\"keyword\">this</span>.method.getExceptionTypes(), <span class=\"keyword\">this</span>.method.getModifiers());</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.parent.setDelegate(var3);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> invoke0(<span class=\"keyword\">this</span>.method, var1, var2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setParent</span><span class=\"params\">(DelegatingMethodAccessorImpl var1)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.parent = var1;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">native</span> Object <span class=\"title\">invoke0</span><span class=\"params\">(Method var0, Object var1, Object[] var2)</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p> (Reflection)  Java  Java </p>\n<blockquote><p>Reflection enables Java code to discover information about the fields, methods and constructors of loaded classes, and to use reflected fields, methods, and constructors to operate on their underlying counterparts, within security restrictions.<br>The API accommodates applications that need access to either the public members of a target object (based on its runtime class) or the members declared by a given class. It also allows programs to suppress default reflective access control.</p>\n<footer><strong>Oracle</strong></footer></blockquote>\n\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Javamembers</p>\n<p></p>\n<ol>\n<li></li>\n<li></li>\n<li>instanceof</li>\n</ol>\n<p>Javajava.lang.reflectField, MethodConstructorAccessibleObjectMemberJVMFieldMethodConstructorConstructorMethodinvokeClass.forNameClass.forNamegetClassgetSuperClassgetFieldsgetMethodsgetConstructorsMember</p>\n<p>JavaPythonJavaPythonJava</p>\n<p> Java  IDE( EclipseIDEA)</p>\n<p> Spring XML  Bean</p>\n<h2 id=\"Class-forName-\"><a href=\"#Class-forName-\" class=\"headerlink\" title=\"Class.forName()\"></a>Class.forName()</h2><p>, XXX.class.getClass(), <br><code>Class.forName(...).getContructor()</code><code>Member.PUBLIC</code>, , <code>Member.PUBLIC</code>, , </p>\n<h2 id=\"Method-Invoke\"><a href=\"#Method-Invoke\" class=\"headerlink\" title=\"Method Invoke\"></a>Method Invoke</h2><p>, method.invoke, , : </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Invokes the underlying method represented by this &#123;<span class=\"doctag\">@code</span> Method&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * object, on the specified object with the specified parameters.</span></span><br><span class=\"line\"><span class=\"comment\"> * Individual parameters are automatically unwrapped to match</span></span><br><span class=\"line\"><span class=\"comment\"> * primitive formal parameters, and both primitive and reference</span></span><br><span class=\"line\"><span class=\"comment\"> * parameters are subject to method invocation conversions as</span></span><br><span class=\"line\"><span class=\"comment\"> * necessary.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;If the underlying method is static, then the specified &#123;<span class=\"doctag\">@code</span> obj&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * argument is ignored. It may be null.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;If the number of formal parameters required by the underlying method is</span></span><br><span class=\"line\"><span class=\"comment\"> * 0, the supplied &#123;<span class=\"doctag\">@code</span> args&#125; array may be of length 0 or null.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;If the underlying method is an instance method, it is invoked</span></span><br><span class=\"line\"><span class=\"comment\"> * using dynamic method lookup as documented in The Java Language</span></span><br><span class=\"line\"><span class=\"comment\"> * Specification, Second Edition, section 15.12.4.4; in particular,</span></span><br><span class=\"line\"><span class=\"comment\"> * overriding based on the runtime type of the target object will occur.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;If the underlying method is static, the class that declared</span></span><br><span class=\"line\"><span class=\"comment\"> * the method is initialized if it has not already been initialized.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;If the method completes normally, the value it returns is</span></span><br><span class=\"line\"><span class=\"comment\"> * returned to the caller of invoke; if the value has a primitive</span></span><br><span class=\"line\"><span class=\"comment\"> * type, it is first appropriately wrapped in an object. However,</span></span><br><span class=\"line\"><span class=\"comment\"> * if the value has the type of an array of a primitive type, the</span></span><br><span class=\"line\"><span class=\"comment\"> * elements of the array are &lt;i&gt;not&lt;/i&gt; wrapped in objects; in</span></span><br><span class=\"line\"><span class=\"comment\"> * other words, an array of primitive type is returned.  If the</span></span><br><span class=\"line\"><span class=\"comment\"> * underlying method return type is void, the invocation returns</span></span><br><span class=\"line\"><span class=\"comment\"> * null.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> obj  the object the underlying method is invoked from</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> args the arguments used for the method call</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> the result of dispatching the method represented by</span></span><br><span class=\"line\"><span class=\"comment\"> * this object on &#123;<span class=\"doctag\">@code</span> obj&#125; with parameters</span></span><br><span class=\"line\"><span class=\"comment\"> * &#123;<span class=\"doctag\">@code</span> args&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@exception</span> IllegalAccessException    if this &#123;<span class=\"doctag\">@code</span> Method&#125; object</span></span><br><span class=\"line\"><span class=\"comment\"> *              is enforcing Java language access control and the underlying</span></span><br><span class=\"line\"><span class=\"comment\"> *              method is inaccessible.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@exception</span> IllegalArgumentException  if the method is an</span></span><br><span class=\"line\"><span class=\"comment\"> *              instance method and the specified object argument</span></span><br><span class=\"line\"><span class=\"comment\"> *              is not an instance of the class or interface</span></span><br><span class=\"line\"><span class=\"comment\"> *              declaring the underlying method (or of a subclass</span></span><br><span class=\"line\"><span class=\"comment\"> *              or implementor thereof); if the number of actual</span></span><br><span class=\"line\"><span class=\"comment\"> *              and formal parameters differ; if an unwrapping</span></span><br><span class=\"line\"><span class=\"comment\"> *              conversion for primitive arguments fails; or if,</span></span><br><span class=\"line\"><span class=\"comment\"> *              after possible unwrapping, a parameter value</span></span><br><span class=\"line\"><span class=\"comment\"> *              cannot be converted to the corresponding formal</span></span><br><span class=\"line\"><span class=\"comment\"> *              parameter type by a method invocation conversion.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@exception</span> InvocationTargetException if the underlying method</span></span><br><span class=\"line\"><span class=\"comment\"> *              throws an exception.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@exception</span> NullPointerException      if the specified object is null</span></span><br><span class=\"line\"><span class=\"comment\"> *              and the method is an instance method.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@exception</span> ExceptionInInitializerError if the initialization</span></span><br><span class=\"line\"><span class=\"comment\"> * provoked by this method fails.</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@CallerSensitive</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object obj, Object... args)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"keyword\">throws</span> IllegalAccessException, IllegalArgumentException,</span></span><br><span class=\"line\"><span class=\"function\">       InvocationTargetException</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!override) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!Reflection.quickCheckMemberAccess(clazz, modifiers)) &#123;</span><br><span class=\"line\">            Class&lt;?&gt; caller = Reflection.getCallerClass();</span><br><span class=\"line\">            checkAccess(caller, clazz, obj, modifiers);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    MethodAccessor ma = methodAccessor;             <span class=\"comment\">// read volatile</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ma == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        ma = acquireMethodAccessor();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ma.invoke(obj, args);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>, methodAccessorinvokemethodAccessor(volatile)Reflection.getCallerClass()nativenativeC/C++</p>\n<p>MethodAccessor, NativeMethodAccessorImplinvoke, nativeinvoke0:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NativeMethodAccessorImpl</span> <span class=\"keyword\">extends</span> <span class=\"title\">MethodAccessorImpl</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Method method;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> DelegatingMethodAccessorImpl parent;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> numInvocations;</span><br><span class=\"line\"></span><br><span class=\"line\">    NativeMethodAccessorImpl(Method var1) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.method = var1;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object var1, Object[] var2)</span> <span class=\"keyword\">throws</span> IllegalArgumentException, InvocationTargetException </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (++<span class=\"keyword\">this</span>.numInvocations &gt; ReflectionFactory.inflationThreshold() &amp;&amp; !ReflectUtil.isVMAnonymousClass(<span class=\"keyword\">this</span>.method.getDeclaringClass())) &#123;</span><br><span class=\"line\">            MethodAccessorImpl var3 = (MethodAccessorImpl)(<span class=\"keyword\">new</span> MethodAccessorGenerator()).generateMethod(<span class=\"keyword\">this</span>.method.getDeclaringClass(), <span class=\"keyword\">this</span>.method.getName(), <span class=\"keyword\">this</span>.method.getParameterTypes(), <span class=\"keyword\">this</span>.method.getReturnType(), <span class=\"keyword\">this</span>.method.getExceptionTypes(), <span class=\"keyword\">this</span>.method.getModifiers());</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.parent.setDelegate(var3);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> invoke0(<span class=\"keyword\">this</span>.method, var1, var2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setParent</span><span class=\"params\">(DelegatingMethodAccessorImpl var1)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.parent = var1;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">native</span> Object <span class=\"title\">invoke0</span><span class=\"params\">(Method var0, Object var1, Object[] var2)</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"},{"title":"","date":"2021-06-07T10:59:42.000Z","_content":"\nJava8Streams. . , , ,.   \n, default.\n, . \n: creating streams, intermediate operations, terminal operations.\n\n{% blockquote Bruce Eckel, OnJava8 %}\n**Declarative programming** is a style where we state what we want done, rather than\nspecifying how, and its what you see in functional programming. Notice its much\nmore difficult to understand the **imperative programming**.\n{% endblockquote %}\n\n```java\n// Declarative programming\nnew Random(47).ints(5, 20).distinct().limit(7).sorted().forEach(System.out::println);\n```\n\n```java\n// Imperative programming\nRandom rand = new Random(47);\nSortedSet<Integer> rints = new TreeSet<>();\nwhile(rints.size() < 7) {\n    int r = rand.nextInt(20);\n    if(r < 5) continue;\n    rints.add(r);\n}\nSystem.out.println(rints);\n```\n, Streams, .\nJava Stream API.\n\n# Creating Streams\n1. Streams.of(...)Stream\n2. `.stream()`.\n3. `Stream.generate(...)`, generate`Supplier<T>`, `Supplier<T>`get(Lambda, Supplier, ). generate, . `java.lang.OutOfMemoryError: Java heap space`. , limit\n```java\nStream.generate(() -> \"h\").limit(30).collect(Collectors.joining());\n```\n4. `Stream.iterate(...)`, iterateseed, `Function<T>`, , :\n```java\nint x = 1;\n// seedi, y\nStream.iterate(0, (i) -> {int y = i + x; x = i; return y;}).limit(30).forEach(System.out::println);\n```\n5. . , put.\n```java\nStream.Builder<String> builder = Stream.builder();\nString res = builder.build().map(...).collect(Collector.joining(\" \"));\n```\n6. `Arrays.stream()`\n\n# Intermediate Operations\n1. .map(...)\n2. .peek(...), peek()\n3. .skip(...)\n4. .limit(...)\n5. .sorted(Comparator.reverseOrder())\n6. .filter(Predicate)\n7. .distinct()\n8. parallel(), , , . , `forEachOrdered(...)`Terminal Operations\n\n\n# Terminal Operations\n1. .collect(Collector.toList())\n2. .toArray()\n3. .forEach()\n4. .reduce(...), . \n```java\n// Reduce\nimport java.util.Random;\nimport java.util.stream.Stream;\n\nclass IntegerSupplier {\n    // 100()\n\tstatic Stream<Integer> supply() {\n\t\tRandom rand = new Random(15);\n\t\tfinal int BOUND = 100;\n\t\tStream.Builder<Integer> builder = Stream.builder();\n\t\tfor(int i = 0; i < 30; i++) {\n\t\t\tbuilder.add(rand.nextInt(BOUND));\n\t\t}\n\t\treturn builder.build();\n\t}\n}\n\npublic class Reduce {\n\tpublic static void main(String[] args) {\n\t\t// reduce(BinaryOperator), BinaryOperator\n\t\t// fr0, , \n\t\t// reduce, IntegerOptional\n\t\tIntegerSupplier.supply().reduce((fr0, fr1) -> {\n\t\t\tSystem.out.println(fr0 + \"--compare to--\" + fr1);\n\t\t\treturn fr0 < fr1 ? fr0 : fr1;\n\t\t}).ifPresent(System.out::println);\n\t}\n}\n// output:\n/* 41--compare to--72\n * 72--compare to--38\n * 72--compare to--67\n * 72--compare to--85\n * 85--compare to--60\n * 85--compare to--59\n * Optional[85]\n*/\n```\n\n### Optional\n, \"\", Optional, `Optional.empty`\n```java\n// , : Stream<String> s = Stream.empty();\nStream.<String>empty().findFirst()\n// output: Optional.empty\n```\nOptional, Optional`isPresent()`, `orElse`, `orElseGet`, Python3.7Optional, Optional, none.\n\n","source":"_posts/java-streams.md","raw":"---\ntitle: \ndate: 2021-06-07 18:59:42\ncategories:\n- Java\ntags:\n- Stream\n---\n\nJava8Streams. . , , ,.   \n, default.\n, . \n: creating streams, intermediate operations, terminal operations.\n\n{% blockquote Bruce Eckel, OnJava8 %}\n**Declarative programming** is a style where we state what we want done, rather than\nspecifying how, and its what you see in functional programming. Notice its much\nmore difficult to understand the **imperative programming**.\n{% endblockquote %}\n\n```java\n// Declarative programming\nnew Random(47).ints(5, 20).distinct().limit(7).sorted().forEach(System.out::println);\n```\n\n```java\n// Imperative programming\nRandom rand = new Random(47);\nSortedSet<Integer> rints = new TreeSet<>();\nwhile(rints.size() < 7) {\n    int r = rand.nextInt(20);\n    if(r < 5) continue;\n    rints.add(r);\n}\nSystem.out.println(rints);\n```\n, Streams, .\nJava Stream API.\n\n# Creating Streams\n1. Streams.of(...)Stream\n2. `.stream()`.\n3. `Stream.generate(...)`, generate`Supplier<T>`, `Supplier<T>`get(Lambda, Supplier, ). generate, . `java.lang.OutOfMemoryError: Java heap space`. , limit\n```java\nStream.generate(() -> \"h\").limit(30).collect(Collectors.joining());\n```\n4. `Stream.iterate(...)`, iterateseed, `Function<T>`, , :\n```java\nint x = 1;\n// seedi, y\nStream.iterate(0, (i) -> {int y = i + x; x = i; return y;}).limit(30).forEach(System.out::println);\n```\n5. . , put.\n```java\nStream.Builder<String> builder = Stream.builder();\nString res = builder.build().map(...).collect(Collector.joining(\" \"));\n```\n6. `Arrays.stream()`\n\n# Intermediate Operations\n1. .map(...)\n2. .peek(...), peek()\n3. .skip(...)\n4. .limit(...)\n5. .sorted(Comparator.reverseOrder())\n6. .filter(Predicate)\n7. .distinct()\n8. parallel(), , , . , `forEachOrdered(...)`Terminal Operations\n\n\n# Terminal Operations\n1. .collect(Collector.toList())\n2. .toArray()\n3. .forEach()\n4. .reduce(...), . \n```java\n// Reduce\nimport java.util.Random;\nimport java.util.stream.Stream;\n\nclass IntegerSupplier {\n    // 100()\n\tstatic Stream<Integer> supply() {\n\t\tRandom rand = new Random(15);\n\t\tfinal int BOUND = 100;\n\t\tStream.Builder<Integer> builder = Stream.builder();\n\t\tfor(int i = 0; i < 30; i++) {\n\t\t\tbuilder.add(rand.nextInt(BOUND));\n\t\t}\n\t\treturn builder.build();\n\t}\n}\n\npublic class Reduce {\n\tpublic static void main(String[] args) {\n\t\t// reduce(BinaryOperator), BinaryOperator\n\t\t// fr0, , \n\t\t// reduce, IntegerOptional\n\t\tIntegerSupplier.supply().reduce((fr0, fr1) -> {\n\t\t\tSystem.out.println(fr0 + \"--compare to--\" + fr1);\n\t\t\treturn fr0 < fr1 ? fr0 : fr1;\n\t\t}).ifPresent(System.out::println);\n\t}\n}\n// output:\n/* 41--compare to--72\n * 72--compare to--38\n * 72--compare to--67\n * 72--compare to--85\n * 85--compare to--60\n * 85--compare to--59\n * Optional[85]\n*/\n```\n\n### Optional\n, \"\", Optional, `Optional.empty`\n```java\n// , : Stream<String> s = Stream.empty();\nStream.<String>empty().findFirst()\n// output: Optional.empty\n```\nOptional, Optional`isPresent()`, `orElse`, `orElseGet`, Python3.7Optional, Optional, none.\n\n","slug":"java-streams","published":1,"updated":"2021-12-30T03:03:41.445Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpyt000rxotg46dx0vzu","content":"<p>Java8Streams. . , , ,.<br>, default.<br>, .<br>: creating streams, intermediate operations, terminal operations.</p>\n<blockquote><p><strong>Declarative programming</strong> is a style where we state what we want done, rather than<br>specifying how, and its what you see in functional programming. Notice its much<br>more difficult to understand the <strong>imperative programming</strong>.</p>\n<footer><strong>Bruce Eckel</strong><cite>OnJava8</cite></footer></blockquote>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Declarative programming</span></span><br><span class=\"line\"><span class=\"keyword\">new</span> Random(<span class=\"number\">47</span>).ints(<span class=\"number\">5</span>, <span class=\"number\">20</span>).distinct().limit(<span class=\"number\">7</span>).sorted().forEach(System.out::println);</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Imperative programming</span></span><br><span class=\"line\">Random rand = <span class=\"keyword\">new</span> Random(<span class=\"number\">47</span>);</span><br><span class=\"line\">SortedSet&lt;Integer&gt; rints = <span class=\"keyword\">new</span> TreeSet&lt;&gt;();</span><br><span class=\"line\"><span class=\"keyword\">while</span>(rints.size() &lt; <span class=\"number\">7</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> r = rand.nextInt(<span class=\"number\">20</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(r &lt; <span class=\"number\">5</span>) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">    rints.add(r);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">System.out.println(rints);</span><br></pre></td></tr></table></figure>\n<p>, Streams, .<br>Java Stream API.</p>\n<h1 id=\"Creating-Streams\"><a href=\"#Creating-Streams\" class=\"headerlink\" title=\"Creating Streams\"></a>Creating Streams</h1><ol>\n<li>Streams.of()Stream</li>\n<li><code>.stream()</code>.</li>\n<li><code>Stream.generate(...)</code>, generate<code>Supplier&lt;T&gt;</code>, <code>Supplier&lt;T&gt;</code>get(Lambda, Supplier, ). generate, . <code>java.lang.OutOfMemoryError: Java heap space</code>. , limit<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Stream.generate(() -&gt; <span class=\"string\">&quot;h&quot;</span>).limit(<span class=\"number\">30</span>).collect(Collectors.joining());</span><br></pre></td></tr></table></figure></li>\n<li><code>Stream.iterate(...)</code>, iterateseed, <code>Function&lt;T&gt;</code>, , :<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> x = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"comment\">// seedi, y</span></span><br><span class=\"line\">Stream.iterate(<span class=\"number\">0</span>, (i) -&gt; &#123;<span class=\"keyword\">int</span> y = i + x; x = i; <span class=\"keyword\">return</span> y;&#125;).limit(<span class=\"number\">30</span>).forEach(System.out::println);</span><br></pre></td></tr></table></figure></li>\n<li>. , put.<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Stream.Builder&lt;String&gt; builder = Stream.builder();</span><br><span class=\"line\">String res = builder.build().map(...).collect(Collector.joining(<span class=\"string\">&quot; &quot;</span>));</span><br></pre></td></tr></table></figure></li>\n<li><code>Arrays.stream()</code></li>\n</ol>\n<h1 id=\"Intermediate-Operations\"><a href=\"#Intermediate-Operations\" class=\"headerlink\" title=\"Intermediate Operations\"></a>Intermediate Operations</h1><ol>\n<li>.map()</li>\n<li>.peek(), peek()</li>\n<li>.skip()</li>\n<li>.limit()</li>\n<li>.sorted(Comparator.reverseOrder())</li>\n<li>.filter(Predicate)</li>\n<li>.distinct()</li>\n<li>parallel(), , , . , <code>forEachOrdered(...)</code>Terminal Operations</li>\n</ol>\n<h1 id=\"Terminal-Operations\"><a href=\"#Terminal-Operations\" class=\"headerlink\" title=\"Terminal Operations\"></a>Terminal Operations</h1><ol>\n<li>.collect(Collector.toList())</li>\n<li>.toArray()</li>\n<li>.forEach()</li>\n<li>.reduce(), . <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Reduce</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.stream.Stream;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">IntegerSupplier</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 100()</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">static</span> Stream&lt;Integer&gt; <span class=\"title\">supply</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\tRandom rand = <span class=\"keyword\">new</span> Random(<span class=\"number\">15</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">final</span> <span class=\"keyword\">int</span> BOUND = <span class=\"number\">100</span>;</span><br><span class=\"line\">\t\tStream.Builder&lt;Integer&gt; builder = Stream.builder();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">30</span>; i++) &#123;</span><br><span class=\"line\">\t\t\tbuilder.add(rand.nextInt(BOUND));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> builder.build();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Reduce</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// reduce(BinaryOperator), BinaryOperator</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// fr0, , </span></span><br><span class=\"line\">\t\t<span class=\"comment\">// reduce, IntegerOptional</span></span><br><span class=\"line\">\t\tIntegerSupplier.supply().reduce((fr0, fr1) -&gt; &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(fr0 + <span class=\"string\">&quot;--compare to--&quot;</span> + fr1);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> fr0 &lt; fr1 ? fr0 : fr1;</span><br><span class=\"line\">\t\t&#125;).ifPresent(System.out::println);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// output:</span></span><br><span class=\"line\"><span class=\"comment\">/* 41--compare to--72</span></span><br><span class=\"line\"><span class=\"comment\"> * 72--compare to--38</span></span><br><span class=\"line\"><span class=\"comment\"> * 72--compare to--67</span></span><br><span class=\"line\"><span class=\"comment\"> * 72--compare to--85</span></span><br><span class=\"line\"><span class=\"comment\"> * 85--compare to--60</span></span><br><span class=\"line\"><span class=\"comment\"> * 85--compare to--59</span></span><br><span class=\"line\"><span class=\"comment\"> * Optional[85]</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"Optional\"><a href=\"#Optional\" class=\"headerlink\" title=\"Optional\"></a>Optional</h3><p>, , Optional, <code>Optional.empty</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// , : Stream&lt;String&gt; s = Stream.empty();</span></span><br><span class=\"line\">Stream.&lt;String&gt;empty().findFirst()</span><br><span class=\"line\"><span class=\"comment\">// output: Optional.empty</span></span><br></pre></td></tr></table></figure>\n<p>Optional, Optional<code>isPresent()</code>, <code>orElse</code>, <code>orElseGet</code>, Python3.7Optional, Optional, none.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>Java8Streams. . , , ,.<br>, default.<br>, .<br>: creating streams, intermediate operations, terminal operations.</p>\n<blockquote><p><strong>Declarative programming</strong> is a style where we state what we want done, rather than<br>specifying how, and its what you see in functional programming. Notice its much<br>more difficult to understand the <strong>imperative programming</strong>.</p>\n<footer><strong>Bruce Eckel</strong><cite>OnJava8</cite></footer></blockquote>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Declarative programming</span></span><br><span class=\"line\"><span class=\"keyword\">new</span> Random(<span class=\"number\">47</span>).ints(<span class=\"number\">5</span>, <span class=\"number\">20</span>).distinct().limit(<span class=\"number\">7</span>).sorted().forEach(System.out::println);</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Imperative programming</span></span><br><span class=\"line\">Random rand = <span class=\"keyword\">new</span> Random(<span class=\"number\">47</span>);</span><br><span class=\"line\">SortedSet&lt;Integer&gt; rints = <span class=\"keyword\">new</span> TreeSet&lt;&gt;();</span><br><span class=\"line\"><span class=\"keyword\">while</span>(rints.size() &lt; <span class=\"number\">7</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> r = rand.nextInt(<span class=\"number\">20</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(r &lt; <span class=\"number\">5</span>) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">    rints.add(r);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">System.out.println(rints);</span><br></pre></td></tr></table></figure>\n<p>, Streams, .<br>Java Stream API.</p>\n<h1 id=\"Creating-Streams\"><a href=\"#Creating-Streams\" class=\"headerlink\" title=\"Creating Streams\"></a>Creating Streams</h1><ol>\n<li>Streams.of()Stream</li>\n<li><code>.stream()</code>.</li>\n<li><code>Stream.generate(...)</code>, generate<code>Supplier&lt;T&gt;</code>, <code>Supplier&lt;T&gt;</code>get(Lambda, Supplier, ). generate, . <code>java.lang.OutOfMemoryError: Java heap space</code>. , limit<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Stream.generate(() -&gt; <span class=\"string\">&quot;h&quot;</span>).limit(<span class=\"number\">30</span>).collect(Collectors.joining());</span><br></pre></td></tr></table></figure></li>\n<li><code>Stream.iterate(...)</code>, iterateseed, <code>Function&lt;T&gt;</code>, , :<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> x = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"comment\">// seedi, y</span></span><br><span class=\"line\">Stream.iterate(<span class=\"number\">0</span>, (i) -&gt; &#123;<span class=\"keyword\">int</span> y = i + x; x = i; <span class=\"keyword\">return</span> y;&#125;).limit(<span class=\"number\">30</span>).forEach(System.out::println);</span><br></pre></td></tr></table></figure></li>\n<li>. , put.<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Stream.Builder&lt;String&gt; builder = Stream.builder();</span><br><span class=\"line\">String res = builder.build().map(...).collect(Collector.joining(<span class=\"string\">&quot; &quot;</span>));</span><br></pre></td></tr></table></figure></li>\n<li><code>Arrays.stream()</code></li>\n</ol>\n<h1 id=\"Intermediate-Operations\"><a href=\"#Intermediate-Operations\" class=\"headerlink\" title=\"Intermediate Operations\"></a>Intermediate Operations</h1><ol>\n<li>.map()</li>\n<li>.peek(), peek()</li>\n<li>.skip()</li>\n<li>.limit()</li>\n<li>.sorted(Comparator.reverseOrder())</li>\n<li>.filter(Predicate)</li>\n<li>.distinct()</li>\n<li>parallel(), , , . , <code>forEachOrdered(...)</code>Terminal Operations</li>\n</ol>\n<h1 id=\"Terminal-Operations\"><a href=\"#Terminal-Operations\" class=\"headerlink\" title=\"Terminal Operations\"></a>Terminal Operations</h1><ol>\n<li>.collect(Collector.toList())</li>\n<li>.toArray()</li>\n<li>.forEach()</li>\n<li>.reduce(), . <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Reduce</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.stream.Stream;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">IntegerSupplier</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 100()</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">static</span> Stream&lt;Integer&gt; <span class=\"title\">supply</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\tRandom rand = <span class=\"keyword\">new</span> Random(<span class=\"number\">15</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">final</span> <span class=\"keyword\">int</span> BOUND = <span class=\"number\">100</span>;</span><br><span class=\"line\">\t\tStream.Builder&lt;Integer&gt; builder = Stream.builder();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">30</span>; i++) &#123;</span><br><span class=\"line\">\t\t\tbuilder.add(rand.nextInt(BOUND));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> builder.build();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Reduce</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// reduce(BinaryOperator), BinaryOperator</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// fr0, , </span></span><br><span class=\"line\">\t\t<span class=\"comment\">// reduce, IntegerOptional</span></span><br><span class=\"line\">\t\tIntegerSupplier.supply().reduce((fr0, fr1) -&gt; &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(fr0 + <span class=\"string\">&quot;--compare to--&quot;</span> + fr1);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> fr0 &lt; fr1 ? fr0 : fr1;</span><br><span class=\"line\">\t\t&#125;).ifPresent(System.out::println);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// output:</span></span><br><span class=\"line\"><span class=\"comment\">/* 41--compare to--72</span></span><br><span class=\"line\"><span class=\"comment\"> * 72--compare to--38</span></span><br><span class=\"line\"><span class=\"comment\"> * 72--compare to--67</span></span><br><span class=\"line\"><span class=\"comment\"> * 72--compare to--85</span></span><br><span class=\"line\"><span class=\"comment\"> * 85--compare to--60</span></span><br><span class=\"line\"><span class=\"comment\"> * 85--compare to--59</span></span><br><span class=\"line\"><span class=\"comment\"> * Optional[85]</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"Optional\"><a href=\"#Optional\" class=\"headerlink\" title=\"Optional\"></a>Optional</h3><p>, , Optional, <code>Optional.empty</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// , : Stream&lt;String&gt; s = Stream.empty();</span></span><br><span class=\"line\">Stream.&lt;String&gt;empty().findFirst()</span><br><span class=\"line\"><span class=\"comment\">// output: Optional.empty</span></span><br></pre></td></tr></table></figure>\n<p>Optional, Optional<code>isPresent()</code>, <code>orElse</code>, <code>orElseGet</code>, Python3.7Optional, Optional, none.</p>\n"},{"title":"Maven Wrapper","date":"2021-11-07T08:22:04.000Z","_content":"\nmaven, maven\n\n\n## Maven Wrapper\n\n```\nmvn -N io.takari:maven:0.7.7:wrapper\nmvn -N io.takari:maven:wrapper -Dmaven=3.6.3\n```\nThis creates two files (mvnw, mvnw.cmd) and a hidden directory (.mvn). mvnw can be used in Unix-like environments and mvnw.cmd can be used in Windows.\n. `mvnw`Unix-like, `mvnw.cmd`Windows.\n\nInstead of the usual mvn command, they would use mvnw. for example:\n```shell\n./mvnw clean install\n```\n\n## Maven Wrapper\nThe `.mvn/wrapper` directory has a jar file `maven-wrapper.jar` that downloads the required version of Maven if its not already present. It installs it in the `./m2/wrapper/dists` directory under the users home directory.\n\nWhere does it download Maven from? This information is present in the mvn/wrapper/maven-wrapper.properties file:\n```properties\ndistributionUrl=https://repo.maven.apache.org/maven2/org/apache/maven/apache-maven/3.5.2/apache-maven-3.5.2-bin.zip\nwrapperUrl=https://repo.maven.apache.org/maven2/io/takari/maven-wrapper/0.5.6/maven-wrapper-0.5.6.jar\n```\n\n## Maven Wrapper\nYears ago, I was on a team developing a desktop-based Java application. We wanted to share our artifact with a couple of business users in the field to get some feedback. It was unlikely they had Java installed. Asking them to download, install, and configure version 1.2 of Java (yes, this was that long ago!) to run our application would have been a hassle for them.\n\nLooking around trying to find how others had solved this problem, I came across this idea of **bundling the JRE**. The idea was to include within the artifact itself the Java Runtime Environment that our application depended on. Then users dont need to have a particular version or even any version of Java pre-installed - a neat solution to a specific problem.\n\nOver the years I came across this idea in many places. Today when we containerize our application for cloud deployment, its the same general idea: encapsulate the dependent and its dependency into a single unit to hide some complexity.\nThe Maven Wrapper makes it easy to build our code on any machine, including CI/CD servers. We dont have to worry about installing the right version of Maven on the CI servers anymore!\n\n\n## IDEA\n\"\". , . , node_modules.\n1. maven wrapper\n2. `settings.xml``$PROJECT_DIR$/.mvn/`\n3. `$PROJECT_DIR$/.mvn/``repository`\n4. IDEA`Setting > Build, Execution, Deployment > Build Tools > Maven`\n - `Maven Home Path``Use Maven wrapper`, IDEA(2021.2.3+)\n - `User settings file``$PROJECT_DIR$/.mvn/settings.xml`\n - `Local repository``$PROJECT_DIR$/.mvn/repository`\n","source":"_posts/maven-wrapper.md","raw":"---\ntitle: Maven Wrapper\ndate: 2021-11-07 16:22:04\ncategories:\n- Package Manager\ntags:\n- maven\n---\n\nmaven, maven\n\n\n## Maven Wrapper\n\n```\nmvn -N io.takari:maven:0.7.7:wrapper\nmvn -N io.takari:maven:wrapper -Dmaven=3.6.3\n```\nThis creates two files (mvnw, mvnw.cmd) and a hidden directory (.mvn). mvnw can be used in Unix-like environments and mvnw.cmd can be used in Windows.\n. `mvnw`Unix-like, `mvnw.cmd`Windows.\n\nInstead of the usual mvn command, they would use mvnw. for example:\n```shell\n./mvnw clean install\n```\n\n## Maven Wrapper\nThe `.mvn/wrapper` directory has a jar file `maven-wrapper.jar` that downloads the required version of Maven if its not already present. It installs it in the `./m2/wrapper/dists` directory under the users home directory.\n\nWhere does it download Maven from? This information is present in the mvn/wrapper/maven-wrapper.properties file:\n```properties\ndistributionUrl=https://repo.maven.apache.org/maven2/org/apache/maven/apache-maven/3.5.2/apache-maven-3.5.2-bin.zip\nwrapperUrl=https://repo.maven.apache.org/maven2/io/takari/maven-wrapper/0.5.6/maven-wrapper-0.5.6.jar\n```\n\n## Maven Wrapper\nYears ago, I was on a team developing a desktop-based Java application. We wanted to share our artifact with a couple of business users in the field to get some feedback. It was unlikely they had Java installed. Asking them to download, install, and configure version 1.2 of Java (yes, this was that long ago!) to run our application would have been a hassle for them.\n\nLooking around trying to find how others had solved this problem, I came across this idea of **bundling the JRE**. The idea was to include within the artifact itself the Java Runtime Environment that our application depended on. Then users dont need to have a particular version or even any version of Java pre-installed - a neat solution to a specific problem.\n\nOver the years I came across this idea in many places. Today when we containerize our application for cloud deployment, its the same general idea: encapsulate the dependent and its dependency into a single unit to hide some complexity.\nThe Maven Wrapper makes it easy to build our code on any machine, including CI/CD servers. We dont have to worry about installing the right version of Maven on the CI servers anymore!\n\n\n## IDEA\n\"\". , . , node_modules.\n1. maven wrapper\n2. `settings.xml``$PROJECT_DIR$/.mvn/`\n3. `$PROJECT_DIR$/.mvn/``repository`\n4. IDEA`Setting > Build, Execution, Deployment > Build Tools > Maven`\n - `Maven Home Path``Use Maven wrapper`, IDEA(2021.2.3+)\n - `User settings file``$PROJECT_DIR$/.mvn/settings.xml`\n - `Local repository``$PROJECT_DIR$/.mvn/repository`\n","slug":"maven-wrapper","published":1,"updated":"2021-12-30T02:51:36.861Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpyv000vxotgg27783me","content":"<p>maven, maven</p>\n<h2 id=\"Maven-Wrapper\"><a href=\"#Maven-Wrapper\" class=\"headerlink\" title=\"Maven Wrapper\"></a>Maven Wrapper</h2><p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mvn -N io.takari:maven:0.7.7:wrapper</span><br><span class=\"line\">mvn -N io.takari:maven:wrapper -Dmaven=3.6.3</span><br></pre></td></tr></table></figure>\n<p>This creates two files (mvnw, mvnw.cmd) and a hidden directory (.mvn). mvnw can be used in Unix-like environments and mvnw.cmd can be used in Windows.<br>. <code>mvnw</code>Unix-like, <code>mvnw.cmd</code>Windows.</p>\n<p>Instead of the usual mvn command, they would use mvnw. for example:</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./mvnw clean install</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Maven-Wrapper\"><a href=\"#Maven-Wrapper\" class=\"headerlink\" title=\"Maven Wrapper\"></a>Maven Wrapper</h2><p>The <code>.mvn/wrapper</code> directory has a jar file <code>maven-wrapper.jar</code> that downloads the required version of Maven if its not already present. It installs it in the <code>./m2/wrapper/dists</code> directory under the users home directory.</p>\n<p>Where does it download Maven from? This information is present in the mvn/wrapper/maven-wrapper.properties file:</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">distributionUrl</span>=<span class=\"string\">https://repo.maven.apache.org/maven2/org/apache/maven/apache-maven/3.5.2/apache-maven-3.5.2-bin.zip</span></span><br><span class=\"line\"><span class=\"attr\">wrapperUrl</span>=<span class=\"string\">https://repo.maven.apache.org/maven2/io/takari/maven-wrapper/0.5.6/maven-wrapper-0.5.6.jar</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Maven-Wrapper\"><a href=\"#Maven-Wrapper\" class=\"headerlink\" title=\"Maven Wrapper\"></a>Maven Wrapper</h2><p>Years ago, I was on a team developing a desktop-based Java application. We wanted to share our artifact with a couple of business users in the field to get some feedback. It was unlikely they had Java installed. Asking them to download, install, and configure version 1.2 of Java (yes, this was that long ago!) to run our application would have been a hassle for them.</p>\n<p>Looking around trying to find how others had solved this problem, I came across this idea of <strong>bundling the JRE</strong>. The idea was to include within the artifact itself the Java Runtime Environment that our application depended on. Then users dont need to have a particular version or even any version of Java pre-installed - a neat solution to a specific problem.</p>\n<p>Over the years I came across this idea in many places. Today when we containerize our application for cloud deployment, its the same general idea: encapsulate the dependent and its dependency into a single unit to hide some complexity.<br>The Maven Wrapper makes it easy to build our code on any machine, including CI/CD servers. We dont have to worry about installing the right version of Maven on the CI servers anymore!</p>\n<h2 id=\"IDEA\"><a href=\"#IDEA\" class=\"headerlink\" title=\"IDEA\"></a>IDEA</h2><p>. , . , node_modules.</p>\n<ol>\n<li>maven wrapper</li>\n<li><code>settings.xml</code><code>$PROJECT_DIR$/.mvn/</code></li>\n<li><code>$PROJECT_DIR$/.mvn/</code><code>repository</code></li>\n<li>IDEA<code>Setting &gt; Build, Execution, Deployment &gt; Build Tools &gt; Maven</code></li>\n</ol>\n<ul>\n<li><code>Maven Home Path</code><code>Use Maven wrapper</code>, IDEA(2021.2.3+)</li>\n<li><code>User settings file</code><code>$PROJECT_DIR$/.mvn/settings.xml</code></li>\n<li><code>Local repository</code><code>$PROJECT_DIR$/.mvn/repository</code></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>maven, maven</p>\n<h2 id=\"Maven-Wrapper\"><a href=\"#Maven-Wrapper\" class=\"headerlink\" title=\"Maven Wrapper\"></a>Maven Wrapper</h2><p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mvn -N io.takari:maven:0.7.7:wrapper</span><br><span class=\"line\">mvn -N io.takari:maven:wrapper -Dmaven=3.6.3</span><br></pre></td></tr></table></figure>\n<p>This creates two files (mvnw, mvnw.cmd) and a hidden directory (.mvn). mvnw can be used in Unix-like environments and mvnw.cmd can be used in Windows.<br>. <code>mvnw</code>Unix-like, <code>mvnw.cmd</code>Windows.</p>\n<p>Instead of the usual mvn command, they would use mvnw. for example:</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./mvnw clean install</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Maven-Wrapper\"><a href=\"#Maven-Wrapper\" class=\"headerlink\" title=\"Maven Wrapper\"></a>Maven Wrapper</h2><p>The <code>.mvn/wrapper</code> directory has a jar file <code>maven-wrapper.jar</code> that downloads the required version of Maven if its not already present. It installs it in the <code>./m2/wrapper/dists</code> directory under the users home directory.</p>\n<p>Where does it download Maven from? This information is present in the mvn/wrapper/maven-wrapper.properties file:</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">distributionUrl</span>=<span class=\"string\">https://repo.maven.apache.org/maven2/org/apache/maven/apache-maven/3.5.2/apache-maven-3.5.2-bin.zip</span></span><br><span class=\"line\"><span class=\"attr\">wrapperUrl</span>=<span class=\"string\">https://repo.maven.apache.org/maven2/io/takari/maven-wrapper/0.5.6/maven-wrapper-0.5.6.jar</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Maven-Wrapper\"><a href=\"#Maven-Wrapper\" class=\"headerlink\" title=\"Maven Wrapper\"></a>Maven Wrapper</h2><p>Years ago, I was on a team developing a desktop-based Java application. We wanted to share our artifact with a couple of business users in the field to get some feedback. It was unlikely they had Java installed. Asking them to download, install, and configure version 1.2 of Java (yes, this was that long ago!) to run our application would have been a hassle for them.</p>\n<p>Looking around trying to find how others had solved this problem, I came across this idea of <strong>bundling the JRE</strong>. The idea was to include within the artifact itself the Java Runtime Environment that our application depended on. Then users dont need to have a particular version or even any version of Java pre-installed - a neat solution to a specific problem.</p>\n<p>Over the years I came across this idea in many places. Today when we containerize our application for cloud deployment, its the same general idea: encapsulate the dependent and its dependency into a single unit to hide some complexity.<br>The Maven Wrapper makes it easy to build our code on any machine, including CI/CD servers. We dont have to worry about installing the right version of Maven on the CI servers anymore!</p>\n<h2 id=\"IDEA\"><a href=\"#IDEA\" class=\"headerlink\" title=\"IDEA\"></a>IDEA</h2><p>. , . , node_modules.</p>\n<ol>\n<li>maven wrapper</li>\n<li><code>settings.xml</code><code>$PROJECT_DIR$/.mvn/</code></li>\n<li><code>$PROJECT_DIR$/.mvn/</code><code>repository</code></li>\n<li>IDEA<code>Setting &gt; Build, Execution, Deployment &gt; Build Tools &gt; Maven</code></li>\n</ol>\n<ul>\n<li><code>Maven Home Path</code><code>Use Maven wrapper</code>, IDEA(2021.2.3+)</li>\n<li><code>User settings file</code><code>$PROJECT_DIR$/.mvn/settings.xml</code></li>\n<li><code>Local repository</code><code>$PROJECT_DIR$/.mvn/repository</code></li>\n</ul>\n"},{"title":"professional-dictionary","date":"2021-10-05T01:32:58.000Z","_content":"> inference  n.\n\nLambda expressions include a form of type inference in Java.\nLambda.\n\n> assign  v.\n\n`Shape s = new Circle();`  This creates a Circle object, and the resulting reference is immediately assigned to a Shape.\n\"\", `s`()Shape.\n\n> oriented adj.\n\n> object-oriented []adj.\n\n> Connector n.\n\n> Configure v.\n\n> Specified adj.\n\n> Deploy v.\n\n> Undeploy v.\n\n> Expire v.\n\n> Session n.\n\n> Dynamic adj.\n\n> Module n.\n\n> Directory n.\n\n> Descriptor n.\n\n> Install v.\n\n> Synchronize v.\n\n> Meta metan.\n\n> Charset n.\n\n> Charater n.\n\n> Flush v.\n\n> Mapping n.\n\n> Protocol n.\n\n> Generic adj.\n\n> Initialize v.\n\n> Sequence , n.\n\n> In addition to ....\n\n> Thread n.\n\n> Timeout n.\n\n> Summary n.\n\n> Contain v.\n\n> Subclass n.\n\n> Declare v.\n\n> Dispatch v.\n\n> Additional adj.\n\n> Stream n.   \n\n> Input stream\n\n> Encode v.\n\n> URL \n\n> URI \n\n> Invalidate v.\n\n> Layer n.\n\n> Prefix n.\n\n> Tag n.\n\n> Wrapper n.\n\n> Filter n.\n\n> Chain n.\n\n> Notation n.\n\n> Serializev.\n\n> Plugins n.\n\n> Validate v.\n\n> Panel n.\n\n> Literal adj.  \n\n> Constant adj. n.\n\n> Mutable adj.\n\n> Specified adj.\n\n> Collapsible adj.\n\n> Icon []adj.\n\n> Combo n.\n\n> Handler n.\n\n> Grid n.\n\n> Validate v.\n\n> Required adj.\n\n> Parse v.   n.\n\n> Separator n.\n\n> Interrupt n.\n\n> Runnable  adj.\n\n> Daemon []n.\n\n> Priority n.\n\n> Notify v.\n\n> Invokev.\n\n> Split v.\n\n> Deprecated adj.\n\n> Suppressv.\n\n> Retention n.\n\n> Annotation n.\n\n> Nickname n.\n\n> Invocation []n.\n\n> Template n.\n\n> Intersect v.\n\n> Minus n.\n\n> Increment v.\n\n> Validate ..v.\n\n> Encapsulation n.\n\n> Polymorphism n.\n\n> Catalog n.\n\n> Detached adj.\n\n> Persistent adj.\n\n> Transient adj.\n\n> Dependency n.\n\n> Injection n.\n\n> Component n.\n\n> Schema []n.\n\n> Scheme n.\n\n> Suffix n.\n\n> Mechanism n.\n\n> Facet n.\n\n> Validation n.\n\n> Duplicate v.\n\n> Invalid adj.\n\n> Submission n.\n\n> Alias n.\n\n> Argument n.\n\n> Requirements n.\n\n> Neglect vt.\n\n> Term n.\n\n> Allocate vt.\n\n> Validate vt.\n\n> Compile vt.\n\n> Verify vt.\n\n> Repository n.\n\n> Plugins n.\n\n> Procedure [] n.\n\n> Retain vt.\n\n> Clause  n.\n\n> Via  n.f\n\n> Along with \n\n> Excluding  prep.\n\n> Standalone adj.\n\n> Cluster n.\n\n> Aggregation n.\n\n> Excerpt n.\n\n> Integration n.\n\n> Expectation n.\n\n> Composite adj. vt.\n\n> Interaction n.\n\n> Doubt n.vt.\n\n> Field n.\n\n> Intermediate vi. adj. n.\n\n> Authorization n.\n\n> Demarcation n.\n\n> Conscious adj.\n\n> Retrieve vt.\n\n> Traverse []vt.\n\n> Breadth n.\n\n> Breadth Firstn.\n\n> Evaluate vt.\n\n> Perform vt.\n\n> Depth n.\n\n> Instantiate vt.\n\n> Custom n.\n\n> In this case \n\n> Descent n.\n\n> Descendant \n\n> Mutable adj.\n\n> Immutable adj.\n\n> Expand vt.\n\n> In term of \n\n> Explanation n.\n\n> Regardless of \n\n> Latter n.\n\n> Prune n.\n\n> Fluent adj.\n\n> Manual adj.\n\n> Notification n.\n\n> Entity n.\n\n> Whereas n.\n\n> In case \n\n> Persist vi.\n\n> Snapshot n.\n\n> Assert n.\n\n> Quote n.\n\n> Coroutine n.\n\n> \n","source":"_posts/professional-dictionary.md","raw":"---\ntitle: professional-dictionary\ndate: 2021-10-05 09:32:58\ncategories:\n- \n---\n> inference  n.\n\nLambda expressions include a form of type inference in Java.\nLambda.\n\n> assign  v.\n\n`Shape s = new Circle();`  This creates a Circle object, and the resulting reference is immediately assigned to a Shape.\n\"\", `s`()Shape.\n\n> oriented adj.\n\n> object-oriented []adj.\n\n> Connector n.\n\n> Configure v.\n\n> Specified adj.\n\n> Deploy v.\n\n> Undeploy v.\n\n> Expire v.\n\n> Session n.\n\n> Dynamic adj.\n\n> Module n.\n\n> Directory n.\n\n> Descriptor n.\n\n> Install v.\n\n> Synchronize v.\n\n> Meta metan.\n\n> Charset n.\n\n> Charater n.\n\n> Flush v.\n\n> Mapping n.\n\n> Protocol n.\n\n> Generic adj.\n\n> Initialize v.\n\n> Sequence , n.\n\n> In addition to ....\n\n> Thread n.\n\n> Timeout n.\n\n> Summary n.\n\n> Contain v.\n\n> Subclass n.\n\n> Declare v.\n\n> Dispatch v.\n\n> Additional adj.\n\n> Stream n.   \n\n> Input stream\n\n> Encode v.\n\n> URL \n\n> URI \n\n> Invalidate v.\n\n> Layer n.\n\n> Prefix n.\n\n> Tag n.\n\n> Wrapper n.\n\n> Filter n.\n\n> Chain n.\n\n> Notation n.\n\n> Serializev.\n\n> Plugins n.\n\n> Validate v.\n\n> Panel n.\n\n> Literal adj.  \n\n> Constant adj. n.\n\n> Mutable adj.\n\n> Specified adj.\n\n> Collapsible adj.\n\n> Icon []adj.\n\n> Combo n.\n\n> Handler n.\n\n> Grid n.\n\n> Validate v.\n\n> Required adj.\n\n> Parse v.   n.\n\n> Separator n.\n\n> Interrupt n.\n\n> Runnable  adj.\n\n> Daemon []n.\n\n> Priority n.\n\n> Notify v.\n\n> Invokev.\n\n> Split v.\n\n> Deprecated adj.\n\n> Suppressv.\n\n> Retention n.\n\n> Annotation n.\n\n> Nickname n.\n\n> Invocation []n.\n\n> Template n.\n\n> Intersect v.\n\n> Minus n.\n\n> Increment v.\n\n> Validate ..v.\n\n> Encapsulation n.\n\n> Polymorphism n.\n\n> Catalog n.\n\n> Detached adj.\n\n> Persistent adj.\n\n> Transient adj.\n\n> Dependency n.\n\n> Injection n.\n\n> Component n.\n\n> Schema []n.\n\n> Scheme n.\n\n> Suffix n.\n\n> Mechanism n.\n\n> Facet n.\n\n> Validation n.\n\n> Duplicate v.\n\n> Invalid adj.\n\n> Submission n.\n\n> Alias n.\n\n> Argument n.\n\n> Requirements n.\n\n> Neglect vt.\n\n> Term n.\n\n> Allocate vt.\n\n> Validate vt.\n\n> Compile vt.\n\n> Verify vt.\n\n> Repository n.\n\n> Plugins n.\n\n> Procedure [] n.\n\n> Retain vt.\n\n> Clause  n.\n\n> Via  n.f\n\n> Along with \n\n> Excluding  prep.\n\n> Standalone adj.\n\n> Cluster n.\n\n> Aggregation n.\n\n> Excerpt n.\n\n> Integration n.\n\n> Expectation n.\n\n> Composite adj. vt.\n\n> Interaction n.\n\n> Doubt n.vt.\n\n> Field n.\n\n> Intermediate vi. adj. n.\n\n> Authorization n.\n\n> Demarcation n.\n\n> Conscious adj.\n\n> Retrieve vt.\n\n> Traverse []vt.\n\n> Breadth n.\n\n> Breadth Firstn.\n\n> Evaluate vt.\n\n> Perform vt.\n\n> Depth n.\n\n> Instantiate vt.\n\n> Custom n.\n\n> In this case \n\n> Descent n.\n\n> Descendant \n\n> Mutable adj.\n\n> Immutable adj.\n\n> Expand vt.\n\n> In term of \n\n> Explanation n.\n\n> Regardless of \n\n> Latter n.\n\n> Prune n.\n\n> Fluent adj.\n\n> Manual adj.\n\n> Notification n.\n\n> Entity n.\n\n> Whereas n.\n\n> In case \n\n> Persist vi.\n\n> Snapshot n.\n\n> Assert n.\n\n> Quote n.\n\n> Coroutine n.\n\n> \n","slug":"professional-dictionary","published":1,"updated":"2021-12-30T03:04:10.420Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpyx000yxotgbky136mi","content":"<blockquote>\n<p>inference  n.</p>\n</blockquote>\n<p>Lambda expressions include a form of type inference in Java.<br>Lambda.</p>\n<blockquote>\n<p>assign  v.</p>\n</blockquote>\n<p><code>Shape s = new Circle();</code>  This creates a Circle object, and the resulting reference is immediately assigned to a Shape.<br>, <code>s</code>()Shape.</p>\n<blockquote>\n<p>oriented adj.</p>\n</blockquote>\n<blockquote>\n<p>object-oriented []adj.</p>\n</blockquote>\n<blockquote>\n<p>Connector n.</p>\n</blockquote>\n<blockquote>\n<p>Configure v.</p>\n</blockquote>\n<blockquote>\n<p>Specified adj.</p>\n</blockquote>\n<blockquote>\n<p>Deploy v.</p>\n</blockquote>\n<blockquote>\n<p>Undeploy v.</p>\n</blockquote>\n<blockquote>\n<p>Expire v.</p>\n</blockquote>\n<blockquote>\n<p>Session n.</p>\n</blockquote>\n<blockquote>\n<p>Dynamic adj.</p>\n</blockquote>\n<blockquote>\n<p>Module n.</p>\n</blockquote>\n<blockquote>\n<p>Directory n.</p>\n</blockquote>\n<blockquote>\n<p>Descriptor n.</p>\n</blockquote>\n<blockquote>\n<p>Install v.</p>\n</blockquote>\n<blockquote>\n<p>Synchronize v.</p>\n</blockquote>\n<blockquote>\n<p>Meta metan.</p>\n</blockquote>\n<blockquote>\n<p>Charset n.</p>\n</blockquote>\n<blockquote>\n<p>Charater n.</p>\n</blockquote>\n<blockquote>\n<p>Flush v.</p>\n</blockquote>\n<blockquote>\n<p>Mapping n.</p>\n</blockquote>\n<blockquote>\n<p>Protocol n.</p>\n</blockquote>\n<blockquote>\n<p>Generic adj.</p>\n</blockquote>\n<blockquote>\n<p>Initialize v.</p>\n</blockquote>\n<blockquote>\n<p>Sequence , n.</p>\n</blockquote>\n<blockquote>\n<p>In addition to .</p>\n</blockquote>\n<blockquote>\n<p>Thread n.</p>\n</blockquote>\n<blockquote>\n<p>Timeout n.</p>\n</blockquote>\n<blockquote>\n<p>Summary n.</p>\n</blockquote>\n<blockquote>\n<p>Contain v.</p>\n</blockquote>\n<blockquote>\n<p>Subclass n.</p>\n</blockquote>\n<blockquote>\n<p>Declare v.</p>\n</blockquote>\n<blockquote>\n<p>Dispatch v.</p>\n</blockquote>\n<blockquote>\n<p>Additional adj.</p>\n</blockquote>\n<blockquote>\n<p>Stream n.   </p>\n</blockquote>\n<blockquote>\n<p>Input stream</p>\n</blockquote>\n<blockquote>\n<p>Encode v.</p>\n</blockquote>\n<blockquote>\n<p>URL </p>\n</blockquote>\n<blockquote>\n<p>URI </p>\n</blockquote>\n<blockquote>\n<p>Invalidate v.</p>\n</blockquote>\n<blockquote>\n<p>Layer n.</p>\n</blockquote>\n<blockquote>\n<p>Prefix n.</p>\n</blockquote>\n<blockquote>\n<p>Tag n.</p>\n</blockquote>\n<blockquote>\n<p>Wrapper n.</p>\n</blockquote>\n<blockquote>\n<p>Filter n.</p>\n</blockquote>\n<blockquote>\n<p>Chain n.</p>\n</blockquote>\n<blockquote>\n<p>Notation n.</p>\n</blockquote>\n<blockquote>\n<p>Serializev.</p>\n</blockquote>\n<blockquote>\n<p>Plugins n.</p>\n</blockquote>\n<blockquote>\n<p>Validate v.</p>\n</blockquote>\n<blockquote>\n<p>Panel n.</p>\n</blockquote>\n<blockquote>\n<p>Literal adj.  </p>\n</blockquote>\n<blockquote>\n<p>Constant adj. n.</p>\n</blockquote>\n<blockquote>\n<p>Mutable adj.</p>\n</blockquote>\n<blockquote>\n<p>Specified adj.</p>\n</blockquote>\n<blockquote>\n<p>Collapsible adj.</p>\n</blockquote>\n<blockquote>\n<p>Icon []adj.</p>\n</blockquote>\n<blockquote>\n<p>Combo n.</p>\n</blockquote>\n<blockquote>\n<p>Handler n.</p>\n</blockquote>\n<blockquote>\n<p>Grid n.</p>\n</blockquote>\n<blockquote>\n<p>Validate v.</p>\n</blockquote>\n<blockquote>\n<p>Required adj.</p>\n</blockquote>\n<blockquote>\n<p>Parse v.   n.</p>\n</blockquote>\n<blockquote>\n<p>Separator n.</p>\n</blockquote>\n<blockquote>\n<p>Interrupt n.</p>\n</blockquote>\n<blockquote>\n<p>Runnable  adj.</p>\n</blockquote>\n<blockquote>\n<p>Daemon []n.</p>\n</blockquote>\n<blockquote>\n<p>Priority n.</p>\n</blockquote>\n<blockquote>\n<p>Notify v.</p>\n</blockquote>\n<blockquote>\n<p>Invokev.</p>\n</blockquote>\n<blockquote>\n<p>Split v.</p>\n</blockquote>\n<blockquote>\n<p>Deprecated adj.</p>\n</blockquote>\n<blockquote>\n<p>Suppressv.</p>\n</blockquote>\n<blockquote>\n<p>Retention n.</p>\n</blockquote>\n<blockquote>\n<p>Annotation n.</p>\n</blockquote>\n<blockquote>\n<p>Nickname n.</p>\n</blockquote>\n<blockquote>\n<p>Invocation []n.</p>\n</blockquote>\n<blockquote>\n<p>Template n.</p>\n</blockquote>\n<blockquote>\n<p>Intersect v.</p>\n</blockquote>\n<blockquote>\n<p>Minus n.</p>\n</blockquote>\n<blockquote>\n<p>Increment v.</p>\n</blockquote>\n<blockquote>\n<p>Validate ..v.</p>\n</blockquote>\n<blockquote>\n<p>Encapsulation n.</p>\n</blockquote>\n<blockquote>\n<p>Polymorphism n.</p>\n</blockquote>\n<blockquote>\n<p>Catalog n.</p>\n</blockquote>\n<blockquote>\n<p>Detached adj.</p>\n</blockquote>\n<blockquote>\n<p>Persistent adj.</p>\n</blockquote>\n<blockquote>\n<p>Transient adj.</p>\n</blockquote>\n<blockquote>\n<p>Dependency n.</p>\n</blockquote>\n<blockquote>\n<p>Injection n.</p>\n</blockquote>\n<blockquote>\n<p>Component n.</p>\n</blockquote>\n<blockquote>\n<p>Schema []n.</p>\n</blockquote>\n<blockquote>\n<p>Scheme n.</p>\n</blockquote>\n<blockquote>\n<p>Suffix n.</p>\n</blockquote>\n<blockquote>\n<p>Mechanism n.</p>\n</blockquote>\n<blockquote>\n<p>Facet n.</p>\n</blockquote>\n<blockquote>\n<p>Validation n.</p>\n</blockquote>\n<blockquote>\n<p>Duplicate v.</p>\n</blockquote>\n<blockquote>\n<p>Invalid adj.</p>\n</blockquote>\n<blockquote>\n<p>Submission n.</p>\n</blockquote>\n<blockquote>\n<p>Alias n.</p>\n</blockquote>\n<blockquote>\n<p>Argument n.</p>\n</blockquote>\n<blockquote>\n<p>Requirements n.</p>\n</blockquote>\n<blockquote>\n<p>Neglect vt.</p>\n</blockquote>\n<blockquote>\n<p>Term n.</p>\n</blockquote>\n<blockquote>\n<p>Allocate vt.</p>\n</blockquote>\n<blockquote>\n<p>Validate vt.</p>\n</blockquote>\n<blockquote>\n<p>Compile vt.</p>\n</blockquote>\n<blockquote>\n<p>Verify vt.</p>\n</blockquote>\n<blockquote>\n<p>Repository n.</p>\n</blockquote>\n<blockquote>\n<p>Plugins n.</p>\n</blockquote>\n<blockquote>\n<p>Procedure [] n.</p>\n</blockquote>\n<blockquote>\n<p>Retain vt.</p>\n</blockquote>\n<blockquote>\n<p>Clause  n.</p>\n</blockquote>\n<blockquote>\n<p>Via  n.f</p>\n</blockquote>\n<blockquote>\n<p>Along with </p>\n</blockquote>\n<blockquote>\n<p>Excluding  prep.</p>\n</blockquote>\n<blockquote>\n<p>Standalone adj.</p>\n</blockquote>\n<blockquote>\n<p>Cluster n.</p>\n</blockquote>\n<blockquote>\n<p>Aggregation n.</p>\n</blockquote>\n<blockquote>\n<p>Excerpt n.</p>\n</blockquote>\n<blockquote>\n<p>Integration n.</p>\n</blockquote>\n<blockquote>\n<p>Expectation n.</p>\n</blockquote>\n<blockquote>\n<p>Composite adj. vt.</p>\n</blockquote>\n<blockquote>\n<p>Interaction n.</p>\n</blockquote>\n<blockquote>\n<p>Doubt n.vt.</p>\n</blockquote>\n<blockquote>\n<p>Field n.</p>\n</blockquote>\n<blockquote>\n<p>Intermediate vi. adj. n.</p>\n</blockquote>\n<blockquote>\n<p>Authorization n.</p>\n</blockquote>\n<blockquote>\n<p>Demarcation n.</p>\n</blockquote>\n<blockquote>\n<p>Conscious adj.</p>\n</blockquote>\n<blockquote>\n<p>Retrieve vt.</p>\n</blockquote>\n<blockquote>\n<p>Traverse []vt.</p>\n</blockquote>\n<blockquote>\n<p>Breadth n.</p>\n</blockquote>\n<blockquote>\n<p>Breadth Firstn.</p>\n</blockquote>\n<blockquote>\n<p>Evaluate vt.</p>\n</blockquote>\n<blockquote>\n<p>Perform vt.</p>\n</blockquote>\n<blockquote>\n<p>Depth n.</p>\n</blockquote>\n<blockquote>\n<p>Instantiate vt.</p>\n</blockquote>\n<blockquote>\n<p>Custom n.</p>\n</blockquote>\n<blockquote>\n<p>In this case </p>\n</blockquote>\n<blockquote>\n<p>Descent n.</p>\n</blockquote>\n<blockquote>\n<p>Descendant </p>\n</blockquote>\n<blockquote>\n<p>Mutable adj.</p>\n</blockquote>\n<blockquote>\n<p>Immutable adj.</p>\n</blockquote>\n<blockquote>\n<p>Expand vt.</p>\n</blockquote>\n<blockquote>\n<p>In term of </p>\n</blockquote>\n<blockquote>\n<p>Explanation n.</p>\n</blockquote>\n<blockquote>\n<p>Regardless of </p>\n</blockquote>\n<blockquote>\n<p>Latter n.</p>\n</blockquote>\n<blockquote>\n<p>Prune n.</p>\n</blockquote>\n<blockquote>\n<p>Fluent adj.</p>\n</blockquote>\n<blockquote>\n<p>Manual adj.</p>\n</blockquote>\n<blockquote>\n<p>Notification n.</p>\n</blockquote>\n<blockquote>\n<p>Entity n.</p>\n</blockquote>\n<blockquote>\n<p>Whereas n.</p>\n</blockquote>\n<blockquote>\n<p>In case </p>\n</blockquote>\n<blockquote>\n<p>Persist vi.</p>\n</blockquote>\n<blockquote>\n<p>Snapshot n.</p>\n</blockquote>\n<blockquote>\n<p>Assert n.</p>\n</blockquote>\n<blockquote>\n<p>Quote n.</p>\n</blockquote>\n<blockquote>\n<p>Coroutine n.</p>\n</blockquote>\n<blockquote>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>inference  n.</p>\n</blockquote>\n<p>Lambda expressions include a form of type inference in Java.<br>Lambda.</p>\n<blockquote>\n<p>assign  v.</p>\n</blockquote>\n<p><code>Shape s = new Circle();</code>  This creates a Circle object, and the resulting reference is immediately assigned to a Shape.<br>, <code>s</code>()Shape.</p>\n<blockquote>\n<p>oriented adj.</p>\n</blockquote>\n<blockquote>\n<p>object-oriented []adj.</p>\n</blockquote>\n<blockquote>\n<p>Connector n.</p>\n</blockquote>\n<blockquote>\n<p>Configure v.</p>\n</blockquote>\n<blockquote>\n<p>Specified adj.</p>\n</blockquote>\n<blockquote>\n<p>Deploy v.</p>\n</blockquote>\n<blockquote>\n<p>Undeploy v.</p>\n</blockquote>\n<blockquote>\n<p>Expire v.</p>\n</blockquote>\n<blockquote>\n<p>Session n.</p>\n</blockquote>\n<blockquote>\n<p>Dynamic adj.</p>\n</blockquote>\n<blockquote>\n<p>Module n.</p>\n</blockquote>\n<blockquote>\n<p>Directory n.</p>\n</blockquote>\n<blockquote>\n<p>Descriptor n.</p>\n</blockquote>\n<blockquote>\n<p>Install v.</p>\n</blockquote>\n<blockquote>\n<p>Synchronize v.</p>\n</blockquote>\n<blockquote>\n<p>Meta metan.</p>\n</blockquote>\n<blockquote>\n<p>Charset n.</p>\n</blockquote>\n<blockquote>\n<p>Charater n.</p>\n</blockquote>\n<blockquote>\n<p>Flush v.</p>\n</blockquote>\n<blockquote>\n<p>Mapping n.</p>\n</blockquote>\n<blockquote>\n<p>Protocol n.</p>\n</blockquote>\n<blockquote>\n<p>Generic adj.</p>\n</blockquote>\n<blockquote>\n<p>Initialize v.</p>\n</blockquote>\n<blockquote>\n<p>Sequence , n.</p>\n</blockquote>\n<blockquote>\n<p>In addition to .</p>\n</blockquote>\n<blockquote>\n<p>Thread n.</p>\n</blockquote>\n<blockquote>\n<p>Timeout n.</p>\n</blockquote>\n<blockquote>\n<p>Summary n.</p>\n</blockquote>\n<blockquote>\n<p>Contain v.</p>\n</blockquote>\n<blockquote>\n<p>Subclass n.</p>\n</blockquote>\n<blockquote>\n<p>Declare v.</p>\n</blockquote>\n<blockquote>\n<p>Dispatch v.</p>\n</blockquote>\n<blockquote>\n<p>Additional adj.</p>\n</blockquote>\n<blockquote>\n<p>Stream n.   </p>\n</blockquote>\n<blockquote>\n<p>Input stream</p>\n</blockquote>\n<blockquote>\n<p>Encode v.</p>\n</blockquote>\n<blockquote>\n<p>URL </p>\n</blockquote>\n<blockquote>\n<p>URI </p>\n</blockquote>\n<blockquote>\n<p>Invalidate v.</p>\n</blockquote>\n<blockquote>\n<p>Layer n.</p>\n</blockquote>\n<blockquote>\n<p>Prefix n.</p>\n</blockquote>\n<blockquote>\n<p>Tag n.</p>\n</blockquote>\n<blockquote>\n<p>Wrapper n.</p>\n</blockquote>\n<blockquote>\n<p>Filter n.</p>\n</blockquote>\n<blockquote>\n<p>Chain n.</p>\n</blockquote>\n<blockquote>\n<p>Notation n.</p>\n</blockquote>\n<blockquote>\n<p>Serializev.</p>\n</blockquote>\n<blockquote>\n<p>Plugins n.</p>\n</blockquote>\n<blockquote>\n<p>Validate v.</p>\n</blockquote>\n<blockquote>\n<p>Panel n.</p>\n</blockquote>\n<blockquote>\n<p>Literal adj.  </p>\n</blockquote>\n<blockquote>\n<p>Constant adj. n.</p>\n</blockquote>\n<blockquote>\n<p>Mutable adj.</p>\n</blockquote>\n<blockquote>\n<p>Specified adj.</p>\n</blockquote>\n<blockquote>\n<p>Collapsible adj.</p>\n</blockquote>\n<blockquote>\n<p>Icon []adj.</p>\n</blockquote>\n<blockquote>\n<p>Combo n.</p>\n</blockquote>\n<blockquote>\n<p>Handler n.</p>\n</blockquote>\n<blockquote>\n<p>Grid n.</p>\n</blockquote>\n<blockquote>\n<p>Validate v.</p>\n</blockquote>\n<blockquote>\n<p>Required adj.</p>\n</blockquote>\n<blockquote>\n<p>Parse v.   n.</p>\n</blockquote>\n<blockquote>\n<p>Separator n.</p>\n</blockquote>\n<blockquote>\n<p>Interrupt n.</p>\n</blockquote>\n<blockquote>\n<p>Runnable  adj.</p>\n</blockquote>\n<blockquote>\n<p>Daemon []n.</p>\n</blockquote>\n<blockquote>\n<p>Priority n.</p>\n</blockquote>\n<blockquote>\n<p>Notify v.</p>\n</blockquote>\n<blockquote>\n<p>Invokev.</p>\n</blockquote>\n<blockquote>\n<p>Split v.</p>\n</blockquote>\n<blockquote>\n<p>Deprecated adj.</p>\n</blockquote>\n<blockquote>\n<p>Suppressv.</p>\n</blockquote>\n<blockquote>\n<p>Retention n.</p>\n</blockquote>\n<blockquote>\n<p>Annotation n.</p>\n</blockquote>\n<blockquote>\n<p>Nickname n.</p>\n</blockquote>\n<blockquote>\n<p>Invocation []n.</p>\n</blockquote>\n<blockquote>\n<p>Template n.</p>\n</blockquote>\n<blockquote>\n<p>Intersect v.</p>\n</blockquote>\n<blockquote>\n<p>Minus n.</p>\n</blockquote>\n<blockquote>\n<p>Increment v.</p>\n</blockquote>\n<blockquote>\n<p>Validate ..v.</p>\n</blockquote>\n<blockquote>\n<p>Encapsulation n.</p>\n</blockquote>\n<blockquote>\n<p>Polymorphism n.</p>\n</blockquote>\n<blockquote>\n<p>Catalog n.</p>\n</blockquote>\n<blockquote>\n<p>Detached adj.</p>\n</blockquote>\n<blockquote>\n<p>Persistent adj.</p>\n</blockquote>\n<blockquote>\n<p>Transient adj.</p>\n</blockquote>\n<blockquote>\n<p>Dependency n.</p>\n</blockquote>\n<blockquote>\n<p>Injection n.</p>\n</blockquote>\n<blockquote>\n<p>Component n.</p>\n</blockquote>\n<blockquote>\n<p>Schema []n.</p>\n</blockquote>\n<blockquote>\n<p>Scheme n.</p>\n</blockquote>\n<blockquote>\n<p>Suffix n.</p>\n</blockquote>\n<blockquote>\n<p>Mechanism n.</p>\n</blockquote>\n<blockquote>\n<p>Facet n.</p>\n</blockquote>\n<blockquote>\n<p>Validation n.</p>\n</blockquote>\n<blockquote>\n<p>Duplicate v.</p>\n</blockquote>\n<blockquote>\n<p>Invalid adj.</p>\n</blockquote>\n<blockquote>\n<p>Submission n.</p>\n</blockquote>\n<blockquote>\n<p>Alias n.</p>\n</blockquote>\n<blockquote>\n<p>Argument n.</p>\n</blockquote>\n<blockquote>\n<p>Requirements n.</p>\n</blockquote>\n<blockquote>\n<p>Neglect vt.</p>\n</blockquote>\n<blockquote>\n<p>Term n.</p>\n</blockquote>\n<blockquote>\n<p>Allocate vt.</p>\n</blockquote>\n<blockquote>\n<p>Validate vt.</p>\n</blockquote>\n<blockquote>\n<p>Compile vt.</p>\n</blockquote>\n<blockquote>\n<p>Verify vt.</p>\n</blockquote>\n<blockquote>\n<p>Repository n.</p>\n</blockquote>\n<blockquote>\n<p>Plugins n.</p>\n</blockquote>\n<blockquote>\n<p>Procedure [] n.</p>\n</blockquote>\n<blockquote>\n<p>Retain vt.</p>\n</blockquote>\n<blockquote>\n<p>Clause  n.</p>\n</blockquote>\n<blockquote>\n<p>Via  n.f</p>\n</blockquote>\n<blockquote>\n<p>Along with </p>\n</blockquote>\n<blockquote>\n<p>Excluding  prep.</p>\n</blockquote>\n<blockquote>\n<p>Standalone adj.</p>\n</blockquote>\n<blockquote>\n<p>Cluster n.</p>\n</blockquote>\n<blockquote>\n<p>Aggregation n.</p>\n</blockquote>\n<blockquote>\n<p>Excerpt n.</p>\n</blockquote>\n<blockquote>\n<p>Integration n.</p>\n</blockquote>\n<blockquote>\n<p>Expectation n.</p>\n</blockquote>\n<blockquote>\n<p>Composite adj. vt.</p>\n</blockquote>\n<blockquote>\n<p>Interaction n.</p>\n</blockquote>\n<blockquote>\n<p>Doubt n.vt.</p>\n</blockquote>\n<blockquote>\n<p>Field n.</p>\n</blockquote>\n<blockquote>\n<p>Intermediate vi. adj. n.</p>\n</blockquote>\n<blockquote>\n<p>Authorization n.</p>\n</blockquote>\n<blockquote>\n<p>Demarcation n.</p>\n</blockquote>\n<blockquote>\n<p>Conscious adj.</p>\n</blockquote>\n<blockquote>\n<p>Retrieve vt.</p>\n</blockquote>\n<blockquote>\n<p>Traverse []vt.</p>\n</blockquote>\n<blockquote>\n<p>Breadth n.</p>\n</blockquote>\n<blockquote>\n<p>Breadth Firstn.</p>\n</blockquote>\n<blockquote>\n<p>Evaluate vt.</p>\n</blockquote>\n<blockquote>\n<p>Perform vt.</p>\n</blockquote>\n<blockquote>\n<p>Depth n.</p>\n</blockquote>\n<blockquote>\n<p>Instantiate vt.</p>\n</blockquote>\n<blockquote>\n<p>Custom n.</p>\n</blockquote>\n<blockquote>\n<p>In this case </p>\n</blockquote>\n<blockquote>\n<p>Descent n.</p>\n</blockquote>\n<blockquote>\n<p>Descendant </p>\n</blockquote>\n<blockquote>\n<p>Mutable adj.</p>\n</blockquote>\n<blockquote>\n<p>Immutable adj.</p>\n</blockquote>\n<blockquote>\n<p>Expand vt.</p>\n</blockquote>\n<blockquote>\n<p>In term of </p>\n</blockquote>\n<blockquote>\n<p>Explanation n.</p>\n</blockquote>\n<blockquote>\n<p>Regardless of </p>\n</blockquote>\n<blockquote>\n<p>Latter n.</p>\n</blockquote>\n<blockquote>\n<p>Prune n.</p>\n</blockquote>\n<blockquote>\n<p>Fluent adj.</p>\n</blockquote>\n<blockquote>\n<p>Manual adj.</p>\n</blockquote>\n<blockquote>\n<p>Notification n.</p>\n</blockquote>\n<blockquote>\n<p>Entity n.</p>\n</blockquote>\n<blockquote>\n<p>Whereas n.</p>\n</blockquote>\n<blockquote>\n<p>In case </p>\n</blockquote>\n<blockquote>\n<p>Persist vi.</p>\n</blockquote>\n<blockquote>\n<p>Snapshot n.</p>\n</blockquote>\n<blockquote>\n<p>Assert n.</p>\n</blockquote>\n<blockquote>\n<p>Quote n.</p>\n</blockquote>\n<blockquote>\n<p>Coroutine n.</p>\n</blockquote>\n<blockquote>\n</blockquote>\n"},{"title":"","date":"2021-11-22T08:22:51.000Z","_content":" \n\n\n# Java Serialization\nSerialization is the conversion of the state of an object into a byte stream; deserialization does the opposite. \nStated differently, serialization is the conversion of **a Java object into a static stream (sequence) of bytes** which can then be saved to a database or transferred over a network.\n\nif further, reference: \nhttps://snyk.io/blog/serialization-and-deserialization-in-java/\n","source":"_posts/serialization-deserialization.md","raw":"---\ntitle: \ndate: 2021-11-22 16:22:51\ntags:\n- Serialization\n---\n \n\n\n# Java Serialization\nSerialization is the conversion of the state of an object into a byte stream; deserialization does the opposite. \nStated differently, serialization is the conversion of **a Java object into a static stream (sequence) of bytes** which can then be saved to a database or transferred over a network.\n\nif further, reference: \nhttps://snyk.io/blog/serialization-and-deserialization-in-java/\n","slug":"serialization-deserialization","published":1,"updated":"2021-12-30T02:54:18.957Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpyz0012xotg2tceetz9","content":"<p> <br></p>\n<h1 id=\"Java-Serialization\"><a href=\"#Java-Serialization\" class=\"headerlink\" title=\"Java Serialization\"></a>Java Serialization</h1><p>Serialization is the conversion of the state of an object into a byte stream; deserialization does the opposite.<br>Stated differently, serialization is the conversion of <strong>a Java object into a static stream (sequence) of bytes</strong> which can then be saved to a database or transferred over a network.</p>\n<p>if further, reference:<br><a href=\"https://snyk.io/blog/serialization-and-deserialization-in-java/\">https://snyk.io/blog/serialization-and-deserialization-in-java/</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p> <br></p>\n<h1 id=\"Java-Serialization\"><a href=\"#Java-Serialization\" class=\"headerlink\" title=\"Java Serialization\"></a>Java Serialization</h1><p>Serialization is the conversion of the state of an object into a byte stream; deserialization does the opposite.<br>Stated differently, serialization is the conversion of <strong>a Java object into a static stream (sequence) of bytes</strong> which can then be saved to a database or transferred over a network.</p>\n<p>if further, reference:<br><a href=\"https://snyk.io/blog/serialization-and-deserialization-in-java/\">https://snyk.io/blog/serialization-and-deserialization-in-java/</a></p>\n"},{"title":"Spring AOP","date":"2021-10-01T11:07:03.000Z","_content":"\n# AOP\n, OOP, . , OOP. OOP, . AOP.\n - AOP, AOP, AspectJ. , Aspect, , Aspect. , AspectJajcAspectJavaJava, JavaJava.\n - AOP, AOP, JavaAspect, Spring AOP.\n\n ### Joinpoint\n , , Joinpoint. , , , , , .\n ### Pointcut\n (Joinpoint). , Joinpoint, Joinpoint.\n ### Advice\n , Joinpoint. :\n  - Before Advice, JoinpointAdvice\n  - After Advice, Joinpoint, After returning Advice, Afterthrowing Advice\n  - Around Advice, , Interceptor. Before AdviceAfter Advice.\n  - Introduction\n ### Aspect\n AspectAOP.\n\n# Spring AOP\nAOP, Spring AOPSpringAOP. Spring, 20%AOP80%.\n\n ## CGLIB(ASM)\n , , .\n Spring AOP, InvocationHandler, , Advice. Advice.\n , . Interface, Interface, .\n\n , , , , , , . CGLIB, .\n `net.sf.cglib.proxy.MethodInterceptor`(net.sf.cglib.proxy.Callback): \n ```java\n class Requestable {\n     public void request(){\n         System.out.println(\"OK\");\n     }\n }\n public class RequestCtrlInterceptor implements MethodInterceptor {\n     private static final Log logger = LogFactory.getLog(RequestCtrlInterceptor.class);\n     public Object intercept(Object object, Method method, Object[] args, MethodProxy proxy) throws Throwable {\n         if(method.getName().equals(\"request\")) {\n            TimeOfDay startTime = new TiemOfDay(0, 0, 0);\n            TimeOfDay endTime = new TiemOfDay(5, 59, 59);\n            TiemOfDay currentTime = new TimeDay();\n            if(currentTime.isAfter(startTime) && currentTime.isBefore(endTime)) {\n                logger.warn(\"Service is not available now.\");\n                return null;\n            }\n            return proxy.invokeSuper(object, args);\n         }\n         return null;\n     }\n }\n ```\n , RequestCtrlInterceptorrequest(). CGLIBEnhance, RequestCtrlInterceptor, :\n ```Java\n Enhancer enhancer = new Enhancer();\n enhancer.setSuperclass(Requestable.class);\n enhancer.setCallback(new RequestCtrlInterceptor());\n \n Requestable proxy = (Requestable) enhancer.create();\n proxy.request();\n ```\n Enhancer, Spring AOP, Advisor\n\n# Spring AOP\nJoinpoint, Spring AOPJoinpoint, , (Method Execution)Joinpoint, :\n - Spring AOP\n - FieldJoinpoint, getter/setter\n - , AspectJ(AspectJJoinpointAOP, )\n\nPointcut, Spring AOPorg.springframework.aop.Pointcut\n```java\npublic interface Pointcut {\n    ClassFilter getClassFilter;\n    MethodMatcher getMethodMatcher;\n    Pointcut TRUE = TruePointcut.INSTANCE;\n}\n```\n, , \n\nAdvice, AdvicePointcutJoinpoint. Advice, Around Advice.\nSrpingAround Advice, AOP Alliance, : `org.aopalliance.intercept.MethodInterceptor`, : \n```java\npackage org.aopalliance.intercept;\n\n/**\n * Intercepts calls on an interface on its way to the target. These\n * are nested \"on top\" of the target.\n * ...\n */\n@FunctionalInterface\npublic interface MethodInterceptor extends Interceptor {\n\n\t/**\n\t * Implement this method to perform extra treatments before and\n\t * after the invocation. Polite implementations would certainly\n\t * like to invoke {@link Joinpoint#proceed()}.\n\t * @param invocation the method invocation joinpoint\n\t * @return the result of the call to {@link Joinpoint#proceed()};\n\t * might be intercepted by the interceptor\n\t * @throws Throwable if the interceptors or the target object\n\t * throws an exception\n\t */\n\tObject invoke(MethodInvocation invocation) throws Throwable;\n}\n```\nAdvice, , Around Advice, : ///.\n\n: , , 8, .\n```java\npublic class DiscountMethodInterceptor implements MethodInterceptor {\n    private static final Integer DEFAULT_DISCOUNT_RATIO = 80;\n\n    public Object invoke (MethodInvocation invocation) throws Throwable {\n        Object returnValue = invocation.proceed();\n        return ((Integer) returnValue) * DEFAULT_DISCOUNT_RATIO / 100;\n    }\n}\n```\n> MethodInvocationinvokeMethodInvocation, Joinpoint. MethodInvocationproceed(), , . MethodInterceptorproceed(),MethodInterceptor\"\".\n\nSpring, AdvicePOJO, , IoC, :\n```XML\n<bean id=\"discountInterceptor\" class=\"...DiscountMethodInterceptor\"></bean>\n```\n\nMethodInterceptor, ?**{% post_link java-chain-of-responsibility '' %}**\n\n# SpringAOP\nAspectJajc, SpringAOP`org.springframework.aop.ProxyFactory`, Spring AOP.\n\n: **Spring AIOAOP, , **. ProxyFactory.\n\nProxyFactory, , Aspect(SpringAdvisor). Advisor, Advice, :\n```Java\nProxyFactory weaver = new ProxyFactory(new Executable());\nNameMatchMethodPointcutAdvisor advisor = new NameMathMethodPointcutAdvisor();\nadvisor.setMappedName(\"request\");\nadvisor.setAdvice(new RequestCtrlInterceptor());\nweaver.addAdvisor(advisor);\n\n// \nweaver.setProxyTargetClass(true);\n\nRequestable proxyObject = (Requestable) weaver.getProxy();\nproxyObject.request();\nSystem.out.println(proxyObject.getClass());\n\n// out\n// class ...Requestable$$EnhancerByCGLIB$$9e62fc83\n// ProxyFactoryEnhancer, CGLIB, \"$Proxy0\"\n```\n\nSpring AOPAOPCGLIB, . , , `proxyTargetClass``true`, , .\n\n## ProxyFactory\n\n{% plantuml %}\nAdvisedSupport <.. AopProxyFactory: according to\ninterface AopProxyFactory {\n    AopProxy createAopProxy(AdvisedSupport config)\n}\nAopProxyFactory <|.. DefaultAopProxyFactory\n\nAopFactory <.. AopProxyFactory: create\ninterface AopFactory {\n    Object getProxy()\n    Object getProxy(ClassLoader classLoader)\n}\n\nAopFactory <|.. JdkDynamicProxy\n\nJdkDynamicProxy ..|> InvocationHandler\ninterface InvocationHandler {}\n\nAopFactory <|.. Cglib2AopProxy\n\n{% endplantuml%}\n\nAopProxyCglib2AopProxyJdkDynamicProxy. InvocationHandler, JdkDynamicProxyInvocationHandler.\n\nAopProxy, AopProxyFactory.\n```java\npublic interface AopProxyFactory {\n\n\t/**\n\t * Create an {@link AopProxy} for the given AOP configuration.\n\t * @param config the AOP configuration in the form of an\n\t * AdvisedSupport object\n\t * @return the corresponding AOP proxy\n\t * @throws AopConfigException if the configuration is invalid\n\t */\n\tAopProxy createAopProxy(AdvisedSupport config) throws AopConfigException;\n\n}\n\n```\nAopProxyFactory, DefaultAopProxyFactory, DefaultAopProxyFactoryCglib\n```java\nif(config.isOptimize || config.isProxyTargetClass() || ...) {\n    // Cglib2AopProxy, \n} else {\n    // JdkDynamicAopProxy, \n}\n```\n177, AOP.\n\n\n, , ? \n, , ? \n, , Class.forName(...).getConstructor()NoSuchMethodException?\n\n\n\n\n","source":"_posts/spring-aop.md","raw":"---\ntitle: Spring AOP\ndate: 2021-09-31 19:07:03\ncategories:\n- Spring\ntags:\n- AOP\n- Spring\n---\n\n# AOP\n, OOP, . , OOP. OOP, . AOP.\n - AOP, AOP, AspectJ. , Aspect, , Aspect. , AspectJajcAspectJavaJava, JavaJava.\n - AOP, AOP, JavaAspect, Spring AOP.\n\n ### Joinpoint\n , , Joinpoint. , , , , , .\n ### Pointcut\n (Joinpoint). , Joinpoint, Joinpoint.\n ### Advice\n , Joinpoint. :\n  - Before Advice, JoinpointAdvice\n  - After Advice, Joinpoint, After returning Advice, Afterthrowing Advice\n  - Around Advice, , Interceptor. Before AdviceAfter Advice.\n  - Introduction\n ### Aspect\n AspectAOP.\n\n# Spring AOP\nAOP, Spring AOPSpringAOP. Spring, 20%AOP80%.\n\n ## CGLIB(ASM)\n , , .\n Spring AOP, InvocationHandler, , Advice. Advice.\n , . Interface, Interface, .\n\n , , , , , , . CGLIB, .\n `net.sf.cglib.proxy.MethodInterceptor`(net.sf.cglib.proxy.Callback): \n ```java\n class Requestable {\n     public void request(){\n         System.out.println(\"OK\");\n     }\n }\n public class RequestCtrlInterceptor implements MethodInterceptor {\n     private static final Log logger = LogFactory.getLog(RequestCtrlInterceptor.class);\n     public Object intercept(Object object, Method method, Object[] args, MethodProxy proxy) throws Throwable {\n         if(method.getName().equals(\"request\")) {\n            TimeOfDay startTime = new TiemOfDay(0, 0, 0);\n            TimeOfDay endTime = new TiemOfDay(5, 59, 59);\n            TiemOfDay currentTime = new TimeDay();\n            if(currentTime.isAfter(startTime) && currentTime.isBefore(endTime)) {\n                logger.warn(\"Service is not available now.\");\n                return null;\n            }\n            return proxy.invokeSuper(object, args);\n         }\n         return null;\n     }\n }\n ```\n , RequestCtrlInterceptorrequest(). CGLIBEnhance, RequestCtrlInterceptor, :\n ```Java\n Enhancer enhancer = new Enhancer();\n enhancer.setSuperclass(Requestable.class);\n enhancer.setCallback(new RequestCtrlInterceptor());\n \n Requestable proxy = (Requestable) enhancer.create();\n proxy.request();\n ```\n Enhancer, Spring AOP, Advisor\n\n# Spring AOP\nJoinpoint, Spring AOPJoinpoint, , (Method Execution)Joinpoint, :\n - Spring AOP\n - FieldJoinpoint, getter/setter\n - , AspectJ(AspectJJoinpointAOP, )\n\nPointcut, Spring AOPorg.springframework.aop.Pointcut\n```java\npublic interface Pointcut {\n    ClassFilter getClassFilter;\n    MethodMatcher getMethodMatcher;\n    Pointcut TRUE = TruePointcut.INSTANCE;\n}\n```\n, , \n\nAdvice, AdvicePointcutJoinpoint. Advice, Around Advice.\nSrpingAround Advice, AOP Alliance, : `org.aopalliance.intercept.MethodInterceptor`, : \n```java\npackage org.aopalliance.intercept;\n\n/**\n * Intercepts calls on an interface on its way to the target. These\n * are nested \"on top\" of the target.\n * ...\n */\n@FunctionalInterface\npublic interface MethodInterceptor extends Interceptor {\n\n\t/**\n\t * Implement this method to perform extra treatments before and\n\t * after the invocation. Polite implementations would certainly\n\t * like to invoke {@link Joinpoint#proceed()}.\n\t * @param invocation the method invocation joinpoint\n\t * @return the result of the call to {@link Joinpoint#proceed()};\n\t * might be intercepted by the interceptor\n\t * @throws Throwable if the interceptors or the target object\n\t * throws an exception\n\t */\n\tObject invoke(MethodInvocation invocation) throws Throwable;\n}\n```\nAdvice, , Around Advice, : ///.\n\n: , , 8, .\n```java\npublic class DiscountMethodInterceptor implements MethodInterceptor {\n    private static final Integer DEFAULT_DISCOUNT_RATIO = 80;\n\n    public Object invoke (MethodInvocation invocation) throws Throwable {\n        Object returnValue = invocation.proceed();\n        return ((Integer) returnValue) * DEFAULT_DISCOUNT_RATIO / 100;\n    }\n}\n```\n> MethodInvocationinvokeMethodInvocation, Joinpoint. MethodInvocationproceed(), , . MethodInterceptorproceed(),MethodInterceptor\"\".\n\nSpring, AdvicePOJO, , IoC, :\n```XML\n<bean id=\"discountInterceptor\" class=\"...DiscountMethodInterceptor\"></bean>\n```\n\nMethodInterceptor, ?**{% post_link java-chain-of-responsibility '' %}**\n\n# SpringAOP\nAspectJajc, SpringAOP`org.springframework.aop.ProxyFactory`, Spring AOP.\n\n: **Spring AIOAOP, , **. ProxyFactory.\n\nProxyFactory, , Aspect(SpringAdvisor). Advisor, Advice, :\n```Java\nProxyFactory weaver = new ProxyFactory(new Executable());\nNameMatchMethodPointcutAdvisor advisor = new NameMathMethodPointcutAdvisor();\nadvisor.setMappedName(\"request\");\nadvisor.setAdvice(new RequestCtrlInterceptor());\nweaver.addAdvisor(advisor);\n\n// \nweaver.setProxyTargetClass(true);\n\nRequestable proxyObject = (Requestable) weaver.getProxy();\nproxyObject.request();\nSystem.out.println(proxyObject.getClass());\n\n// out\n// class ...Requestable$$EnhancerByCGLIB$$9e62fc83\n// ProxyFactoryEnhancer, CGLIB, \"$Proxy0\"\n```\n\nSpring AOPAOPCGLIB, . , , `proxyTargetClass``true`, , .\n\n## ProxyFactory\n\n{% plantuml %}\nAdvisedSupport <.. AopProxyFactory: according to\ninterface AopProxyFactory {\n    AopProxy createAopProxy(AdvisedSupport config)\n}\nAopProxyFactory <|.. DefaultAopProxyFactory\n\nAopFactory <.. AopProxyFactory: create\ninterface AopFactory {\n    Object getProxy()\n    Object getProxy(ClassLoader classLoader)\n}\n\nAopFactory <|.. JdkDynamicProxy\n\nJdkDynamicProxy ..|> InvocationHandler\ninterface InvocationHandler {}\n\nAopFactory <|.. Cglib2AopProxy\n\n{% endplantuml%}\n\nAopProxyCglib2AopProxyJdkDynamicProxy. InvocationHandler, JdkDynamicProxyInvocationHandler.\n\nAopProxy, AopProxyFactory.\n```java\npublic interface AopProxyFactory {\n\n\t/**\n\t * Create an {@link AopProxy} for the given AOP configuration.\n\t * @param config the AOP configuration in the form of an\n\t * AdvisedSupport object\n\t * @return the corresponding AOP proxy\n\t * @throws AopConfigException if the configuration is invalid\n\t */\n\tAopProxy createAopProxy(AdvisedSupport config) throws AopConfigException;\n\n}\n\n```\nAopProxyFactory, DefaultAopProxyFactory, DefaultAopProxyFactoryCglib\n```java\nif(config.isOptimize || config.isProxyTargetClass() || ...) {\n    // Cglib2AopProxy, \n} else {\n    // JdkDynamicAopProxy, \n}\n```\n177, AOP.\n\n\n, , ? \n, , ? \n, , Class.forName(...).getConstructor()NoSuchMethodException?\n\n\n\n\n","slug":"spring-aop","published":1,"updated":"2021-12-30T03:04:35.728Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpz10015xotgg4ppd5tt","content":"<h1 id=\"AOP\"><a href=\"#AOP\" class=\"headerlink\" title=\"AOP\"></a>AOP</h1><p>, OOP, . , OOP. OOP, . AOP.</p>\n<ul>\n<li>AOP, AOP, AspectJ. , Aspect, , Aspect. , AspectJajcAspectJavaJava, JavaJava.</li>\n<li>AOP, AOP, JavaAspect, Spring AOP.</li>\n</ul>\n<h3 id=\"Joinpoint\"><a href=\"#Joinpoint\" class=\"headerlink\" title=\"Joinpoint\"></a>Joinpoint</h3><p> , , Joinpoint. , , , , , .</p>\n<h3 id=\"Pointcut\"><a href=\"#Pointcut\" class=\"headerlink\" title=\"Pointcut\"></a>Pointcut</h3><p> (Joinpoint). , Joinpoint, Joinpoint.</p>\n<h3 id=\"Advice\"><a href=\"#Advice\" class=\"headerlink\" title=\"Advice\"></a>Advice</h3><p> , Joinpoint. :</p>\n<ul>\n<li>Before Advice, JoinpointAdvice</li>\n<li>After Advice, Joinpoint, After returning Advice, Afterthrowing Advice</li>\n<li>Around Advice, , Interceptor. Before AdviceAfter Advice.</li>\n<li>Introduction<h3 id=\"Aspect\"><a href=\"#Aspect\" class=\"headerlink\" title=\"Aspect\"></a>Aspect</h3>AspectAOP.</li>\n</ul>\n<h1 id=\"Spring-AOP\"><a href=\"#Spring-AOP\" class=\"headerlink\" title=\"Spring AOP\"></a>Spring AOP</h1><p>AOP, Spring AOPSpringAOP. Spring, 20%AOP80%.</p>\n<h2 id=\"CGLIB-ASM\"><a href=\"#CGLIB-ASM\" class=\"headerlink\" title=\"CGLIB(ASM)\"></a>CGLIB(ASM)</h2><p> , , .<br> Spring AOP, InvocationHandler, , Advice. Advice.<br> , . Interface, Interface, .</p>\n<p> , , , , , , . CGLIB, .<br> <code>net.sf.cglib.proxy.MethodInterceptor</code>(net.sf.cglib.proxy.Callback):<br> <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Requestable</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">request</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;OK&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RequestCtrlInterceptor</span> <span class=\"keyword\">implements</span> <span class=\"title\">MethodInterceptor</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Log logger = LogFactory.getLog(RequestCtrlInterceptor.class);</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">intercept</span><span class=\"params\">(Object object, Method method, Object[] args, MethodProxy proxy)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(method.getName().equals(<span class=\"string\">&quot;request&quot;</span>)) &#123;</span><br><span class=\"line\">           TimeOfDay startTime = <span class=\"keyword\">new</span> TiemOfDay(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">           TimeOfDay endTime = <span class=\"keyword\">new</span> TiemOfDay(<span class=\"number\">5</span>, <span class=\"number\">59</span>, <span class=\"number\">59</span>);</span><br><span class=\"line\">           TiemOfDay currentTime = <span class=\"keyword\">new</span> TimeDay();</span><br><span class=\"line\">           <span class=\"keyword\">if</span>(currentTime.isAfter(startTime) &amp;&amp; currentTime.isBefore(endTime)) &#123;</span><br><span class=\"line\">               logger.warn(<span class=\"string\">&quot;Service is not available now.&quot;</span>);</span><br><span class=\"line\">               <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"keyword\">return</span> proxy.invokeSuper(object, args);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><br> , RequestCtrlInterceptorrequest(). CGLIBEnhance, RequestCtrlInterceptor, :<br> <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Enhancer enhancer = <span class=\"keyword\">new</span> Enhancer();</span><br><span class=\"line\">enhancer.setSuperclass(Requestable.class);</span><br><span class=\"line\">enhancer.setCallback(<span class=\"keyword\">new</span> RequestCtrlInterceptor());</span><br><span class=\"line\"></span><br><span class=\"line\">Requestable proxy = (Requestable) enhancer.create();</span><br><span class=\"line\">proxy.request();</span><br></pre></td></tr></table></figure><br> Enhancer, Spring AOP, Advisor</p>\n<h1 id=\"Spring-AOP-1\"><a href=\"#Spring-AOP-1\" class=\"headerlink\" title=\"Spring AOP\"></a>Spring AOP</h1><p>Joinpoint, Spring AOPJoinpoint, , (Method Execution)Joinpoint, :</p>\n<ul>\n<li>Spring AOP</li>\n<li>FieldJoinpoint, getter/setter</li>\n<li>, AspectJ(AspectJJoinpointAOP, )</li>\n</ul>\n<p>Pointcut, Spring AOPorg.springframework.aop.Pointcut</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Pointcut</span> </span>&#123;</span><br><span class=\"line\">    ClassFilter getClassFilter;</span><br><span class=\"line\">    MethodMatcher getMethodMatcher;</span><br><span class=\"line\">    Pointcut TRUE = TruePointcut.INSTANCE;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>, , </p>\n<p>Advice, AdvicePointcutJoinpoint. Advice, Around Advice.<br>SrpingAround Advice, AOP Alliance, : <code>org.aopalliance.intercept.MethodInterceptor</code>, : </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.aopalliance.intercept;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Intercepts calls on an interface on its way to the target. These</span></span><br><span class=\"line\"><span class=\"comment\"> * are nested &quot;on top&quot; of the target.</span></span><br><span class=\"line\"><span class=\"comment\"> * ...</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@FunctionalInterface</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">MethodInterceptor</span> <span class=\"keyword\">extends</span> <span class=\"title\">Interceptor</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Implement this method to perform extra treatments before and</span></span><br><span class=\"line\"><span class=\"comment\">\t * after the invocation. Polite implementations would certainly</span></span><br><span class=\"line\"><span class=\"comment\">\t * like to invoke &#123;<span class=\"doctag\">@link</span> Joinpoint#proceed()&#125;.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> invocation the method invocation joinpoint</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> the result of the call to &#123;<span class=\"doctag\">@link</span> Joinpoint#proceed()&#125;;</span></span><br><span class=\"line\"><span class=\"comment\">\t * might be intercepted by the interceptor</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@throws</span> Throwable if the interceptors or the target object</span></span><br><span class=\"line\"><span class=\"comment\">\t * throws an exception</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\">Object <span class=\"title\">invoke</span><span class=\"params\">(MethodInvocation invocation)</span> <span class=\"keyword\">throws</span> Throwable</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Advice, , Around Advice, : ///.</p>\n<p>: , , 8, .</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DiscountMethodInterceptor</span> <span class=\"keyword\">implements</span> <span class=\"title\">MethodInterceptor</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Integer DEFAULT_DISCOUNT_RATIO = <span class=\"number\">80</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span> <span class=\"params\">(MethodInvocation invocation)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        Object returnValue = invocation.proceed();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ((Integer) returnValue) * DEFAULT_DISCOUNT_RATIO / <span class=\"number\">100</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>MethodInvocationinvokeMethodInvocation, Joinpoint. MethodInvocationproceed(), , . MethodInterceptorproceed(),MethodInterceptor.</p>\n</blockquote>\n<p>Spring, AdvicePOJO, , IoC, :</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;discountInterceptor&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;...DiscountMethodInterceptor&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>MethodInterceptor, ?**<a href=\"/2021/11/02/java-chain-of-responsibility/\" title=\"\"></a>**</p>\n<h1 id=\"SpringAOP\"><a href=\"#SpringAOP\" class=\"headerlink\" title=\"SpringAOP\"></a>SpringAOP</h1><p>AspectJajc, SpringAOP<code>org.springframework.aop.ProxyFactory</code>, Spring AOP.</p>\n<p>: <strong>Spring AIOAOP, , </strong>. ProxyFactory.</p>\n<p>ProxyFactory, , Aspect(SpringAdvisor). Advisor, Advice, :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ProxyFactory weaver = <span class=\"keyword\">new</span> ProxyFactory(<span class=\"keyword\">new</span> Executable());</span><br><span class=\"line\">NameMatchMethodPointcutAdvisor advisor = <span class=\"keyword\">new</span> NameMathMethodPointcutAdvisor();</span><br><span class=\"line\">advisor.setMappedName(<span class=\"string\">&quot;request&quot;</span>);</span><br><span class=\"line\">advisor.setAdvice(<span class=\"keyword\">new</span> RequestCtrlInterceptor());</span><br><span class=\"line\">weaver.addAdvisor(advisor);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">weaver.setProxyTargetClass(<span class=\"keyword\">true</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Requestable proxyObject = (Requestable) weaver.getProxy();</span><br><span class=\"line\">proxyObject.request();</span><br><span class=\"line\">System.out.println(proxyObject.getClass());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// out</span></span><br><span class=\"line\"><span class=\"comment\">// class ...Requestable$$EnhancerByCGLIB$$9e62fc83</span></span><br><span class=\"line\"><span class=\"comment\">// ProxyFactoryEnhancer, CGLIB, &quot;$Proxy0&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>Spring AOPAOPCGLIB, . , , <code>proxyTargetClass</code><code>true</code>, , .</p>\n<h2 id=\"ProxyFactory\"><a href=\"#ProxyFactory\" class=\"headerlink\" title=\"ProxyFactory\"></a>ProxyFactory</h2><p></p>\n<img  src=http://www.plantuml.com/plantuml/svg/RO_12i8m44Jl-OezwgK7Zo92KKH5KF0BrissH6ksfAjOr7_NAbLRcrCoCzbv6zkpAzXkJtakGM4KHH1BlWboAMT8Ag4S0X99iCwde6ASLmu94hTpS3NmFBKA51YLwsSlRXQH-CIbVNCtxJ6ZsvDXoWcUCcrvfWf_Sbsexz8cP9DllTipAQIiRwv-fph9i2XMWfO3qFTUyJOOAjQbFKnBZqT7hx_6j0I8ejiO5luiXEh4pz7RZCCFv9y7ruwUIPgvtQ1UsJm0>\n\n<p>AopProxyCglib2AopProxyJdkDynamicProxy. InvocationHandler, JdkDynamicProxyInvocationHandler.</p>\n<p>AopProxy, AopProxyFactory.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">AopProxyFactory</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Create an &#123;<span class=\"doctag\">@link</span> AopProxy&#125; for the given AOP configuration.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> config the AOP configuration in the form of an</span></span><br><span class=\"line\"><span class=\"comment\">\t * AdvisedSupport object</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> the corresponding AOP proxy</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@throws</span> AopConfigException if the configuration is invalid</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\">AopProxy <span class=\"title\">createAopProxy</span><span class=\"params\">(AdvisedSupport config)</span> <span class=\"keyword\">throws</span> AopConfigException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>AopProxyFactory, DefaultAopProxyFactory, DefaultAopProxyFactoryCglib</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(config.isOptimize || config.isProxyTargetClass() || ...) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Cglib2AopProxy, </span></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// JdkDynamicAopProxy, </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>177, AOP.</p>\n<p>, , ? <br>, , ?<br>, , Class.forName().getConstructor()NoSuchMethodException?</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"AOP\"><a href=\"#AOP\" class=\"headerlink\" title=\"AOP\"></a>AOP</h1><p>, OOP, . , OOP. OOP, . AOP.</p>\n<ul>\n<li>AOP, AOP, AspectJ. , Aspect, , Aspect. , AspectJajcAspectJavaJava, JavaJava.</li>\n<li>AOP, AOP, JavaAspect, Spring AOP.</li>\n</ul>\n<h3 id=\"Joinpoint\"><a href=\"#Joinpoint\" class=\"headerlink\" title=\"Joinpoint\"></a>Joinpoint</h3><p> , , Joinpoint. , , , , , .</p>\n<h3 id=\"Pointcut\"><a href=\"#Pointcut\" class=\"headerlink\" title=\"Pointcut\"></a>Pointcut</h3><p> (Joinpoint). , Joinpoint, Joinpoint.</p>\n<h3 id=\"Advice\"><a href=\"#Advice\" class=\"headerlink\" title=\"Advice\"></a>Advice</h3><p> , Joinpoint. :</p>\n<ul>\n<li>Before Advice, JoinpointAdvice</li>\n<li>After Advice, Joinpoint, After returning Advice, Afterthrowing Advice</li>\n<li>Around Advice, , Interceptor. Before AdviceAfter Advice.</li>\n<li>Introduction<h3 id=\"Aspect\"><a href=\"#Aspect\" class=\"headerlink\" title=\"Aspect\"></a>Aspect</h3>AspectAOP.</li>\n</ul>\n<h1 id=\"Spring-AOP\"><a href=\"#Spring-AOP\" class=\"headerlink\" title=\"Spring AOP\"></a>Spring AOP</h1><p>AOP, Spring AOPSpringAOP. Spring, 20%AOP80%.</p>\n<h2 id=\"CGLIB-ASM\"><a href=\"#CGLIB-ASM\" class=\"headerlink\" title=\"CGLIB(ASM)\"></a>CGLIB(ASM)</h2><p> , , .<br> Spring AOP, InvocationHandler, , Advice. Advice.<br> , . Interface, Interface, .</p>\n<p> , , , , , , . CGLIB, .<br> <code>net.sf.cglib.proxy.MethodInterceptor</code>(net.sf.cglib.proxy.Callback):<br> <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Requestable</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">request</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;OK&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RequestCtrlInterceptor</span> <span class=\"keyword\">implements</span> <span class=\"title\">MethodInterceptor</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Log logger = LogFactory.getLog(RequestCtrlInterceptor.class);</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">intercept</span><span class=\"params\">(Object object, Method method, Object[] args, MethodProxy proxy)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(method.getName().equals(<span class=\"string\">&quot;request&quot;</span>)) &#123;</span><br><span class=\"line\">           TimeOfDay startTime = <span class=\"keyword\">new</span> TiemOfDay(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">           TimeOfDay endTime = <span class=\"keyword\">new</span> TiemOfDay(<span class=\"number\">5</span>, <span class=\"number\">59</span>, <span class=\"number\">59</span>);</span><br><span class=\"line\">           TiemOfDay currentTime = <span class=\"keyword\">new</span> TimeDay();</span><br><span class=\"line\">           <span class=\"keyword\">if</span>(currentTime.isAfter(startTime) &amp;&amp; currentTime.isBefore(endTime)) &#123;</span><br><span class=\"line\">               logger.warn(<span class=\"string\">&quot;Service is not available now.&quot;</span>);</span><br><span class=\"line\">               <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"keyword\">return</span> proxy.invokeSuper(object, args);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><br> , RequestCtrlInterceptorrequest(). CGLIBEnhance, RequestCtrlInterceptor, :<br> <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Enhancer enhancer = <span class=\"keyword\">new</span> Enhancer();</span><br><span class=\"line\">enhancer.setSuperclass(Requestable.class);</span><br><span class=\"line\">enhancer.setCallback(<span class=\"keyword\">new</span> RequestCtrlInterceptor());</span><br><span class=\"line\"></span><br><span class=\"line\">Requestable proxy = (Requestable) enhancer.create();</span><br><span class=\"line\">proxy.request();</span><br></pre></td></tr></table></figure><br> Enhancer, Spring AOP, Advisor</p>\n<h1 id=\"Spring-AOP-1\"><a href=\"#Spring-AOP-1\" class=\"headerlink\" title=\"Spring AOP\"></a>Spring AOP</h1><p>Joinpoint, Spring AOPJoinpoint, , (Method Execution)Joinpoint, :</p>\n<ul>\n<li>Spring AOP</li>\n<li>FieldJoinpoint, getter/setter</li>\n<li>, AspectJ(AspectJJoinpointAOP, )</li>\n</ul>\n<p>Pointcut, Spring AOPorg.springframework.aop.Pointcut</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Pointcut</span> </span>&#123;</span><br><span class=\"line\">    ClassFilter getClassFilter;</span><br><span class=\"line\">    MethodMatcher getMethodMatcher;</span><br><span class=\"line\">    Pointcut TRUE = TruePointcut.INSTANCE;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>, , </p>\n<p>Advice, AdvicePointcutJoinpoint. Advice, Around Advice.<br>SrpingAround Advice, AOP Alliance, : <code>org.aopalliance.intercept.MethodInterceptor</code>, : </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.aopalliance.intercept;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Intercepts calls on an interface on its way to the target. These</span></span><br><span class=\"line\"><span class=\"comment\"> * are nested &quot;on top&quot; of the target.</span></span><br><span class=\"line\"><span class=\"comment\"> * ...</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@FunctionalInterface</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">MethodInterceptor</span> <span class=\"keyword\">extends</span> <span class=\"title\">Interceptor</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Implement this method to perform extra treatments before and</span></span><br><span class=\"line\"><span class=\"comment\">\t * after the invocation. Polite implementations would certainly</span></span><br><span class=\"line\"><span class=\"comment\">\t * like to invoke &#123;<span class=\"doctag\">@link</span> Joinpoint#proceed()&#125;.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> invocation the method invocation joinpoint</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> the result of the call to &#123;<span class=\"doctag\">@link</span> Joinpoint#proceed()&#125;;</span></span><br><span class=\"line\"><span class=\"comment\">\t * might be intercepted by the interceptor</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@throws</span> Throwable if the interceptors or the target object</span></span><br><span class=\"line\"><span class=\"comment\">\t * throws an exception</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\">Object <span class=\"title\">invoke</span><span class=\"params\">(MethodInvocation invocation)</span> <span class=\"keyword\">throws</span> Throwable</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Advice, , Around Advice, : ///.</p>\n<p>: , , 8, .</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DiscountMethodInterceptor</span> <span class=\"keyword\">implements</span> <span class=\"title\">MethodInterceptor</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Integer DEFAULT_DISCOUNT_RATIO = <span class=\"number\">80</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span> <span class=\"params\">(MethodInvocation invocation)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        Object returnValue = invocation.proceed();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ((Integer) returnValue) * DEFAULT_DISCOUNT_RATIO / <span class=\"number\">100</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>MethodInvocationinvokeMethodInvocation, Joinpoint. MethodInvocationproceed(), , . MethodInterceptorproceed(),MethodInterceptor.</p>\n</blockquote>\n<p>Spring, AdvicePOJO, , IoC, :</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;discountInterceptor&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;...DiscountMethodInterceptor&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>MethodInterceptor, ?**<a href=\"/2021/11/02/java-chain-of-responsibility/\" title=\"\"></a>**</p>\n<h1 id=\"SpringAOP\"><a href=\"#SpringAOP\" class=\"headerlink\" title=\"SpringAOP\"></a>SpringAOP</h1><p>AspectJajc, SpringAOP<code>org.springframework.aop.ProxyFactory</code>, Spring AOP.</p>\n<p>: <strong>Spring AIOAOP, , </strong>. ProxyFactory.</p>\n<p>ProxyFactory, , Aspect(SpringAdvisor). Advisor, Advice, :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ProxyFactory weaver = <span class=\"keyword\">new</span> ProxyFactory(<span class=\"keyword\">new</span> Executable());</span><br><span class=\"line\">NameMatchMethodPointcutAdvisor advisor = <span class=\"keyword\">new</span> NameMathMethodPointcutAdvisor();</span><br><span class=\"line\">advisor.setMappedName(<span class=\"string\">&quot;request&quot;</span>);</span><br><span class=\"line\">advisor.setAdvice(<span class=\"keyword\">new</span> RequestCtrlInterceptor());</span><br><span class=\"line\">weaver.addAdvisor(advisor);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">weaver.setProxyTargetClass(<span class=\"keyword\">true</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Requestable proxyObject = (Requestable) weaver.getProxy();</span><br><span class=\"line\">proxyObject.request();</span><br><span class=\"line\">System.out.println(proxyObject.getClass());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// out</span></span><br><span class=\"line\"><span class=\"comment\">// class ...Requestable$$EnhancerByCGLIB$$9e62fc83</span></span><br><span class=\"line\"><span class=\"comment\">// ProxyFactoryEnhancer, CGLIB, &quot;$Proxy0&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>Spring AOPAOPCGLIB, . , , <code>proxyTargetClass</code><code>true</code>, , .</p>\n<h2 id=\"ProxyFactory\"><a href=\"#ProxyFactory\" class=\"headerlink\" title=\"ProxyFactory\"></a>ProxyFactory</h2><p></p>\n<img  src=http://www.plantuml.com/plantuml/svg/RO_12i8m44Jl-OezwgK7Zo92KKH5KF0BrissH6ksfAjOr7_NAbLRcrCoCzbv6zkpAzXkJtakGM4KHH1BlWboAMT8Ag4S0X99iCwde6ASLmu94hTpS3NmFBKA51YLwsSlRXQH-CIbVNCtxJ6ZsvDXoWcUCcrvfWf_Sbsexz8cP9DllTipAQIiRwv-fph9i2XMWfO3qFTUyJOOAjQbFKnBZqT7hx_6j0I8ejiO5luiXEh4pz7RZCCFv9y7ruwUIPgvtQ1UsJm0>\n\n<p>AopProxyCglib2AopProxyJdkDynamicProxy. InvocationHandler, JdkDynamicProxyInvocationHandler.</p>\n<p>AopProxy, AopProxyFactory.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">AopProxyFactory</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Create an &#123;<span class=\"doctag\">@link</span> AopProxy&#125; for the given AOP configuration.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> config the AOP configuration in the form of an</span></span><br><span class=\"line\"><span class=\"comment\">\t * AdvisedSupport object</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> the corresponding AOP proxy</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@throws</span> AopConfigException if the configuration is invalid</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\">AopProxy <span class=\"title\">createAopProxy</span><span class=\"params\">(AdvisedSupport config)</span> <span class=\"keyword\">throws</span> AopConfigException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>AopProxyFactory, DefaultAopProxyFactory, DefaultAopProxyFactoryCglib</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(config.isOptimize || config.isProxyTargetClass() || ...) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Cglib2AopProxy, </span></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// JdkDynamicAopProxy, </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>177, AOP.</p>\n<p>, , ? <br>, , ?<br>, , Class.forName().getConstructor()NoSuchMethodException?</p>\n"},{"title":"Spring Boot","date":"2021-11-01T01:54:27.000Z","_content":"\nSpring Frameworks @Conditional annotation is the core of Autoconfigurations.\n, @Configuration. @Conditional. , @ConditionalOnClass@ConditionalOnMissingBean. , , @Configuration.\n\n# \n, Spring Framework, 80%. , ApplicationContextConfiguration, Bean.\n```java\n@Configuration\npublic class SharedContextConfiguration { // (1)\n\n    @Bean\n    public Driver neo4jDriver(Neo4jProperties properties, ...) {\n        return GraphDatabase.driver(...);\n    }\n\n}\n```\n\nSharedConfiguration, maven. @Configuration@Import(...Configuration.class)\n```java\n@Configuration\n@Import(SharedConfiguration.class) // (1)\npublic class OtherProjectContextConfiguration {\n\n   // you would specify your project-specific beans here, as normal.\n}\n```\n\n:\nSharedConfigurationBean, Neo4jBean, , Bean?\n\n@Conditional.\n\n# @Conditional\n@Conditional\"\"@Bean Method, @Components@Configuration. `@Target({ElementType.TYPE,ElementType.METHOD})`, @ConditionalOnClass, @ConditionalOnBean, @ConditionalOnMissBean.\n```java\n@Target({ ElementType.TYPE, ElementType.METHOD })\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Conditional(OnClassCondition.class)\npublic @interface ConditionalOnClass {\n\n\t/**\n\t * The classes that must be present. Since this annotation is parsed by loading class\n\t * bytecode, it is safe to specify classes here that may ultimately not be on the\n\t * classpath, only if this annotation is directly on the affected component and\n\t * <b>not</b> if this annotation is used as a composed, meta-annotation. In order to\n\t * use this annotation as a meta-annotation, only use the {@link #name} attribute.\n\t * @return the classes that must be present\n\t */\n\tClass<?>[] value() default {};\n\n\t/**\n\t * The classes names that must be present.\n\t * @return the class names that must be present.\n\t */\n\tString[] name() default {};\n\n}\n```\n@Conditional(, ), @Conditional\"Condition\", matches(SpringBootCondition), Boolean\n - True: (Further Evaluate/Register) Create that @Bean, @Component or @Configuration\n - False: (Stop Evaluating/Registering) Dont create that @Bean, @Component or @Configuration\n:\n{% plantuml %}\n    FilteringSpringBootCondition <|-- OnClassCondition\n    SpringBootCondition <|-- FilteringSpringBootCondition\n    Condition <|.. SpringBootCondition\n    interface Condition {\n        boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata);\n    }\n{% endplantuml %}\n\nCondition:\n```java\n\n/**\n * A single {@code condition} that must be {@linkplain #matches matched} in order\n * for a component to be registered.\n *\n * <p>Conditions are checked immediately before the bean-definition is due to be\n * registered and are free to veto registration based on any criteria that can\n * be determined at that point.\n *\n * <p>Conditions must follow the same restrictions as {@link BeanFactoryPostProcessor}\n * and take care to never interact with bean instances. For more fine-grained control\n * of conditions that interact with {@code @Configuration} beans consider implementing\n * the {@link ConfigurationCondition} interface.\n *\n * @author Phillip Webb\n * @since 4.0\n * @see ConfigurationCondition\n * @see Conditional\n * @see ConditionContext\n */\n@FunctionalInterface\npublic interface Condition {\n\n\t/**\n\t * Determine if the condition matches.\n\t * @param context the condition context\n\t * @param metadata the metadata of the {@link org.springframework.core.type.AnnotationMetadata class}\n\t * or {@link org.springframework.core.type.MethodMetadata method} being checked\n\t * @return {@code true} if the condition matches and the component can be registered,\n\t * or {@code false} to veto the annotated component's registration\n\t */\n\tboolean matches(ConditionContext context, AnnotatedTypeMetadata metadata);\n\n}\n```\n\n:\n{% blockquote %}\nIn short: Even though an ApplicationContextConfiguration comes with certain @Bean definitions, you as the end-user can still somewhat influence if a bean gets created or not.\n{% endblockquote %}\nApplicationContextConfiguration@Bean, Bean.\n\n\n## @Conditional\nApplicationContextConfiguration\n```java\n@Configuration\npublic class SharedConfiguration {\n    @Bean\n    @Conditional(IsRequiredNeo4jDatabaseCondition.class)\n    public Driver neo4jDriver(Neo4jProperties properties, ...) {\n        return GraphDatabase.driver(...);\n    }\n}\n```\nCondition:\n```java\nimport org.springframework.context.annotation.Condition;\nimport org.springframework.context.annotation.ConditionContext;\nimport org.springframework.core.type.AnnotatedTypeMetadata;\n\npublic class IsRequiredNeo4jDatabaseCondition implements Condition {\n    @Override\n    public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata){\n        return neo4jDriverOnClassPath() && databaseUrlSet(context); // [1]\n    }\n    private boolean databaseUrlSet(ConditioContext context) {\n        return context.getEnvironment().containsPreperty(\"spring.data.neo4j.uri\");\n    }\n    private boolean neo4jDriverOnClassPath() {\n        try {\n            Class.forName(\"org.neo4j.driver.Driver\");\n            return true;\n        } catch (ClassNotFoundException e) {\n            return false;\n        }\n    }\n}\n```\n[1], properties, neo4jDriver(classpath).\n> : Neo4j.\n\nmatchCondition:\n - create @Beans depending on specific **available properties**.\n - create @Beans depending on specific **libraries on your classpath**.\n\n, ,\n - Conditionals that create a DataSource for you, because you have set specific properties (think: spring.data.neo4j.uri)? \n - Or @Conditionals that boot up an embedded Tomcat server for you because you have the Tomcat libraries on your classpath?\nThe Answer is YES, that (and not much more) is exactly what Spring Boot is. \n\n# Spring Boot Autoconfigurations: Three Internal Core Features\n## PropertySources\nSpring Boot, :\n{% blockquote Spring Boot docs%}\n1. Default properties (specified by setting SpringApplication.setDefaultProperties).\n2. `@PropertySource` annotations on your @Configuration classes. Please note that such property sources are not added to the Environment until the application context is being refreshed. This is too late to configure certain properties such as logging.* and spring.main.* which are read before refresh begins.\n3. Config data (such as application.properties files)\n4. A RandomValuePropertySource that has properties only in random.*.\n5. OS environment variables.\n6. Java System properties (System.getProperties()).\n7. JNDI attributes from java:comp/env.\n8. ServletContext init parameters.\n9. ServletConfig init parameters.\n10. Properties from SPRING_APPLICATION_JSON (inline JSON embedded in an environment variable or system property).\n11. Command line arguments.\n12. properties attribute on your tests. Available on @SpringBootTest and the test annotations for testing a particular slice of your application.\n13. @TestPropertySource annotations on your tests.\n14. Devtools global settings properties in the $HOME/.config/spring-boot directory when devtools is active.\n{% endblockquote %}\nSpring Boot, Property.\n\n, `@PropertySource`, `@PropertySource``.properties`\n```java\n@PropertySource(value = \"classpath:application.properties\", ignoreResourceNotFound = true)\n```\nSpringBootmain, SpringBoot14PropertySource(17, 2.5.6), .\n\n> : Spring Bootbean\n> 1. @Value\n> 2. @ConfigurationProperties\n\n\n## Read-in META-INF/spring.factories\nSpringBoot, `org.springframework.boot:spring-boot-autoconfigure`, jarmagic. `META-INF/spring.factories`.\n```\n# Auto Configure\norg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\norg.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\\\norg.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\\\norg.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\\\norg.springframework.boot.autoconfigure.batch.BatchAutoConfiguration,\\\n// ...\n// 100+ more lines\n```\n, EnableAutoConfiguration, 100. @Configurations@Conditionals, Spring BootCondition.\n\n## Enhanced Conditional Support\n@Conditional, , \"\", :\n - @ConditionalOnClass(DataSource.class). The condition is true if the DataSource class is on the classpath.\n - @ConditionalOnMissingClass(DataSource.class). The condition is true if the DataSource class is not on the classpath.\n - @ConditionalOnMissingBean(DataSource.class). The condition is true if the user did not specify a DataSource @Bean in any @Configuration.\n - @ConditionalOnWebApplication. The condition is true if the application is a web application.\n - @ConditionalOnProperty(\"my.property\"). The condition is true if my.property is set.\n - @ConditionalOnResource(\"classpath:my.properties\"). The condition is true if my.properties exists.\n - // e.g.\n, .\n\n@Conditional:\n - Class Conditions\n - Bean Conditions\n - Property Conditions\n - Resource Conditions\n - Web Application Conditions\n - SpEL Expression Conditions\n\n### Class Conditions\n@ConditionalOnClass@ConditionalOnMissingClass, classclasspath, Bean. \n> **The fact is that annotation metadata is parsed by using ASM.**\nConditional, `value``name`, `value`class, application classpath.\n\n### Bean Conditions\nConditional @Conditional that only matches when no beans meeting the specified\nrequirements are already contained in the `BeanFactory`.\n\nWhen placed on a `@Bean` method, the bean class defaults to the return type of\nthe factory method:\n```java\n@Configuration\npublic class MyAutoConfiguration {\n    @Bean\n    @ConditionalOnMissingBean\n    // @ConditionalOnMissingBean, method, : @ConditionalOnMissingBean(MyService.class)\n    public MyService myService() {\n        ...\n    }\n}\n```\nIn the sample above the condition will match if no bean of type {@code MyService} is\nalready contained in the {@link BeanFactory}.\n\n#### Property Conditions...\n\n\n## AutoConfiguration\n```java\npublic class MyService {\n\n  private String name;\n\n  public MyService(String name) {\n    this.name = name;\n  }\n\n  public MyService() {}\n\n  public String getName() {\n    return this.name;\n  }\n}\n```\n\n```java\nimport org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n@Configuration(proxyBeanMethods = false)\npublic class MyServiceAutoConfiguration {\n\n  @Bean\n  @ConditionalOnMissingBean // equivalent to @ConditionalOnMissingBean(MyService.class)\n  public MyService myService() {\n    // When MyService(bean type) doesn't exist, this bean will create.\n    return new MyService(\"test123\");\n  }\n}\n```\n\nAutoConfigurationApplicationContextRunner, ApplicationContextRunner is usually defined as field of the \"test class\" to gather the base, common configuration.\n```java\nimport com.example.multimodule.service.auto.MyService;\nimport com.example.multimodule.service.auto.MyServiceAutoConfiguration;\nimport org.junit.jupiter.api.Test;\nimport org.springframework.boot.autoconfigure.AutoConfigurations;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.boot.test.context.runner.ApplicationContextRunner;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\nimport static org.assertj.core.api.Assertions.assertThat;\n\n@SpringBootTest\npublic class TestAutoConfiguration {\n  // load MyServiceAutoConfiguration.class\n  private final ApplicationContextRunner contextRunner =\n      new ApplicationContextRunner()\n          .withConfiguration(AutoConfigurations.of(MyServiceAutoConfiguration.class));\n\n  @Configuration(proxyBeanMethods = false)\n  static class UserConfiguration {\n    @Bean\n    MyService myCustomService() {\n      // This bean is always created.\n      return new MyService(\"mine\");\n    }\n  }\n\n  @Test\n  void conditionEffectedTest() {\n    // @ConditionalOnMissingBean effect\n    this.contextRunner.run(\n        (context) -> {\n          assertThat(context).getBean(\"myService\");\n          assertThat(context).hasSingleBean(MyService.class);\n          assertThat(context.getBean(MyService.class).getName()).isEqualTo(\"test123\");\n        });\n  }\n\n  @Test\n  void conditionNotEffectedTest() {\n    // @ConditionalOnMissingBean effect\n    this.contextRunner\n        .withUserConfiguration(UserConfiguration.class) // add UserConfiguration into context.\n        .run(\n            (context -> {\n              assertThat(context).hasSingleBean(MyService.class);\n              assertThat(context)\n                  .getBean(\"myCustomService\")\n                  .isSameAs(context.getBean(MyService.class));\n              assertThat(context.getBean(MyService.class).getName()).isEqualTo(\"mine\");\n            }));\n  }\n}\n```\n, ApplicationContextMyServiceAutoConfiguration, Bean`myService`, MyServiceAutoConfigurationUserConfigurationBean`myCustomService`, @ConditionalOnMissingBean.\n\nAutoconfigurationConditional: https://www.baeldung.com/spring-boot-context-runner\n\n# starter\na custom starter can contain the following:\n\n - The autoconfigure module that contains the auto-configuration code for \"acme\".\n\n - The starter module that provides a dependency to the autoconfigure module as well as \"acme\" and any additional dependencies that are typically useful. In a nutshell, adding the starter should provide everything needed to start using that library.\n\n#### Naming\nYou should make sure to provide a proper namespace for your starter. Do not start your module names with spring-boot\n#### Configuration keys\nIf your starter provides configuration keys, use a unique namespace for them. In particular, do not include your keys in the namespaces that Spring Boot uses (such as server, management, spring, and so on). \n```java\nimport java.time.Duration;\n\nimport org.springframework.boot.context.properties.ConfigurationProperties;\n\n@ConfigurationProperties(\"acme\")\npublic class AcmeProperties {\n\n    /**\n     * Whether to check the location of acme resources.\n     */\n    private boolean checkLocation = true;\n\n    /**\n     * Timeout for establishing a connection to the acme server.\n     */\n    private Duration loginTimeout = Duration.ofSeconds(3);\n\n    public boolean isCheckLocation() {\n        return this.checkLocation;\n    }\n\n    public void setCheckLocation(boolean checkLocation) {\n        this.checkLocation = checkLocation;\n    }\n\n    public Duration getLoginTimeout() {\n        return this.loginTimeout;\n    }\n\n    public void setLoginTimeout(Duration loginTimeout) {\n        this.loginTimeout = loginTimeout;\n    }\n\n}\n```\nHere are some rules we follow internally to make sure descriptions are consistent:\n - Do not start the description by \"The\" or \"A\".\n - For boolean types, start the description with \"Whether\" or \"Enable\".\n - For collection-based types, start the description with \"Comma-separated list\"\n - Use java.time.Duration rather than long and describe the default unit if it differs from milliseconds, such as \"If a duration suffix is not specified, seconds will be used\".\n - Do not provide the default value in the description unless it has to be determined at runtime.\n\n> Make sure to trigger meta-data generation so that IDE assistance is available for your keys as well. You may want to review the generated metadata (META-INF/spring-configuration-metadata.json) to make sure your keys are properly documented. Using your own starter in a compatible IDE is also a good idea to validate that quality of the metadata.\n\n## The \"autoconfigure\" module\n The `autoconfigure` module contains everything that is necessary to get started with the library. It may also contain configuration key definitions (such as @ConfigurationProperties) and any callback interface that can be used to further customize how the components are initialized.\n\nSpring Boot uses an annotation processor to collect the conditions on auto-configurations in a metadata file (`META-INF/spring-autoconfigure-metadata.properties`). If that file is present, it is used to eagerly filter auto-configurations that do not match, which will improve startup time. It is recommended to add the following dependency in a module that contains auto-configurations:\n```gradle\ndependencies {\n    compileOnly \"org.springframework.boot:spring-boot-autoconfigure-processor\"\n}\n```\n\n## Starter module\nThe starter is really an empty jar. Its only purpose is to provide the necessary dependencies to work with the library. You can think of it as an opinionated view of what is required to get started.\n\nDo not make assumptions about the project in which your starter is added. If the library you are auto-configuring typically requires other starters, mention them as well. Providing a proper set of *default* dependencies may be hard if the number of optional dependencies is high, as you should avoid including dependencies that are unnecessary for a typical usage of the library. In other words, you should not include optional dependencies.\n\n> NOTE: Either way, your starter must reference the core Spring Boot starter (spring-boot-starter) directly or indirectly (there is no need to add it if your starter relies on another starter). If a project is created with only your custom starter, Spring Boots core features will be honoured by the presence of the core starter.\n\n, starter, spring boot, `E:\\SpringProjects\\PracticeProjects\\spring-boot-practice-auto-configuration`, `E:\\SpringProjects\\PracticeProjects\\spring-boot-master-auto-configuration`git log. `spring-boot-master-auto-configuration``hornetq``redis`, redis.\n","source":"_posts/spring-autoconfigurations.md","raw":"---\ntitle: Spring Boot\ndate: 2021-11-01 09:54:27\ncategories: \n- Spring\n---\n\nSpring Frameworks @Conditional annotation is the core of Autoconfigurations.\n, @Configuration. @Conditional. , @ConditionalOnClass@ConditionalOnMissingBean. , , @Configuration.\n\n# \n, Spring Framework, 80%. , ApplicationContextConfiguration, Bean.\n```java\n@Configuration\npublic class SharedContextConfiguration { // (1)\n\n    @Bean\n    public Driver neo4jDriver(Neo4jProperties properties, ...) {\n        return GraphDatabase.driver(...);\n    }\n\n}\n```\n\nSharedConfiguration, maven. @Configuration@Import(...Configuration.class)\n```java\n@Configuration\n@Import(SharedConfiguration.class) // (1)\npublic class OtherProjectContextConfiguration {\n\n   // you would specify your project-specific beans here, as normal.\n}\n```\n\n:\nSharedConfigurationBean, Neo4jBean, , Bean?\n\n@Conditional.\n\n# @Conditional\n@Conditional\"\"@Bean Method, @Components@Configuration. `@Target({ElementType.TYPE,ElementType.METHOD})`, @ConditionalOnClass, @ConditionalOnBean, @ConditionalOnMissBean.\n```java\n@Target({ ElementType.TYPE, ElementType.METHOD })\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Conditional(OnClassCondition.class)\npublic @interface ConditionalOnClass {\n\n\t/**\n\t * The classes that must be present. Since this annotation is parsed by loading class\n\t * bytecode, it is safe to specify classes here that may ultimately not be on the\n\t * classpath, only if this annotation is directly on the affected component and\n\t * <b>not</b> if this annotation is used as a composed, meta-annotation. In order to\n\t * use this annotation as a meta-annotation, only use the {@link #name} attribute.\n\t * @return the classes that must be present\n\t */\n\tClass<?>[] value() default {};\n\n\t/**\n\t * The classes names that must be present.\n\t * @return the class names that must be present.\n\t */\n\tString[] name() default {};\n\n}\n```\n@Conditional(, ), @Conditional\"Condition\", matches(SpringBootCondition), Boolean\n - True: (Further Evaluate/Register) Create that @Bean, @Component or @Configuration\n - False: (Stop Evaluating/Registering) Dont create that @Bean, @Component or @Configuration\n:\n{% plantuml %}\n    FilteringSpringBootCondition <|-- OnClassCondition\n    SpringBootCondition <|-- FilteringSpringBootCondition\n    Condition <|.. SpringBootCondition\n    interface Condition {\n        boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata);\n    }\n{% endplantuml %}\n\nCondition:\n```java\n\n/**\n * A single {@code condition} that must be {@linkplain #matches matched} in order\n * for a component to be registered.\n *\n * <p>Conditions are checked immediately before the bean-definition is due to be\n * registered and are free to veto registration based on any criteria that can\n * be determined at that point.\n *\n * <p>Conditions must follow the same restrictions as {@link BeanFactoryPostProcessor}\n * and take care to never interact with bean instances. For more fine-grained control\n * of conditions that interact with {@code @Configuration} beans consider implementing\n * the {@link ConfigurationCondition} interface.\n *\n * @author Phillip Webb\n * @since 4.0\n * @see ConfigurationCondition\n * @see Conditional\n * @see ConditionContext\n */\n@FunctionalInterface\npublic interface Condition {\n\n\t/**\n\t * Determine if the condition matches.\n\t * @param context the condition context\n\t * @param metadata the metadata of the {@link org.springframework.core.type.AnnotationMetadata class}\n\t * or {@link org.springframework.core.type.MethodMetadata method} being checked\n\t * @return {@code true} if the condition matches and the component can be registered,\n\t * or {@code false} to veto the annotated component's registration\n\t */\n\tboolean matches(ConditionContext context, AnnotatedTypeMetadata metadata);\n\n}\n```\n\n:\n{% blockquote %}\nIn short: Even though an ApplicationContextConfiguration comes with certain @Bean definitions, you as the end-user can still somewhat influence if a bean gets created or not.\n{% endblockquote %}\nApplicationContextConfiguration@Bean, Bean.\n\n\n## @Conditional\nApplicationContextConfiguration\n```java\n@Configuration\npublic class SharedConfiguration {\n    @Bean\n    @Conditional(IsRequiredNeo4jDatabaseCondition.class)\n    public Driver neo4jDriver(Neo4jProperties properties, ...) {\n        return GraphDatabase.driver(...);\n    }\n}\n```\nCondition:\n```java\nimport org.springframework.context.annotation.Condition;\nimport org.springframework.context.annotation.ConditionContext;\nimport org.springframework.core.type.AnnotatedTypeMetadata;\n\npublic class IsRequiredNeo4jDatabaseCondition implements Condition {\n    @Override\n    public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata){\n        return neo4jDriverOnClassPath() && databaseUrlSet(context); // [1]\n    }\n    private boolean databaseUrlSet(ConditioContext context) {\n        return context.getEnvironment().containsPreperty(\"spring.data.neo4j.uri\");\n    }\n    private boolean neo4jDriverOnClassPath() {\n        try {\n            Class.forName(\"org.neo4j.driver.Driver\");\n            return true;\n        } catch (ClassNotFoundException e) {\n            return false;\n        }\n    }\n}\n```\n[1], properties, neo4jDriver(classpath).\n> : Neo4j.\n\nmatchCondition:\n - create @Beans depending on specific **available properties**.\n - create @Beans depending on specific **libraries on your classpath**.\n\n, ,\n - Conditionals that create a DataSource for you, because you have set specific properties (think: spring.data.neo4j.uri)? \n - Or @Conditionals that boot up an embedded Tomcat server for you because you have the Tomcat libraries on your classpath?\nThe Answer is YES, that (and not much more) is exactly what Spring Boot is. \n\n# Spring Boot Autoconfigurations: Three Internal Core Features\n## PropertySources\nSpring Boot, :\n{% blockquote Spring Boot docs%}\n1. Default properties (specified by setting SpringApplication.setDefaultProperties).\n2. `@PropertySource` annotations on your @Configuration classes. Please note that such property sources are not added to the Environment until the application context is being refreshed. This is too late to configure certain properties such as logging.* and spring.main.* which are read before refresh begins.\n3. Config data (such as application.properties files)\n4. A RandomValuePropertySource that has properties only in random.*.\n5. OS environment variables.\n6. Java System properties (System.getProperties()).\n7. JNDI attributes from java:comp/env.\n8. ServletContext init parameters.\n9. ServletConfig init parameters.\n10. Properties from SPRING_APPLICATION_JSON (inline JSON embedded in an environment variable or system property).\n11. Command line arguments.\n12. properties attribute on your tests. Available on @SpringBootTest and the test annotations for testing a particular slice of your application.\n13. @TestPropertySource annotations on your tests.\n14. Devtools global settings properties in the $HOME/.config/spring-boot directory when devtools is active.\n{% endblockquote %}\nSpring Boot, Property.\n\n, `@PropertySource`, `@PropertySource``.properties`\n```java\n@PropertySource(value = \"classpath:application.properties\", ignoreResourceNotFound = true)\n```\nSpringBootmain, SpringBoot14PropertySource(17, 2.5.6), .\n\n> : Spring Bootbean\n> 1. @Value\n> 2. @ConfigurationProperties\n\n\n## Read-in META-INF/spring.factories\nSpringBoot, `org.springframework.boot:spring-boot-autoconfigure`, jarmagic. `META-INF/spring.factories`.\n```\n# Auto Configure\norg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\norg.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\\\norg.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\\\norg.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\\\norg.springframework.boot.autoconfigure.batch.BatchAutoConfiguration,\\\n// ...\n// 100+ more lines\n```\n, EnableAutoConfiguration, 100. @Configurations@Conditionals, Spring BootCondition.\n\n## Enhanced Conditional Support\n@Conditional, , \"\", :\n - @ConditionalOnClass(DataSource.class). The condition is true if the DataSource class is on the classpath.\n - @ConditionalOnMissingClass(DataSource.class). The condition is true if the DataSource class is not on the classpath.\n - @ConditionalOnMissingBean(DataSource.class). The condition is true if the user did not specify a DataSource @Bean in any @Configuration.\n - @ConditionalOnWebApplication. The condition is true if the application is a web application.\n - @ConditionalOnProperty(\"my.property\"). The condition is true if my.property is set.\n - @ConditionalOnResource(\"classpath:my.properties\"). The condition is true if my.properties exists.\n - // e.g.\n, .\n\n@Conditional:\n - Class Conditions\n - Bean Conditions\n - Property Conditions\n - Resource Conditions\n - Web Application Conditions\n - SpEL Expression Conditions\n\n### Class Conditions\n@ConditionalOnClass@ConditionalOnMissingClass, classclasspath, Bean. \n> **The fact is that annotation metadata is parsed by using ASM.**\nConditional, `value``name`, `value`class, application classpath.\n\n### Bean Conditions\nConditional @Conditional that only matches when no beans meeting the specified\nrequirements are already contained in the `BeanFactory`.\n\nWhen placed on a `@Bean` method, the bean class defaults to the return type of\nthe factory method:\n```java\n@Configuration\npublic class MyAutoConfiguration {\n    @Bean\n    @ConditionalOnMissingBean\n    // @ConditionalOnMissingBean, method, : @ConditionalOnMissingBean(MyService.class)\n    public MyService myService() {\n        ...\n    }\n}\n```\nIn the sample above the condition will match if no bean of type {@code MyService} is\nalready contained in the {@link BeanFactory}.\n\n#### Property Conditions...\n\n\n## AutoConfiguration\n```java\npublic class MyService {\n\n  private String name;\n\n  public MyService(String name) {\n    this.name = name;\n  }\n\n  public MyService() {}\n\n  public String getName() {\n    return this.name;\n  }\n}\n```\n\n```java\nimport org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n@Configuration(proxyBeanMethods = false)\npublic class MyServiceAutoConfiguration {\n\n  @Bean\n  @ConditionalOnMissingBean // equivalent to @ConditionalOnMissingBean(MyService.class)\n  public MyService myService() {\n    // When MyService(bean type) doesn't exist, this bean will create.\n    return new MyService(\"test123\");\n  }\n}\n```\n\nAutoConfigurationApplicationContextRunner, ApplicationContextRunner is usually defined as field of the \"test class\" to gather the base, common configuration.\n```java\nimport com.example.multimodule.service.auto.MyService;\nimport com.example.multimodule.service.auto.MyServiceAutoConfiguration;\nimport org.junit.jupiter.api.Test;\nimport org.springframework.boot.autoconfigure.AutoConfigurations;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.boot.test.context.runner.ApplicationContextRunner;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\nimport static org.assertj.core.api.Assertions.assertThat;\n\n@SpringBootTest\npublic class TestAutoConfiguration {\n  // load MyServiceAutoConfiguration.class\n  private final ApplicationContextRunner contextRunner =\n      new ApplicationContextRunner()\n          .withConfiguration(AutoConfigurations.of(MyServiceAutoConfiguration.class));\n\n  @Configuration(proxyBeanMethods = false)\n  static class UserConfiguration {\n    @Bean\n    MyService myCustomService() {\n      // This bean is always created.\n      return new MyService(\"mine\");\n    }\n  }\n\n  @Test\n  void conditionEffectedTest() {\n    // @ConditionalOnMissingBean effect\n    this.contextRunner.run(\n        (context) -> {\n          assertThat(context).getBean(\"myService\");\n          assertThat(context).hasSingleBean(MyService.class);\n          assertThat(context.getBean(MyService.class).getName()).isEqualTo(\"test123\");\n        });\n  }\n\n  @Test\n  void conditionNotEffectedTest() {\n    // @ConditionalOnMissingBean effect\n    this.contextRunner\n        .withUserConfiguration(UserConfiguration.class) // add UserConfiguration into context.\n        .run(\n            (context -> {\n              assertThat(context).hasSingleBean(MyService.class);\n              assertThat(context)\n                  .getBean(\"myCustomService\")\n                  .isSameAs(context.getBean(MyService.class));\n              assertThat(context.getBean(MyService.class).getName()).isEqualTo(\"mine\");\n            }));\n  }\n}\n```\n, ApplicationContextMyServiceAutoConfiguration, Bean`myService`, MyServiceAutoConfigurationUserConfigurationBean`myCustomService`, @ConditionalOnMissingBean.\n\nAutoconfigurationConditional: https://www.baeldung.com/spring-boot-context-runner\n\n# starter\na custom starter can contain the following:\n\n - The autoconfigure module that contains the auto-configuration code for \"acme\".\n\n - The starter module that provides a dependency to the autoconfigure module as well as \"acme\" and any additional dependencies that are typically useful. In a nutshell, adding the starter should provide everything needed to start using that library.\n\n#### Naming\nYou should make sure to provide a proper namespace for your starter. Do not start your module names with spring-boot\n#### Configuration keys\nIf your starter provides configuration keys, use a unique namespace for them. In particular, do not include your keys in the namespaces that Spring Boot uses (such as server, management, spring, and so on). \n```java\nimport java.time.Duration;\n\nimport org.springframework.boot.context.properties.ConfigurationProperties;\n\n@ConfigurationProperties(\"acme\")\npublic class AcmeProperties {\n\n    /**\n     * Whether to check the location of acme resources.\n     */\n    private boolean checkLocation = true;\n\n    /**\n     * Timeout for establishing a connection to the acme server.\n     */\n    private Duration loginTimeout = Duration.ofSeconds(3);\n\n    public boolean isCheckLocation() {\n        return this.checkLocation;\n    }\n\n    public void setCheckLocation(boolean checkLocation) {\n        this.checkLocation = checkLocation;\n    }\n\n    public Duration getLoginTimeout() {\n        return this.loginTimeout;\n    }\n\n    public void setLoginTimeout(Duration loginTimeout) {\n        this.loginTimeout = loginTimeout;\n    }\n\n}\n```\nHere are some rules we follow internally to make sure descriptions are consistent:\n - Do not start the description by \"The\" or \"A\".\n - For boolean types, start the description with \"Whether\" or \"Enable\".\n - For collection-based types, start the description with \"Comma-separated list\"\n - Use java.time.Duration rather than long and describe the default unit if it differs from milliseconds, such as \"If a duration suffix is not specified, seconds will be used\".\n - Do not provide the default value in the description unless it has to be determined at runtime.\n\n> Make sure to trigger meta-data generation so that IDE assistance is available for your keys as well. You may want to review the generated metadata (META-INF/spring-configuration-metadata.json) to make sure your keys are properly documented. Using your own starter in a compatible IDE is also a good idea to validate that quality of the metadata.\n\n## The \"autoconfigure\" module\n The `autoconfigure` module contains everything that is necessary to get started with the library. It may also contain configuration key definitions (such as @ConfigurationProperties) and any callback interface that can be used to further customize how the components are initialized.\n\nSpring Boot uses an annotation processor to collect the conditions on auto-configurations in a metadata file (`META-INF/spring-autoconfigure-metadata.properties`). If that file is present, it is used to eagerly filter auto-configurations that do not match, which will improve startup time. It is recommended to add the following dependency in a module that contains auto-configurations:\n```gradle\ndependencies {\n    compileOnly \"org.springframework.boot:spring-boot-autoconfigure-processor\"\n}\n```\n\n## Starter module\nThe starter is really an empty jar. Its only purpose is to provide the necessary dependencies to work with the library. You can think of it as an opinionated view of what is required to get started.\n\nDo not make assumptions about the project in which your starter is added. If the library you are auto-configuring typically requires other starters, mention them as well. Providing a proper set of *default* dependencies may be hard if the number of optional dependencies is high, as you should avoid including dependencies that are unnecessary for a typical usage of the library. In other words, you should not include optional dependencies.\n\n> NOTE: Either way, your starter must reference the core Spring Boot starter (spring-boot-starter) directly or indirectly (there is no need to add it if your starter relies on another starter). If a project is created with only your custom starter, Spring Boots core features will be honoured by the presence of the core starter.\n\n, starter, spring boot, `E:\\SpringProjects\\PracticeProjects\\spring-boot-practice-auto-configuration`, `E:\\SpringProjects\\PracticeProjects\\spring-boot-master-auto-configuration`git log. `spring-boot-master-auto-configuration``hornetq``redis`, redis.\n","slug":"spring-autoconfigurations","published":1,"updated":"2021-12-30T03:04:50.332Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpz20018xotg9bmc867m","content":"<p>Spring Frameworks @Conditional annotation is the core of Autoconfigurations.<br>, @Configuration. @Conditional. , @ConditionalOnClass@ConditionalOnMissingBean. , , @Configuration.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>, Spring Framework, 80%. , ApplicationContextConfiguration, Bean.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SharedContextConfiguration</span> </span>&#123; <span class=\"comment\">// (1)</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Driver <span class=\"title\">neo4jDriver</span><span class=\"params\">(Neo4jProperties properties, ...)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> GraphDatabase.driver(...);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>SharedConfiguration, maven. @Configuration@Import(Configuration.class)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@Import(SharedConfiguration.class)</span> <span class=\"comment\">// (1)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">OtherProjectContextConfiguration</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"comment\">// you would specify your project-specific beans here, as normal.</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:<br>SharedConfigurationBean, Neo4jBean, , Bean?</p>\n<p>@Conditional.</p>\n<h1 id=\"-Conditional\"><a href=\"#-Conditional\" class=\"headerlink\" title=\"@Conditional\"></a>@Conditional</h1><p>@Conditional@Bean Method, @Components@Configuration. <code>@Target(&#123;ElementType.TYPE,ElementType.METHOD&#125;)</code>, @ConditionalOnClass, @ConditionalOnBean, @ConditionalOnMissBean.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(&#123; ElementType.TYPE, ElementType.METHOD &#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Conditional(OnClassCondition.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> ConditionalOnClass &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * The classes that must be present. Since this annotation is parsed by loading class</span></span><br><span class=\"line\"><span class=\"comment\">\t * bytecode, it is safe to specify classes here that may ultimately not be on the</span></span><br><span class=\"line\"><span class=\"comment\">\t * classpath, only if this annotation is directly on the affected component and</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;b&gt;not&lt;/b&gt; if this annotation is used as a composed, meta-annotation. In order to</span></span><br><span class=\"line\"><span class=\"comment\">\t * use this annotation as a meta-annotation, only use the &#123;<span class=\"doctag\">@link</span> #name&#125; attribute.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> the classes that must be present</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\tClass&lt;?&gt;[] value() <span class=\"keyword\">default</span> &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * The classes names that must be present.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> the class names that must be present.</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\tString[] name() <span class=\"keyword\">default</span> &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>@Conditional(, ), @ConditionalCondition, matches(SpringBootCondition), Boolean</p>\n<ul>\n<li>True: (Further Evaluate/Register) Create that @Bean, @Component or @Configuration</li>\n<li>False: (Stop Evaluating/Registering) Dont create that @Bean, @Component or @Configuration<br>:<img  src=http://www.plantuml.com/plantuml/svg/VOon3i8m34JtV8L7a6X_01Qer0qnm0-On42arAx83I3Wtma25GR0m_bqVhus9iWnwdxTFtHXXiOqH4HJcbshYbRQ9CvvIDrFiltJvJxPkgPlIDJolcClz8OlZifipPAmKiVm1ycZuLuCv0JoppsXkQg18M5pxcKfuC1WwbvcF7MtEm00></li>\n</ul>\n<p>Condition:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * A single &#123;<span class=\"doctag\">@code</span> condition&#125; that must be &#123;<span class=\"doctag\">@linkplain</span> #matches matched&#125; in order</span></span><br><span class=\"line\"><span class=\"comment\"> * for a component to be registered.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;Conditions are checked immediately before the bean-definition is due to be</span></span><br><span class=\"line\"><span class=\"comment\"> * registered and are free to veto registration based on any criteria that can</span></span><br><span class=\"line\"><span class=\"comment\"> * be determined at that point.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;Conditions must follow the same restrictions as &#123;<span class=\"doctag\">@link</span> BeanFactoryPostProcessor&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * and take care to never interact with bean instances. For more fine-grained control</span></span><br><span class=\"line\"><span class=\"comment\"> * of conditions that interact with &#123;<span class=\"doctag\">@code</span> <span class=\"doctag\">@Configuration</span>&#125; beans consider implementing</span></span><br><span class=\"line\"><span class=\"comment\"> * the &#123;<span class=\"doctag\">@link</span> ConfigurationCondition&#125; interface.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Phillip Webb</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 4.0</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> ConfigurationCondition</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> Conditional</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> ConditionContext</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@FunctionalInterface</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Condition</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Determine if the condition matches.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> context the condition context</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> metadata the metadata of the &#123;<span class=\"doctag\">@link</span> org.springframework.core.type.AnnotationMetadata class&#125;</span></span><br><span class=\"line\"><span class=\"comment\">\t * or &#123;<span class=\"doctag\">@link</span> org.springframework.core.type.MethodMetadata method&#125; being checked</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@code</span> true&#125; if the condition matches and the component can be registered,</span></span><br><span class=\"line\"><span class=\"comment\">\t * or &#123;<span class=\"doctag\">@code</span> false&#125; to veto the annotated component&#x27;s registration</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">matches</span><span class=\"params\">(ConditionContext context, AnnotatedTypeMetadata metadata)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<blockquote><p>In short: Even though an ApplicationContextConfiguration comes with certain @Bean definitions, you as the end-user can still somewhat influence if a bean gets created or not.</p>\n</blockquote>\n<p>ApplicationContextConfiguration@Bean, Bean.</p>\n<h2 id=\"-Conditional\"><a href=\"#-Conditional\" class=\"headerlink\" title=\"@Conditional\"></a>@Conditional</h2><p>ApplicationContextConfiguration</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SharedConfiguration</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"meta\">@Conditional(IsRequiredNeo4jDatabaseCondition.class)</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Driver <span class=\"title\">neo4jDriver</span><span class=\"params\">(Neo4jProperties properties, ...)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> GraphDatabase.driver(...);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Condition:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Condition;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.ConditionContext;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.core.type.AnnotatedTypeMetadata;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">IsRequiredNeo4jDatabaseCondition</span> <span class=\"keyword\">implements</span> <span class=\"title\">Condition</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">matches</span><span class=\"params\">(ConditionContext context, AnnotatedTypeMetadata metadata)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> neo4jDriverOnClassPath() &amp;&amp; databaseUrlSet(context); <span class=\"comment\">// [1]</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> <span class=\"title\">databaseUrlSet</span><span class=\"params\">(ConditioContext context)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> context.getEnvironment().containsPreperty(<span class=\"string\">&quot;spring.data.neo4j.uri&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> <span class=\"title\">neo4jDriverOnClassPath</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Class.forName(<span class=\"string\">&quot;org.neo4j.driver.Driver&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (ClassNotFoundException e) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>[1], properties, neo4jDriver(classpath).</p>\n<blockquote>\n<p>: Neo4j.</p>\n</blockquote>\n<p>matchCondition:</p>\n<ul>\n<li>create @Beans depending on specific <strong>available properties</strong>.</li>\n<li>create @Beans depending on specific <strong>libraries on your classpath</strong>.</li>\n</ul>\n<p>, ,</p>\n<ul>\n<li>Conditionals that create a DataSource for you, because you have set specific properties (think: spring.data.neo4j.uri)? </li>\n<li>Or @Conditionals that boot up an embedded Tomcat server for you because you have the Tomcat libraries on your classpath?<br>The Answer is YES, that (and not much more) is exactly what Spring Boot is. </li>\n</ul>\n<h1 id=\"Spring-Boot-Autoconfigurations-Three-Internal-Core-Features\"><a href=\"#Spring-Boot-Autoconfigurations-Three-Internal-Core-Features\" class=\"headerlink\" title=\"Spring Boot Autoconfigurations: Three Internal Core Features\"></a>Spring Boot Autoconfigurations: Three Internal Core Features</h1><h2 id=\"PropertySources\"><a href=\"#PropertySources\" class=\"headerlink\" title=\"PropertySources\"></a>PropertySources</h2><p>Spring Boot, :</p>\n<blockquote><ol>\n<li>Default properties (specified by setting SpringApplication.setDefaultProperties).</li>\n<li><code>@PropertySource</code> annotations on your @Configuration classes. Please note that such property sources are not added to the Environment until the application context is being refreshed. This is too late to configure certain properties such as logging.* and spring.main.* which are read before refresh begins.</li>\n<li>Config data (such as application.properties files)</li>\n<li>A RandomValuePropertySource that has properties only in random.*.</li>\n<li>OS environment variables.</li>\n<li>Java System properties (System.getProperties()).</li>\n<li>JNDI attributes from java:comp/env.</li>\n<li>ServletContext init parameters.</li>\n<li>ServletConfig init parameters.</li>\n<li>Properties from SPRING_APPLICATION_JSON (inline JSON embedded in an environment variable or system property).</li>\n<li>Command line arguments.</li>\n<li>properties attribute on your tests. Available on @SpringBootTest and the test annotations for testing a particular slice of your application.</li>\n<li>@TestPropertySource annotations on your tests.</li>\n<li>Devtools global settings properties in the $HOME/.config/spring-boot directory when devtools is active.</li>\n</ol>\n<footer><strong>Spring Boot docs</strong></footer></blockquote>\n<p>Spring Boot, Property.</p>\n<p>, <code>@PropertySource</code>, <code>@PropertySource</code><code>.properties</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@PropertySource(value = &quot;classpath:application.properties&quot;, ignoreResourceNotFound = true)</span></span><br></pre></td></tr></table></figure>\n<p>SpringBootmain, SpringBoot14PropertySource(17, 2.5.6), .</p>\n<blockquote>\n<p>: Spring Bootbean</p>\n<ol>\n<li>@Value</li>\n<li>@ConfigurationProperties</li>\n</ol>\n</blockquote>\n<h2 id=\"Read-in-META-INF-spring-factories\"><a href=\"#Read-in-META-INF-spring-factories\" class=\"headerlink\" title=\"Read-in META-INF/spring.factories\"></a>Read-in META-INF/spring.factories</h2><p>SpringBoot, <code>org.springframework.boot:spring-boot-autoconfigure</code>, jarmagic. <code>META-INF/spring.factories</code>.</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Auto Configure</span><br><span class=\"line\">org.springframework.boot.autoconfigure.EnableAutoConfiguration=\\</span><br><span class=\"line\">org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\\</span><br><span class=\"line\">org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\\</span><br><span class=\"line\">org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\\</span><br><span class=\"line\">org.springframework.boot.autoconfigure.batch.BatchAutoConfiguration,\\</span><br><span class=\"line\">// ...</span><br><span class=\"line\">// 100+ more lines</span><br></pre></td></tr></table></figure>\n<p>, EnableAutoConfiguration, 100. @Configurations@Conditionals, Spring BootCondition.</p>\n<h2 id=\"Enhanced-Conditional-Support\"><a href=\"#Enhanced-Conditional-Support\" class=\"headerlink\" title=\"Enhanced Conditional Support\"></a>Enhanced Conditional Support</h2><p>@Conditional, , , :</p>\n<ul>\n<li>@ConditionalOnClass(DataSource.class). The condition is true if the DataSource class is on the classpath.</li>\n<li>@ConditionalOnMissingClass(DataSource.class). The condition is true if the DataSource class is not on the classpath.</li>\n<li>@ConditionalOnMissingBean(DataSource.class). The condition is true if the user did not specify a DataSource @Bean in any @Configuration.</li>\n<li>@ConditionalOnWebApplication. The condition is true if the application is a web application.</li>\n<li>@ConditionalOnProperty(my.property). The condition is true if my.property is set.</li>\n<li>@ConditionalOnResource(classpath:my.properties). The condition is true if my.properties exists.</li>\n<li>// e.g.<br>, .</li>\n</ul>\n<p>@Conditional:</p>\n<ul>\n<li>Class Conditions</li>\n<li>Bean Conditions</li>\n<li>Property Conditions</li>\n<li>Resource Conditions</li>\n<li>Web Application Conditions</li>\n<li>SpEL Expression Conditions</li>\n</ul>\n<h3 id=\"Class-Conditions\"><a href=\"#Class-Conditions\" class=\"headerlink\" title=\"Class Conditions\"></a>Class Conditions</h3><p>@ConditionalOnClass@ConditionalOnMissingClass, classclasspath, Bean. </p>\n<blockquote>\n<p><strong>The fact is that annotation metadata is parsed by using ASM.</strong><br>Conditional, <code>value</code><code>name</code>, <code>value</code>class, application classpath.</p>\n</blockquote>\n<h3 id=\"Bean-Conditions\"><a href=\"#Bean-Conditions\" class=\"headerlink\" title=\"Bean Conditions\"></a>Bean Conditions</h3><p>Conditional @Conditional that only matches when no beans meeting the specified<br>requirements are already contained in the <code>BeanFactory</code>.</p>\n<p>When placed on a <code>@Bean</code> method, the bean class defaults to the return type of<br>the factory method:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyAutoConfiguration</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"meta\">@ConditionalOnMissingBean</span></span><br><span class=\"line\">    <span class=\"comment\">// @ConditionalOnMissingBean, method, : @ConditionalOnMissingBean(MyService.class)</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> MyService <span class=\"title\">myService</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        ...</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>In the sample above the condition will match if no bean of type {@code MyService} is<br>already contained in the {@link BeanFactory}.</p>\n<h4 id=\"Property-Conditions\"><a href=\"#Property-Conditions\" class=\"headerlink\" title=\"Property Conditions\"></a>Property Conditions</h4><h2 id=\"AutoConfiguration\"><a href=\"#AutoConfiguration\" class=\"headerlink\" title=\"AutoConfiguration\"></a>AutoConfiguration</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyService</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyService</span><span class=\"params\">(String name)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyService</span><span class=\"params\">()</span> </span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Bean;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Configuration;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Configuration(proxyBeanMethods = false)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyServiceAutoConfiguration</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"meta\">@Bean</span></span><br><span class=\"line\">  <span class=\"meta\">@ConditionalOnMissingBean</span> <span class=\"comment\">// equivalent to @ConditionalOnMissingBean(MyService.class)</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> MyService <span class=\"title\">myService</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// When MyService(bean type) doesn&#x27;t exist, this bean will create.</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> MyService(<span class=\"string\">&quot;test123&quot;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>AutoConfigurationApplicationContextRunner, ApplicationContextRunner is usually defined as field of the test class to gather the base, common configuration.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.example.multimodule.service.auto.MyService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.example.multimodule.service.auto.MyServiceAutoConfiguration;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.junit.jupiter.api.Test;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.autoconfigure.AutoConfigurations;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.test.context.runner.ApplicationContextRunner;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Bean;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Configuration;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"keyword\">static</span> org.assertj.core.api.Assertions.assertThat;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@SpringBootTest</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestAutoConfiguration</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">// load MyServiceAutoConfiguration.class</span></span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> ApplicationContextRunner contextRunner =</span><br><span class=\"line\">      <span class=\"keyword\">new</span> ApplicationContextRunner()</span><br><span class=\"line\">          .withConfiguration(AutoConfigurations.of(MyServiceAutoConfiguration.class));</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"meta\">@Configuration(proxyBeanMethods = false)</span></span><br><span class=\"line\">  <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UserConfiguration</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\">MyService <span class=\"title\">myCustomService</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">      <span class=\"comment\">// This bean is always created.</span></span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> MyService(<span class=\"string\">&quot;mine&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"meta\">@Test</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">conditionEffectedTest</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// @ConditionalOnMissingBean effect</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.contextRunner.run(</span><br><span class=\"line\">        (context) -&gt; &#123;</span><br><span class=\"line\">          assertThat(context).getBean(<span class=\"string\">&quot;myService&quot;</span>);</span><br><span class=\"line\">          assertThat(context).hasSingleBean(MyService.class);</span><br><span class=\"line\">          assertThat(context.getBean(MyService.class).getName()).isEqualTo(<span class=\"string\">&quot;test123&quot;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"meta\">@Test</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">conditionNotEffectedTest</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// @ConditionalOnMissingBean effect</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.contextRunner</span><br><span class=\"line\">        .withUserConfiguration(UserConfiguration.class) <span class=\"comment\">// add UserConfiguration into context.</span></span><br><span class=\"line\">        .run(</span><br><span class=\"line\">            (context -&gt; &#123;</span><br><span class=\"line\">              assertThat(context).hasSingleBean(MyService.class);</span><br><span class=\"line\">              assertThat(context)</span><br><span class=\"line\">                  .getBean(<span class=\"string\">&quot;myCustomService&quot;</span>)</span><br><span class=\"line\">                  .isSameAs(context.getBean(MyService.class));</span><br><span class=\"line\">              assertThat(context.getBean(MyService.class).getName()).isEqualTo(<span class=\"string\">&quot;mine&quot;</span>);</span><br><span class=\"line\">            &#125;));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>, ApplicationContextMyServiceAutoConfiguration, Bean<code>myService</code>, MyServiceAutoConfigurationUserConfigurationBean<code>myCustomService</code>, @ConditionalOnMissingBean.</p>\n<p>AutoconfigurationConditional: <a href=\"https://www.baeldung.com/spring-boot-context-runner\">https://www.baeldung.com/spring-boot-context-runner</a></p>\n<h1 id=\"starter\"><a href=\"#starter\" class=\"headerlink\" title=\"starter\"></a>starter</h1><p>a custom starter can contain the following:</p>\n<ul>\n<li><p>The autoconfigure module that contains the auto-configuration code for acme.</p>\n</li>\n<li><p>The starter module that provides a dependency to the autoconfigure module as well as acme and any additional dependencies that are typically useful. In a nutshell, adding the starter should provide everything needed to start using that library.</p>\n</li>\n</ul>\n<h4 id=\"Naming\"><a href=\"#Naming\" class=\"headerlink\" title=\"Naming\"></a>Naming</h4><p>You should make sure to provide a proper namespace for your starter. Do not start your module names with spring-boot</p>\n<h4 id=\"Configuration-keys\"><a href=\"#Configuration-keys\" class=\"headerlink\" title=\"Configuration keys\"></a>Configuration keys</h4><p>If your starter provides configuration keys, use a unique namespace for them. In particular, do not include your keys in the namespaces that Spring Boot uses (such as server, management, spring, and so on). </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.time.Duration;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@ConfigurationProperties(&quot;acme&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AcmeProperties</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Whether to check the location of acme resources.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> checkLocation = <span class=\"keyword\">true</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Timeout for establishing a connection to the acme server.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Duration loginTimeout = Duration.ofSeconds(<span class=\"number\">3</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isCheckLocation</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.checkLocation;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setCheckLocation</span><span class=\"params\">(<span class=\"keyword\">boolean</span> checkLocation)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.checkLocation = checkLocation;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Duration <span class=\"title\">getLoginTimeout</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.loginTimeout;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setLoginTimeout</span><span class=\"params\">(Duration loginTimeout)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.loginTimeout = loginTimeout;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Here are some rules we follow internally to make sure descriptions are consistent:</p>\n<ul>\n<li>Do not start the description by The or A.</li>\n<li>For boolean types, start the description with Whether or Enable.</li>\n<li>For collection-based types, start the description with Comma-separated list</li>\n<li>Use java.time.Duration rather than long and describe the default unit if it differs from milliseconds, such as If a duration suffix is not specified, seconds will be used.</li>\n<li>Do not provide the default value in the description unless it has to be determined at runtime.</li>\n</ul>\n<blockquote>\n<p>Make sure to trigger meta-data generation so that IDE assistance is available for your keys as well. You may want to review the generated metadata (META-INF/spring-configuration-metadata.json) to make sure your keys are properly documented. Using your own starter in a compatible IDE is also a good idea to validate that quality of the metadata.</p>\n</blockquote>\n<h2 id=\"The-autoconfigure-module\"><a href=\"#The-autoconfigure-module\" class=\"headerlink\" title=\"The autoconfigure module\"></a>The autoconfigure module</h2><p> The <code>autoconfigure</code> module contains everything that is necessary to get started with the library. It may also contain configuration key definitions (such as @ConfigurationProperties) and any callback interface that can be used to further customize how the components are initialized.</p>\n<p>Spring Boot uses an annotation processor to collect the conditions on auto-configurations in a metadata file (<code>META-INF/spring-autoconfigure-metadata.properties</code>). If that file is present, it is used to eagerly filter auto-configurations that do not match, which will improve startup time. It is recommended to add the following dependency in a module that contains auto-configurations:</p>\n<figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">dependencies</span> &#123;</span><br><span class=\"line\">    compileOnly <span class=\"string\">&quot;org.springframework.boot:spring-boot-autoconfigure-processor&quot;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Starter-module\"><a href=\"#Starter-module\" class=\"headerlink\" title=\"Starter module\"></a>Starter module</h2><p>The starter is really an empty jar. Its only purpose is to provide the necessary dependencies to work with the library. You can think of it as an opinionated view of what is required to get started.</p>\n<p>Do not make assumptions about the project in which your starter is added. If the library you are auto-configuring typically requires other starters, mention them as well. Providing a proper set of <em>default</em> dependencies may be hard if the number of optional dependencies is high, as you should avoid including dependencies that are unnecessary for a typical usage of the library. In other words, you should not include optional dependencies.</p>\n<blockquote>\n<p>NOTE: Either way, your starter must reference the core Spring Boot starter (spring-boot-starter) directly or indirectly (there is no need to add it if your starter relies on another starter). If a project is created with only your custom starter, Spring Boots core features will be honoured by the presence of the core starter.</p>\n</blockquote>\n<p>, starter, spring boot, <code>E:\\SpringProjects\\PracticeProjects\\spring-boot-practice-auto-configuration</code>, <code>E:\\SpringProjects\\PracticeProjects\\spring-boot-master-auto-configuration</code>git log. <code>spring-boot-master-auto-configuration</code><code>hornetq</code><code>redis</code>, redis.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>Spring Frameworks @Conditional annotation is the core of Autoconfigurations.<br>, @Configuration. @Conditional. , @ConditionalOnClass@ConditionalOnMissingBean. , , @Configuration.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>, Spring Framework, 80%. , ApplicationContextConfiguration, Bean.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SharedContextConfiguration</span> </span>&#123; <span class=\"comment\">// (1)</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Driver <span class=\"title\">neo4jDriver</span><span class=\"params\">(Neo4jProperties properties, ...)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> GraphDatabase.driver(...);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>SharedConfiguration, maven. @Configuration@Import(Configuration.class)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@Import(SharedConfiguration.class)</span> <span class=\"comment\">// (1)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">OtherProjectContextConfiguration</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"comment\">// you would specify your project-specific beans here, as normal.</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:<br>SharedConfigurationBean, Neo4jBean, , Bean?</p>\n<p>@Conditional.</p>\n<h1 id=\"-Conditional\"><a href=\"#-Conditional\" class=\"headerlink\" title=\"@Conditional\"></a>@Conditional</h1><p>@Conditional@Bean Method, @Components@Configuration. <code>@Target(&#123;ElementType.TYPE,ElementType.METHOD&#125;)</code>, @ConditionalOnClass, @ConditionalOnBean, @ConditionalOnMissBean.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(&#123; ElementType.TYPE, ElementType.METHOD &#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Conditional(OnClassCondition.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> ConditionalOnClass &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * The classes that must be present. Since this annotation is parsed by loading class</span></span><br><span class=\"line\"><span class=\"comment\">\t * bytecode, it is safe to specify classes here that may ultimately not be on the</span></span><br><span class=\"line\"><span class=\"comment\">\t * classpath, only if this annotation is directly on the affected component and</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;b&gt;not&lt;/b&gt; if this annotation is used as a composed, meta-annotation. In order to</span></span><br><span class=\"line\"><span class=\"comment\">\t * use this annotation as a meta-annotation, only use the &#123;<span class=\"doctag\">@link</span> #name&#125; attribute.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> the classes that must be present</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\tClass&lt;?&gt;[] value() <span class=\"keyword\">default</span> &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * The classes names that must be present.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> the class names that must be present.</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\tString[] name() <span class=\"keyword\">default</span> &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>@Conditional(, ), @ConditionalCondition, matches(SpringBootCondition), Boolean</p>\n<ul>\n<li>True: (Further Evaluate/Register) Create that @Bean, @Component or @Configuration</li>\n<li>False: (Stop Evaluating/Registering) Dont create that @Bean, @Component or @Configuration<br>:<img  src=http://www.plantuml.com/plantuml/svg/VOon3i8m34JtV8L7a6X_01Qer0qnm0-On42arAx83I3Wtma25GR0m_bqVhus9iWnwdxTFtHXXiOqH4HJcbshYbRQ9CvvIDrFiltJvJxPkgPlIDJolcClz8OlZifipPAmKiVm1ycZuLuCv0JoppsXkQg18M5pxcKfuC1WwbvcF7MtEm00></li>\n</ul>\n<p>Condition:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * A single &#123;<span class=\"doctag\">@code</span> condition&#125; that must be &#123;<span class=\"doctag\">@linkplain</span> #matches matched&#125; in order</span></span><br><span class=\"line\"><span class=\"comment\"> * for a component to be registered.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;Conditions are checked immediately before the bean-definition is due to be</span></span><br><span class=\"line\"><span class=\"comment\"> * registered and are free to veto registration based on any criteria that can</span></span><br><span class=\"line\"><span class=\"comment\"> * be determined at that point.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;Conditions must follow the same restrictions as &#123;<span class=\"doctag\">@link</span> BeanFactoryPostProcessor&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * and take care to never interact with bean instances. For more fine-grained control</span></span><br><span class=\"line\"><span class=\"comment\"> * of conditions that interact with &#123;<span class=\"doctag\">@code</span> <span class=\"doctag\">@Configuration</span>&#125; beans consider implementing</span></span><br><span class=\"line\"><span class=\"comment\"> * the &#123;<span class=\"doctag\">@link</span> ConfigurationCondition&#125; interface.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Phillip Webb</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 4.0</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> ConfigurationCondition</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> Conditional</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> ConditionContext</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@FunctionalInterface</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Condition</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Determine if the condition matches.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> context the condition context</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> metadata the metadata of the &#123;<span class=\"doctag\">@link</span> org.springframework.core.type.AnnotationMetadata class&#125;</span></span><br><span class=\"line\"><span class=\"comment\">\t * or &#123;<span class=\"doctag\">@link</span> org.springframework.core.type.MethodMetadata method&#125; being checked</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@code</span> true&#125; if the condition matches and the component can be registered,</span></span><br><span class=\"line\"><span class=\"comment\">\t * or &#123;<span class=\"doctag\">@code</span> false&#125; to veto the annotated component&#x27;s registration</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">matches</span><span class=\"params\">(ConditionContext context, AnnotatedTypeMetadata metadata)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<blockquote><p>In short: Even though an ApplicationContextConfiguration comes with certain @Bean definitions, you as the end-user can still somewhat influence if a bean gets created or not.</p>\n</blockquote>\n<p>ApplicationContextConfiguration@Bean, Bean.</p>\n<h2 id=\"-Conditional\"><a href=\"#-Conditional\" class=\"headerlink\" title=\"@Conditional\"></a>@Conditional</h2><p>ApplicationContextConfiguration</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SharedConfiguration</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"meta\">@Conditional(IsRequiredNeo4jDatabaseCondition.class)</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Driver <span class=\"title\">neo4jDriver</span><span class=\"params\">(Neo4jProperties properties, ...)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> GraphDatabase.driver(...);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Condition:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Condition;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.ConditionContext;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.core.type.AnnotatedTypeMetadata;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">IsRequiredNeo4jDatabaseCondition</span> <span class=\"keyword\">implements</span> <span class=\"title\">Condition</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">matches</span><span class=\"params\">(ConditionContext context, AnnotatedTypeMetadata metadata)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> neo4jDriverOnClassPath() &amp;&amp; databaseUrlSet(context); <span class=\"comment\">// [1]</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> <span class=\"title\">databaseUrlSet</span><span class=\"params\">(ConditioContext context)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> context.getEnvironment().containsPreperty(<span class=\"string\">&quot;spring.data.neo4j.uri&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> <span class=\"title\">neo4jDriverOnClassPath</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Class.forName(<span class=\"string\">&quot;org.neo4j.driver.Driver&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (ClassNotFoundException e) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>[1], properties, neo4jDriver(classpath).</p>\n<blockquote>\n<p>: Neo4j.</p>\n</blockquote>\n<p>matchCondition:</p>\n<ul>\n<li>create @Beans depending on specific <strong>available properties</strong>.</li>\n<li>create @Beans depending on specific <strong>libraries on your classpath</strong>.</li>\n</ul>\n<p>, ,</p>\n<ul>\n<li>Conditionals that create a DataSource for you, because you have set specific properties (think: spring.data.neo4j.uri)? </li>\n<li>Or @Conditionals that boot up an embedded Tomcat server for you because you have the Tomcat libraries on your classpath?<br>The Answer is YES, that (and not much more) is exactly what Spring Boot is. </li>\n</ul>\n<h1 id=\"Spring-Boot-Autoconfigurations-Three-Internal-Core-Features\"><a href=\"#Spring-Boot-Autoconfigurations-Three-Internal-Core-Features\" class=\"headerlink\" title=\"Spring Boot Autoconfigurations: Three Internal Core Features\"></a>Spring Boot Autoconfigurations: Three Internal Core Features</h1><h2 id=\"PropertySources\"><a href=\"#PropertySources\" class=\"headerlink\" title=\"PropertySources\"></a>PropertySources</h2><p>Spring Boot, :</p>\n<blockquote><ol>\n<li>Default properties (specified by setting SpringApplication.setDefaultProperties).</li>\n<li><code>@PropertySource</code> annotations on your @Configuration classes. Please note that such property sources are not added to the Environment until the application context is being refreshed. This is too late to configure certain properties such as logging.* and spring.main.* which are read before refresh begins.</li>\n<li>Config data (such as application.properties files)</li>\n<li>A RandomValuePropertySource that has properties only in random.*.</li>\n<li>OS environment variables.</li>\n<li>Java System properties (System.getProperties()).</li>\n<li>JNDI attributes from java:comp/env.</li>\n<li>ServletContext init parameters.</li>\n<li>ServletConfig init parameters.</li>\n<li>Properties from SPRING_APPLICATION_JSON (inline JSON embedded in an environment variable or system property).</li>\n<li>Command line arguments.</li>\n<li>properties attribute on your tests. Available on @SpringBootTest and the test annotations for testing a particular slice of your application.</li>\n<li>@TestPropertySource annotations on your tests.</li>\n<li>Devtools global settings properties in the $HOME/.config/spring-boot directory when devtools is active.</li>\n</ol>\n<footer><strong>Spring Boot docs</strong></footer></blockquote>\n<p>Spring Boot, Property.</p>\n<p>, <code>@PropertySource</code>, <code>@PropertySource</code><code>.properties</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@PropertySource(value = &quot;classpath:application.properties&quot;, ignoreResourceNotFound = true)</span></span><br></pre></td></tr></table></figure>\n<p>SpringBootmain, SpringBoot14PropertySource(17, 2.5.6), .</p>\n<blockquote>\n<p>: Spring Bootbean</p>\n<ol>\n<li>@Value</li>\n<li>@ConfigurationProperties</li>\n</ol>\n</blockquote>\n<h2 id=\"Read-in-META-INF-spring-factories\"><a href=\"#Read-in-META-INF-spring-factories\" class=\"headerlink\" title=\"Read-in META-INF/spring.factories\"></a>Read-in META-INF/spring.factories</h2><p>SpringBoot, <code>org.springframework.boot:spring-boot-autoconfigure</code>, jarmagic. <code>META-INF/spring.factories</code>.</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Auto Configure</span><br><span class=\"line\">org.springframework.boot.autoconfigure.EnableAutoConfiguration=\\</span><br><span class=\"line\">org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\\</span><br><span class=\"line\">org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\\</span><br><span class=\"line\">org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\\</span><br><span class=\"line\">org.springframework.boot.autoconfigure.batch.BatchAutoConfiguration,\\</span><br><span class=\"line\">// ...</span><br><span class=\"line\">// 100+ more lines</span><br></pre></td></tr></table></figure>\n<p>, EnableAutoConfiguration, 100. @Configurations@Conditionals, Spring BootCondition.</p>\n<h2 id=\"Enhanced-Conditional-Support\"><a href=\"#Enhanced-Conditional-Support\" class=\"headerlink\" title=\"Enhanced Conditional Support\"></a>Enhanced Conditional Support</h2><p>@Conditional, , , :</p>\n<ul>\n<li>@ConditionalOnClass(DataSource.class). The condition is true if the DataSource class is on the classpath.</li>\n<li>@ConditionalOnMissingClass(DataSource.class). The condition is true if the DataSource class is not on the classpath.</li>\n<li>@ConditionalOnMissingBean(DataSource.class). The condition is true if the user did not specify a DataSource @Bean in any @Configuration.</li>\n<li>@ConditionalOnWebApplication. The condition is true if the application is a web application.</li>\n<li>@ConditionalOnProperty(my.property). The condition is true if my.property is set.</li>\n<li>@ConditionalOnResource(classpath:my.properties). The condition is true if my.properties exists.</li>\n<li>// e.g.<br>, .</li>\n</ul>\n<p>@Conditional:</p>\n<ul>\n<li>Class Conditions</li>\n<li>Bean Conditions</li>\n<li>Property Conditions</li>\n<li>Resource Conditions</li>\n<li>Web Application Conditions</li>\n<li>SpEL Expression Conditions</li>\n</ul>\n<h3 id=\"Class-Conditions\"><a href=\"#Class-Conditions\" class=\"headerlink\" title=\"Class Conditions\"></a>Class Conditions</h3><p>@ConditionalOnClass@ConditionalOnMissingClass, classclasspath, Bean. </p>\n<blockquote>\n<p><strong>The fact is that annotation metadata is parsed by using ASM.</strong><br>Conditional, <code>value</code><code>name</code>, <code>value</code>class, application classpath.</p>\n</blockquote>\n<h3 id=\"Bean-Conditions\"><a href=\"#Bean-Conditions\" class=\"headerlink\" title=\"Bean Conditions\"></a>Bean Conditions</h3><p>Conditional @Conditional that only matches when no beans meeting the specified<br>requirements are already contained in the <code>BeanFactory</code>.</p>\n<p>When placed on a <code>@Bean</code> method, the bean class defaults to the return type of<br>the factory method:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyAutoConfiguration</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"meta\">@ConditionalOnMissingBean</span></span><br><span class=\"line\">    <span class=\"comment\">// @ConditionalOnMissingBean, method, : @ConditionalOnMissingBean(MyService.class)</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> MyService <span class=\"title\">myService</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        ...</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>In the sample above the condition will match if no bean of type {@code MyService} is<br>already contained in the {@link BeanFactory}.</p>\n<h4 id=\"Property-Conditions\"><a href=\"#Property-Conditions\" class=\"headerlink\" title=\"Property Conditions\"></a>Property Conditions</h4><h2 id=\"AutoConfiguration\"><a href=\"#AutoConfiguration\" class=\"headerlink\" title=\"AutoConfiguration\"></a>AutoConfiguration</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyService</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyService</span><span class=\"params\">(String name)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyService</span><span class=\"params\">()</span> </span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Bean;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Configuration;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Configuration(proxyBeanMethods = false)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyServiceAutoConfiguration</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"meta\">@Bean</span></span><br><span class=\"line\">  <span class=\"meta\">@ConditionalOnMissingBean</span> <span class=\"comment\">// equivalent to @ConditionalOnMissingBean(MyService.class)</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> MyService <span class=\"title\">myService</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// When MyService(bean type) doesn&#x27;t exist, this bean will create.</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> MyService(<span class=\"string\">&quot;test123&quot;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>AutoConfigurationApplicationContextRunner, ApplicationContextRunner is usually defined as field of the test class to gather the base, common configuration.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.example.multimodule.service.auto.MyService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.example.multimodule.service.auto.MyServiceAutoConfiguration;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.junit.jupiter.api.Test;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.autoconfigure.AutoConfigurations;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.test.context.runner.ApplicationContextRunner;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Bean;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Configuration;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"keyword\">static</span> org.assertj.core.api.Assertions.assertThat;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@SpringBootTest</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestAutoConfiguration</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">// load MyServiceAutoConfiguration.class</span></span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> ApplicationContextRunner contextRunner =</span><br><span class=\"line\">      <span class=\"keyword\">new</span> ApplicationContextRunner()</span><br><span class=\"line\">          .withConfiguration(AutoConfigurations.of(MyServiceAutoConfiguration.class));</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"meta\">@Configuration(proxyBeanMethods = false)</span></span><br><span class=\"line\">  <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UserConfiguration</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\">MyService <span class=\"title\">myCustomService</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">      <span class=\"comment\">// This bean is always created.</span></span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> MyService(<span class=\"string\">&quot;mine&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"meta\">@Test</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">conditionEffectedTest</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// @ConditionalOnMissingBean effect</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.contextRunner.run(</span><br><span class=\"line\">        (context) -&gt; &#123;</span><br><span class=\"line\">          assertThat(context).getBean(<span class=\"string\">&quot;myService&quot;</span>);</span><br><span class=\"line\">          assertThat(context).hasSingleBean(MyService.class);</span><br><span class=\"line\">          assertThat(context.getBean(MyService.class).getName()).isEqualTo(<span class=\"string\">&quot;test123&quot;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"meta\">@Test</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">conditionNotEffectedTest</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// @ConditionalOnMissingBean effect</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.contextRunner</span><br><span class=\"line\">        .withUserConfiguration(UserConfiguration.class) <span class=\"comment\">// add UserConfiguration into context.</span></span><br><span class=\"line\">        .run(</span><br><span class=\"line\">            (context -&gt; &#123;</span><br><span class=\"line\">              assertThat(context).hasSingleBean(MyService.class);</span><br><span class=\"line\">              assertThat(context)</span><br><span class=\"line\">                  .getBean(<span class=\"string\">&quot;myCustomService&quot;</span>)</span><br><span class=\"line\">                  .isSameAs(context.getBean(MyService.class));</span><br><span class=\"line\">              assertThat(context.getBean(MyService.class).getName()).isEqualTo(<span class=\"string\">&quot;mine&quot;</span>);</span><br><span class=\"line\">            &#125;));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>, ApplicationContextMyServiceAutoConfiguration, Bean<code>myService</code>, MyServiceAutoConfigurationUserConfigurationBean<code>myCustomService</code>, @ConditionalOnMissingBean.</p>\n<p>AutoconfigurationConditional: <a href=\"https://www.baeldung.com/spring-boot-context-runner\">https://www.baeldung.com/spring-boot-context-runner</a></p>\n<h1 id=\"starter\"><a href=\"#starter\" class=\"headerlink\" title=\"starter\"></a>starter</h1><p>a custom starter can contain the following:</p>\n<ul>\n<li><p>The autoconfigure module that contains the auto-configuration code for acme.</p>\n</li>\n<li><p>The starter module that provides a dependency to the autoconfigure module as well as acme and any additional dependencies that are typically useful. In a nutshell, adding the starter should provide everything needed to start using that library.</p>\n</li>\n</ul>\n<h4 id=\"Naming\"><a href=\"#Naming\" class=\"headerlink\" title=\"Naming\"></a>Naming</h4><p>You should make sure to provide a proper namespace for your starter. Do not start your module names with spring-boot</p>\n<h4 id=\"Configuration-keys\"><a href=\"#Configuration-keys\" class=\"headerlink\" title=\"Configuration keys\"></a>Configuration keys</h4><p>If your starter provides configuration keys, use a unique namespace for them. In particular, do not include your keys in the namespaces that Spring Boot uses (such as server, management, spring, and so on). </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.time.Duration;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@ConfigurationProperties(&quot;acme&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AcmeProperties</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Whether to check the location of acme resources.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> checkLocation = <span class=\"keyword\">true</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Timeout for establishing a connection to the acme server.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Duration loginTimeout = Duration.ofSeconds(<span class=\"number\">3</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isCheckLocation</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.checkLocation;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setCheckLocation</span><span class=\"params\">(<span class=\"keyword\">boolean</span> checkLocation)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.checkLocation = checkLocation;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Duration <span class=\"title\">getLoginTimeout</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.loginTimeout;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setLoginTimeout</span><span class=\"params\">(Duration loginTimeout)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.loginTimeout = loginTimeout;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Here are some rules we follow internally to make sure descriptions are consistent:</p>\n<ul>\n<li>Do not start the description by The or A.</li>\n<li>For boolean types, start the description with Whether or Enable.</li>\n<li>For collection-based types, start the description with Comma-separated list</li>\n<li>Use java.time.Duration rather than long and describe the default unit if it differs from milliseconds, such as If a duration suffix is not specified, seconds will be used.</li>\n<li>Do not provide the default value in the description unless it has to be determined at runtime.</li>\n</ul>\n<blockquote>\n<p>Make sure to trigger meta-data generation so that IDE assistance is available for your keys as well. You may want to review the generated metadata (META-INF/spring-configuration-metadata.json) to make sure your keys are properly documented. Using your own starter in a compatible IDE is also a good idea to validate that quality of the metadata.</p>\n</blockquote>\n<h2 id=\"The-autoconfigure-module\"><a href=\"#The-autoconfigure-module\" class=\"headerlink\" title=\"The autoconfigure module\"></a>The autoconfigure module</h2><p> The <code>autoconfigure</code> module contains everything that is necessary to get started with the library. It may also contain configuration key definitions (such as @ConfigurationProperties) and any callback interface that can be used to further customize how the components are initialized.</p>\n<p>Spring Boot uses an annotation processor to collect the conditions on auto-configurations in a metadata file (<code>META-INF/spring-autoconfigure-metadata.properties</code>). If that file is present, it is used to eagerly filter auto-configurations that do not match, which will improve startup time. It is recommended to add the following dependency in a module that contains auto-configurations:</p>\n<figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">dependencies</span> &#123;</span><br><span class=\"line\">    compileOnly <span class=\"string\">&quot;org.springframework.boot:spring-boot-autoconfigure-processor&quot;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Starter-module\"><a href=\"#Starter-module\" class=\"headerlink\" title=\"Starter module\"></a>Starter module</h2><p>The starter is really an empty jar. Its only purpose is to provide the necessary dependencies to work with the library. You can think of it as an opinionated view of what is required to get started.</p>\n<p>Do not make assumptions about the project in which your starter is added. If the library you are auto-configuring typically requires other starters, mention them as well. Providing a proper set of <em>default</em> dependencies may be hard if the number of optional dependencies is high, as you should avoid including dependencies that are unnecessary for a typical usage of the library. In other words, you should not include optional dependencies.</p>\n<blockquote>\n<p>NOTE: Either way, your starter must reference the core Spring Boot starter (spring-boot-starter) directly or indirectly (there is no need to add it if your starter relies on another starter). If a project is created with only your custom starter, Spring Boots core features will be honoured by the presence of the core starter.</p>\n</blockquote>\n<p>, starter, spring boot, <code>E:\\SpringProjects\\PracticeProjects\\spring-boot-practice-auto-configuration</code>, <code>E:\\SpringProjects\\PracticeProjects\\spring-boot-master-auto-configuration</code>git log. <code>spring-boot-master-auto-configuration</code><code>hornetq</code><code>redis</code>, redis.</p>\n"},{"title":"Spring IoC","date":"2021-09-28T07:08:10.000Z","_content":"\n, , , , , . Order\n```Java\npublic class Order {\n    private InterfaceItem orderItem;\n    private InterfaceAddress orderAddress;\n    // ...\n    Order (InterfaceItem orderItem, InterfaceAddress orderAddress, ...) {\n        this.orderItem = orderItem;\n        this.orderAddress = orderAddress;\n        // ...\n    }\n\n    public persistOrderData() {\n        this.save();\n    }\n}\npublic AmazonOrderItem implements InterfaceItem {\n    // ...\n}\npublic AmazonOrderAddress implements InterfaceItem {\n    // ...\n}\n```\n\n## IoC\nIoC\"\", , \"\", . , , .\n, , new YourClass(). Spring, , ,, , : new YourClass(obj_1, obj_2, obj_3, ...), obj_nnew.\n, \"new\", , \"\", ., \"\", new, \"\".\n\"\", .\n, (), , setter()\n\n\n## IoC Service ProviderBeanFactoryXML\nIoC. IoC Service Provider, . , .\n\nSpringIoCIoC Service Provider, : BeanFactoryApplicationContext. ApplicationContextBeanFactory, .\n\nSpringPOJO, JavaBean. Spring, Spring, `@Configuration`, `@Component`, `@Service`. , IoC.\n\n, XML, XML, , , XML, : \n```xml\n<bean id=\"order\" class=\"..Order\">\n    <property name=\"orderItem\">\n        <ref bean=\"amazonOrderItem\">\n    </property>\n    <property name=\"orderAddress\">\n        <ref bean=\"amazonOrderAddress\">\n    </property>\n</bean>\n<bean id=\"amazonOrderItem\" class=\"..impl.AmazonOrderItem\"></bean>\n<bean id=\"amazonOrderAddress\" class=\"..impl.AmazonOrderAddress\"></bean>\n```\n\nBeanFactory()\n```java\npackage org.springframework.beans.factory;\n/**\n * The root interface for accessing a Spring bean container.\n * This is the basic client view of a bean container;\n * \n */\npublic interface BeanFactory {\n\tString FACTORY_BEAN_PREFIX = \"&\";\n\n\t/**\n\t * Return an instance, which may be shared or independent, of the specified bean.\n\t */\n\tObject getBean(String name) throws BeansException;\n\t<T> ObjectProvider<T> getBeanProvider(Class<T> requiredType);\n\tboolean containsBean(String name);\n\tboolean isSingleton(String name) throws NoSuchBeanDefinitionException;\n\tboolean isPrototype(String name) throws NoSuchBeanDefinitionException;\n\tboolean isTypeMatch(String name, ResolvableType typeToMatch) throws NoSuchBeanDefinitionException;\n\t@Nullable\n\tClass<?> getType(String name) throws NoSuchBeanDefinitionException;\n\tString[] getAliases(String name);\n}\n\n/** \n  * \"prototype\", \"singleton\"beanscope\n  * prototype scopebean, , \n  * BeanFactory\n  **/\n```\nBeanFactory, \"\"BeanFactory, :\n```java\nBeanFactory container = new XmlBeanFacotry(new ClassPathResource(\"XML_PATH\"));\n/**\n * ApplicationContext\n * ApplicationContext container = new ClassPathXmlApplication(\"XML_PATH\");\n**/\nOrder order = (Order)container.getBean(\"order\");\norder.persistOrderData();\n```\n\n, IoC, BeanFactory, , /->, . IoC., SpringXML</bean>, , \"\".\n\n### \n. , : ****, ,. .\n```java\npublic class Foo {\n    private BarInterface barInterface;\n    public Foo() {\n        // \n        // instance = new BarInterfaceImpl();\n    }\n}\n```\nFoo, `@Component``@Service`Spring IoC, . , BarInterface, . (Factory Method), . Foo, , , Foo.\n```java\npublic class Foo {\n    private BarInterface barInterface;\n    public Foo() {\n        // \n        // barInterface = BarInterfaceFactory.getInterface()\n        // , \n        // barInterface = new BarInterfaceFactory().getInstance();\n    }\n}\n// BarInterface. : \"\".\n```\nXML, , Spring\n```xml\n<bean id=\"foo\" class=\"...Foo\">\n    <property name=\"barInterface\">\n        <ref bean=\"bar\">\n    </property>\n</bean>\n<bean id=\"bar\" class=\"...StaticBarInterfaceFactory\" factory-method=\"getInstance\">\n```\nfactory-method, getInstance. , foobarBarInterfaceImpl.\n\n## \nSpring IoC, : Bean\n> :  >  > BeanDefinition >  ...\n- BeanDefinitionReaderConfiguration MetaData, BeanDefinitionRegistory\n> Bean:  >  >  >  >  ...\n- BeanBeanDefinitionBeanDefinitionRegistry. getBean, \n\n, .\n\n### \n\"\", :  ->  -> \nSpringBeanFactoryProcessor, BeanFactoryPostProcessor. : \n- PropertyPlaceholderConfigurer, properties.\n- CustomEditorConfigurer, XML. SpringJavaBeanPropertyEditorString, : StringArrayPropertyEditor(String[]), ClassEditor(Stringclass, class, Class.forName(String)).\n\n> , Processor, Djangomiddleware, Processor, , PropertyPlaceholderConfigurer > CustomEditorConfigurer > ..., Processor, . Spring, BeanSpring, .\n\n### \n, Bean. BeanDefinition. BeanFactory.getBean(), Bean. \n\n#### BeanBeanWrapper\n, \"(Strategy Pattern)\"bean, CGLIBbean, . , CglibSubclassingInstantiationStrategy.\n\n, BeanDefintion, CglibInstantiationStrategy. , , BeanWrapper, BeanWrapper. \n```java\nObject order = Class.forName(\"package.name.Order\").newInstance();\nObject orderItem = Class.forName(\"package.name.AmazonOrderItem\").newInstance();\nObject orderAddress = Class.forName(\"package.name.AmazonOrderAddress\").newInstace();\n\nBeanWrapper newOrder = new BeanWrapperImpl(order);\nnewOrder.setPropertyValue(\"newOrderItem\", orderItem);\nnewOrder.setPropertyValue(\"newOrderAddress\", orderAddress);\n\nassertTrue(newOrder.getWrappedInstance() instanceof Order);\nassertSame(order, newOrder.getWrappedInstance());\nassertSame(orderItem, newOrder.getPropertyValue(\"newOrderItem\"));\nassertSame(orderAddress, newOrder.getPropertyValue(\"newOrderAddress\"));\n```\n, , BeanWrapperImpl, AbstractNestablePropertyAccessor.\n```java\npackage org.springframework.beans;\npublic class BeanWrapperImpl extends AbstractNestablePropertyAccessor implements BeanWrapper {\n    // ...\n    public BeanWrapperImpl(Object object) {\n\t\tsuper(object);\n\t}\n    // ...\n}\n// ...\npublic abstract class AbstractNestablePropertyAccessor extends AbstractPropertyAccessor {\n    @Nullable\n\tObject wrappedObject;\n    // ...\n    public final Object getWrappedInstance() {\n\t\tAssert.state(this.wrappedObject != null, \"No wrapped object\");\n\t\treturn this.wrappedObject;\n\t}\n    protected AbstractNestablePropertyAccessor(Object object) {\n\t\tregisterDefaultEditors();\n\t\tsetWrappedInstance(object);\n\t}\n    public void setWrappedInstance(Object object) {\n\t\tsetWrappedInstance(object, \"\", null);\n\t}\n    public void setWrappedInstance(Object object, @Nullable String nestedPath, @Nullable Object rootObject) {\n\t\tthis.wrappedObject = ObjectUtils.unwrapOptional(object);\n\t\t// ...\n\t}\n    @Override\n\tpublic void setPropertyValue(String propertyName, @Nullable Object value) throws BeansException {\n\t\t// ... .\n\t}\n    // ...\n}\n```\n, , Spring, , , . \n\n#### \n, setbean, . SpringAware, Aware.\n, BeanNameAware, Spring, beanbeanName. BeanClassLoaderAware, beanClassLoader.\n\n#### ()\n, (hook), Spring, BeanPostProcessor. \nBeanPostProcessorBeanFactoryPostProcessor. BeanPostProcessor, BeanFactoryPostProcessor. BeanPostProcessor. , , , :\n```java\npackage org.springframework.beans.factory.config;\n\nimport org.springframework.beans.BeansException;\nimport org.springframework.lang.Nullable;\n\n/**\n * Factory hook that allows for custom modification of new bean instances,\n * e.g. checking for marker interfaces or wrapping them with proxies.\n *\n * <p>ApplicationContexts can autodetect BeanPostProcessor beans in their\n * bean definitions and apply them to any beans subsequently created.\n * Plain bean factories allow for programmatic registration of post-processors,\n * applying to all beans created through this factory.\n *\n * <p>Typically, post-processors that populate beans via marker interfaces\n * or the like will implement {@link #postProcessBeforeInitialization},\n * while post-processors that wrap beans with proxies will normally\n * implement {@link #postProcessAfterInitialization}.\n *\n * @author Juergen Hoeller\n * @since 10.10.2003\n * @see InstantiationAwareBeanPostProcessor\n * @see DestructionAwareBeanPostProcessor\n * @see ConfigurableBeanFactory#addBeanPostProcessor\n * @see BeanFactoryPostProcessor\n */\npublic interface BeanPostProcessor {\n\n\t/**\n\t * Apply this BeanPostProcessor to the given new bean instance <i>before</i> any bean\n\t * initialization callbacks (like InitializingBean's {@code afterPropertiesSet}\n\t * or a custom init-method). The bean will already be populated with property values.\n\t * The returned bean instance may be a wrapper around the original.\n\t * <p>The default implementation returns the given {@code bean} as-is.\n\t * @param bean the new bean instance\n\t * @param beanName the name of the bean\n\t * @return the bean instance to use, either the original or a wrapped one;\n\t * if {@code null}, no subsequent BeanPostProcessors will be invoked\n\t * @throws org.springframework.beans.BeansException in case of errors\n\t * @see org.springframework.beans.factory.InitializingBean#afterPropertiesSet\n\t */\n\t@Nullable\n\tdefault Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {\n\t\treturn bean;\n\t}\n\n\t/**\n\t * Apply this BeanPostProcessor to the given new bean instance <i>after</i> any bean\n\t * initialization callbacks (like InitializingBean's {@code afterPropertiesSet}\n\t * or a custom init-method). The bean will already be populated with property values.\n\t * The returned bean instance may be a wrapper around the original.\n\t * <p>In case of a FactoryBean, this callback will be invoked for both the FactoryBean\n\t * instance and the objects created by the FactoryBean (as of Spring 2.0). The\n\t * post-processor can decide whether to apply to either the FactoryBean or created\n\t * objects or both through corresponding {@code bean instanceof FactoryBean} checks.\n\t * <p>This callback will also be invoked after a short-circuiting triggered by a\n\t * {@link InstantiationAwareBeanPostProcessor#postProcessBeforeInstantiation} method,\n\t * in contrast to all other BeanPostProcessor callbacks.\n\t * <p>The default implementation returns the given {@code bean} as-is.\n\t * @param bean the new bean instance\n\t * @param beanName the name of the bean\n\t * @return the bean instance to use, either the original or a wrapped one;\n\t * if {@code null}, no subsequent BeanPostProcessors will be invoked\n\t * @throws org.springframework.beans.BeansException in case of errors\n\t * @see org.springframework.beans.factory.InitializingBean#afterPropertiesSet\n\t * @see org.springframework.beans.factory.FactoryBean\n\t */\n\t@Nullable\n\tdefault Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {\n\t\treturn bean;\n\t}\n\n}\n```\nBeanPostProcessor, implements BeanPostProcessor, bean.\n\n#### InitialzingBeaninit-method\n```java\npackage org.springframework.beans.factory;\n\n/**\n * Interface to be implemented by beans that need to react once all their properties\n * have been set by a {@link BeanFactory}: e.g. to perform custom initialization,\n * or merely to check that all mandatory properties have been set.\n *\n * <p>An alternative to implementing {@code InitializingBean} is specifying a custom\n * init method, for example in an XML bean definition. For a list of all bean\n * lifecycle methods, see the {@link BeanFactory BeanFactory javadocs}.\n *\n * @author Rod Johnson\n * @author Juergen Hoeller\n * @see DisposableBean\n * @see org.springframework.beans.factory.config.BeanDefinition#getPropertyValues()\n * @see org.springframework.beans.factory.support.AbstractBeanDefinition#getInitMethodName()\n */\npublic interface InitializingBean {\n\n\t/**\n\t * Invoked by the containing {@code BeanFactory} after it has set all bean properties\n\t * and satisfied {@link BeanFactoryAware}, {@code ApplicationContextAware} etc.\n\t * <p>This method allows the bean instance to perform validation of its overall\n\t * configuration and final initialization when all bean properties have been set.\n\t * @throws Exception in the event of misconfiguration (such as failure to set an\n\t * essential property) or if initialization fails for any other reason\n\t */\n\tvoid afterPropertiesSet() throws Exception;\n\n}\n```\nInitializingBean, \"BeanPostProcessor\", InitializingBean, , afterPropertiesSet(). \n, Spring, Spring, XML`<bean>`init-method, InitializingBeaninit-method.\n> , Spring, Spring.\n\n#### DisposableBeandestroy-method\n, , , , , singletonbean, DisposableBean. bean`<bean>`destory-method. , (Callback), singleton, .\n> , scopeprototypebean.\n\n\n## XML\nXML, .\n`@Autowired`. . `@Autowired`. , bean.\n\nAnnotation Processor, , SpringAutowiredAnnotationBeanPostProcessor. bean`@Autowired`. , , `@Autowired`. : \n```java\nObject[] beans = ...;\nfor (Objec bean: beans) {\n    if(autowiredExistsOnField(bean)){\n        Field f = getQulifiedField(bean);\n        setAccessiableIfNeccessary(f);\n        f.set(getBeanByTypeFromContainer());\n    }\n    if(autowiredExistsOnMethod(bean)) {\n        // ...\n    }\n    // ...\n}\n```\n\n`@Autowired`, @Qualifier, name(String). `@Qualifier`byName.\n\n#### classpath-scanning\n, xml. \", \", . classpath-scanning!\n(`@Component`, `@Service`, `@Configuration`), classpath-scanning(base package), , , BeanDefinition, BeanDefinition. \nclasspath-scanning`<context:component-scan>`. `<context:component-scan>``@Component`. , @Component`@Repository`, `@Service`/`@Controller`, . `@Component`, `@Service``@Repository`. , , `@Service`, `@Component`.\n\n\nSpring, Spring, BeanFactory, BeanPostProcessor, . \n\n","source":"_posts/spring-ioc.md","raw":"---\ntitle: Spring IoC\ndate: 2021-09-28 15:08:10\ncategories: \n- Spring\n---\n\n, , , , , . Order\n```Java\npublic class Order {\n    private InterfaceItem orderItem;\n    private InterfaceAddress orderAddress;\n    // ...\n    Order (InterfaceItem orderItem, InterfaceAddress orderAddress, ...) {\n        this.orderItem = orderItem;\n        this.orderAddress = orderAddress;\n        // ...\n    }\n\n    public persistOrderData() {\n        this.save();\n    }\n}\npublic AmazonOrderItem implements InterfaceItem {\n    // ...\n}\npublic AmazonOrderAddress implements InterfaceItem {\n    // ...\n}\n```\n\n## IoC\nIoC\"\", , \"\", . , , .\n, , new YourClass(). Spring, , ,, , : new YourClass(obj_1, obj_2, obj_3, ...), obj_nnew.\n, \"new\", , \"\", ., \"\", new, \"\".\n\"\", .\n, (), , setter()\n\n\n## IoC Service ProviderBeanFactoryXML\nIoC. IoC Service Provider, . , .\n\nSpringIoCIoC Service Provider, : BeanFactoryApplicationContext. ApplicationContextBeanFactory, .\n\nSpringPOJO, JavaBean. Spring, Spring, `@Configuration`, `@Component`, `@Service`. , IoC.\n\n, XML, XML, , , XML, : \n```xml\n<bean id=\"order\" class=\"..Order\">\n    <property name=\"orderItem\">\n        <ref bean=\"amazonOrderItem\">\n    </property>\n    <property name=\"orderAddress\">\n        <ref bean=\"amazonOrderAddress\">\n    </property>\n</bean>\n<bean id=\"amazonOrderItem\" class=\"..impl.AmazonOrderItem\"></bean>\n<bean id=\"amazonOrderAddress\" class=\"..impl.AmazonOrderAddress\"></bean>\n```\n\nBeanFactory()\n```java\npackage org.springframework.beans.factory;\n/**\n * The root interface for accessing a Spring bean container.\n * This is the basic client view of a bean container;\n * \n */\npublic interface BeanFactory {\n\tString FACTORY_BEAN_PREFIX = \"&\";\n\n\t/**\n\t * Return an instance, which may be shared or independent, of the specified bean.\n\t */\n\tObject getBean(String name) throws BeansException;\n\t<T> ObjectProvider<T> getBeanProvider(Class<T> requiredType);\n\tboolean containsBean(String name);\n\tboolean isSingleton(String name) throws NoSuchBeanDefinitionException;\n\tboolean isPrototype(String name) throws NoSuchBeanDefinitionException;\n\tboolean isTypeMatch(String name, ResolvableType typeToMatch) throws NoSuchBeanDefinitionException;\n\t@Nullable\n\tClass<?> getType(String name) throws NoSuchBeanDefinitionException;\n\tString[] getAliases(String name);\n}\n\n/** \n  * \"prototype\", \"singleton\"beanscope\n  * prototype scopebean, , \n  * BeanFactory\n  **/\n```\nBeanFactory, \"\"BeanFactory, :\n```java\nBeanFactory container = new XmlBeanFacotry(new ClassPathResource(\"XML_PATH\"));\n/**\n * ApplicationContext\n * ApplicationContext container = new ClassPathXmlApplication(\"XML_PATH\");\n**/\nOrder order = (Order)container.getBean(\"order\");\norder.persistOrderData();\n```\n\n, IoC, BeanFactory, , /->, . IoC., SpringXML</bean>, , \"\".\n\n### \n. , : ****, ,. .\n```java\npublic class Foo {\n    private BarInterface barInterface;\n    public Foo() {\n        // \n        // instance = new BarInterfaceImpl();\n    }\n}\n```\nFoo, `@Component``@Service`Spring IoC, . , BarInterface, . (Factory Method), . Foo, , , Foo.\n```java\npublic class Foo {\n    private BarInterface barInterface;\n    public Foo() {\n        // \n        // barInterface = BarInterfaceFactory.getInterface()\n        // , \n        // barInterface = new BarInterfaceFactory().getInstance();\n    }\n}\n// BarInterface. : \"\".\n```\nXML, , Spring\n```xml\n<bean id=\"foo\" class=\"...Foo\">\n    <property name=\"barInterface\">\n        <ref bean=\"bar\">\n    </property>\n</bean>\n<bean id=\"bar\" class=\"...StaticBarInterfaceFactory\" factory-method=\"getInstance\">\n```\nfactory-method, getInstance. , foobarBarInterfaceImpl.\n\n## \nSpring IoC, : Bean\n> :  >  > BeanDefinition >  ...\n- BeanDefinitionReaderConfiguration MetaData, BeanDefinitionRegistory\n> Bean:  >  >  >  >  ...\n- BeanBeanDefinitionBeanDefinitionRegistry. getBean, \n\n, .\n\n### \n\"\", :  ->  -> \nSpringBeanFactoryProcessor, BeanFactoryPostProcessor. : \n- PropertyPlaceholderConfigurer, properties.\n- CustomEditorConfigurer, XML. SpringJavaBeanPropertyEditorString, : StringArrayPropertyEditor(String[]), ClassEditor(Stringclass, class, Class.forName(String)).\n\n> , Processor, Djangomiddleware, Processor, , PropertyPlaceholderConfigurer > CustomEditorConfigurer > ..., Processor, . Spring, BeanSpring, .\n\n### \n, Bean. BeanDefinition. BeanFactory.getBean(), Bean. \n\n#### BeanBeanWrapper\n, \"(Strategy Pattern)\"bean, CGLIBbean, . , CglibSubclassingInstantiationStrategy.\n\n, BeanDefintion, CglibInstantiationStrategy. , , BeanWrapper, BeanWrapper. \n```java\nObject order = Class.forName(\"package.name.Order\").newInstance();\nObject orderItem = Class.forName(\"package.name.AmazonOrderItem\").newInstance();\nObject orderAddress = Class.forName(\"package.name.AmazonOrderAddress\").newInstace();\n\nBeanWrapper newOrder = new BeanWrapperImpl(order);\nnewOrder.setPropertyValue(\"newOrderItem\", orderItem);\nnewOrder.setPropertyValue(\"newOrderAddress\", orderAddress);\n\nassertTrue(newOrder.getWrappedInstance() instanceof Order);\nassertSame(order, newOrder.getWrappedInstance());\nassertSame(orderItem, newOrder.getPropertyValue(\"newOrderItem\"));\nassertSame(orderAddress, newOrder.getPropertyValue(\"newOrderAddress\"));\n```\n, , BeanWrapperImpl, AbstractNestablePropertyAccessor.\n```java\npackage org.springframework.beans;\npublic class BeanWrapperImpl extends AbstractNestablePropertyAccessor implements BeanWrapper {\n    // ...\n    public BeanWrapperImpl(Object object) {\n\t\tsuper(object);\n\t}\n    // ...\n}\n// ...\npublic abstract class AbstractNestablePropertyAccessor extends AbstractPropertyAccessor {\n    @Nullable\n\tObject wrappedObject;\n    // ...\n    public final Object getWrappedInstance() {\n\t\tAssert.state(this.wrappedObject != null, \"No wrapped object\");\n\t\treturn this.wrappedObject;\n\t}\n    protected AbstractNestablePropertyAccessor(Object object) {\n\t\tregisterDefaultEditors();\n\t\tsetWrappedInstance(object);\n\t}\n    public void setWrappedInstance(Object object) {\n\t\tsetWrappedInstance(object, \"\", null);\n\t}\n    public void setWrappedInstance(Object object, @Nullable String nestedPath, @Nullable Object rootObject) {\n\t\tthis.wrappedObject = ObjectUtils.unwrapOptional(object);\n\t\t// ...\n\t}\n    @Override\n\tpublic void setPropertyValue(String propertyName, @Nullable Object value) throws BeansException {\n\t\t// ... .\n\t}\n    // ...\n}\n```\n, , Spring, , , . \n\n#### \n, setbean, . SpringAware, Aware.\n, BeanNameAware, Spring, beanbeanName. BeanClassLoaderAware, beanClassLoader.\n\n#### ()\n, (hook), Spring, BeanPostProcessor. \nBeanPostProcessorBeanFactoryPostProcessor. BeanPostProcessor, BeanFactoryPostProcessor. BeanPostProcessor. , , , :\n```java\npackage org.springframework.beans.factory.config;\n\nimport org.springframework.beans.BeansException;\nimport org.springframework.lang.Nullable;\n\n/**\n * Factory hook that allows for custom modification of new bean instances,\n * e.g. checking for marker interfaces or wrapping them with proxies.\n *\n * <p>ApplicationContexts can autodetect BeanPostProcessor beans in their\n * bean definitions and apply them to any beans subsequently created.\n * Plain bean factories allow for programmatic registration of post-processors,\n * applying to all beans created through this factory.\n *\n * <p>Typically, post-processors that populate beans via marker interfaces\n * or the like will implement {@link #postProcessBeforeInitialization},\n * while post-processors that wrap beans with proxies will normally\n * implement {@link #postProcessAfterInitialization}.\n *\n * @author Juergen Hoeller\n * @since 10.10.2003\n * @see InstantiationAwareBeanPostProcessor\n * @see DestructionAwareBeanPostProcessor\n * @see ConfigurableBeanFactory#addBeanPostProcessor\n * @see BeanFactoryPostProcessor\n */\npublic interface BeanPostProcessor {\n\n\t/**\n\t * Apply this BeanPostProcessor to the given new bean instance <i>before</i> any bean\n\t * initialization callbacks (like InitializingBean's {@code afterPropertiesSet}\n\t * or a custom init-method). The bean will already be populated with property values.\n\t * The returned bean instance may be a wrapper around the original.\n\t * <p>The default implementation returns the given {@code bean} as-is.\n\t * @param bean the new bean instance\n\t * @param beanName the name of the bean\n\t * @return the bean instance to use, either the original or a wrapped one;\n\t * if {@code null}, no subsequent BeanPostProcessors will be invoked\n\t * @throws org.springframework.beans.BeansException in case of errors\n\t * @see org.springframework.beans.factory.InitializingBean#afterPropertiesSet\n\t */\n\t@Nullable\n\tdefault Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {\n\t\treturn bean;\n\t}\n\n\t/**\n\t * Apply this BeanPostProcessor to the given new bean instance <i>after</i> any bean\n\t * initialization callbacks (like InitializingBean's {@code afterPropertiesSet}\n\t * or a custom init-method). The bean will already be populated with property values.\n\t * The returned bean instance may be a wrapper around the original.\n\t * <p>In case of a FactoryBean, this callback will be invoked for both the FactoryBean\n\t * instance and the objects created by the FactoryBean (as of Spring 2.0). The\n\t * post-processor can decide whether to apply to either the FactoryBean or created\n\t * objects or both through corresponding {@code bean instanceof FactoryBean} checks.\n\t * <p>This callback will also be invoked after a short-circuiting triggered by a\n\t * {@link InstantiationAwareBeanPostProcessor#postProcessBeforeInstantiation} method,\n\t * in contrast to all other BeanPostProcessor callbacks.\n\t * <p>The default implementation returns the given {@code bean} as-is.\n\t * @param bean the new bean instance\n\t * @param beanName the name of the bean\n\t * @return the bean instance to use, either the original or a wrapped one;\n\t * if {@code null}, no subsequent BeanPostProcessors will be invoked\n\t * @throws org.springframework.beans.BeansException in case of errors\n\t * @see org.springframework.beans.factory.InitializingBean#afterPropertiesSet\n\t * @see org.springframework.beans.factory.FactoryBean\n\t */\n\t@Nullable\n\tdefault Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {\n\t\treturn bean;\n\t}\n\n}\n```\nBeanPostProcessor, implements BeanPostProcessor, bean.\n\n#### InitialzingBeaninit-method\n```java\npackage org.springframework.beans.factory;\n\n/**\n * Interface to be implemented by beans that need to react once all their properties\n * have been set by a {@link BeanFactory}: e.g. to perform custom initialization,\n * or merely to check that all mandatory properties have been set.\n *\n * <p>An alternative to implementing {@code InitializingBean} is specifying a custom\n * init method, for example in an XML bean definition. For a list of all bean\n * lifecycle methods, see the {@link BeanFactory BeanFactory javadocs}.\n *\n * @author Rod Johnson\n * @author Juergen Hoeller\n * @see DisposableBean\n * @see org.springframework.beans.factory.config.BeanDefinition#getPropertyValues()\n * @see org.springframework.beans.factory.support.AbstractBeanDefinition#getInitMethodName()\n */\npublic interface InitializingBean {\n\n\t/**\n\t * Invoked by the containing {@code BeanFactory} after it has set all bean properties\n\t * and satisfied {@link BeanFactoryAware}, {@code ApplicationContextAware} etc.\n\t * <p>This method allows the bean instance to perform validation of its overall\n\t * configuration and final initialization when all bean properties have been set.\n\t * @throws Exception in the event of misconfiguration (such as failure to set an\n\t * essential property) or if initialization fails for any other reason\n\t */\n\tvoid afterPropertiesSet() throws Exception;\n\n}\n```\nInitializingBean, \"BeanPostProcessor\", InitializingBean, , afterPropertiesSet(). \n, Spring, Spring, XML`<bean>`init-method, InitializingBeaninit-method.\n> , Spring, Spring.\n\n#### DisposableBeandestroy-method\n, , , , , singletonbean, DisposableBean. bean`<bean>`destory-method. , (Callback), singleton, .\n> , scopeprototypebean.\n\n\n## XML\nXML, .\n`@Autowired`. . `@Autowired`. , bean.\n\nAnnotation Processor, , SpringAutowiredAnnotationBeanPostProcessor. bean`@Autowired`. , , `@Autowired`. : \n```java\nObject[] beans = ...;\nfor (Objec bean: beans) {\n    if(autowiredExistsOnField(bean)){\n        Field f = getQulifiedField(bean);\n        setAccessiableIfNeccessary(f);\n        f.set(getBeanByTypeFromContainer());\n    }\n    if(autowiredExistsOnMethod(bean)) {\n        // ...\n    }\n    // ...\n}\n```\n\n`@Autowired`, @Qualifier, name(String). `@Qualifier`byName.\n\n#### classpath-scanning\n, xml. \", \", . classpath-scanning!\n(`@Component`, `@Service`, `@Configuration`), classpath-scanning(base package), , , BeanDefinition, BeanDefinition. \nclasspath-scanning`<context:component-scan>`. `<context:component-scan>``@Component`. , @Component`@Repository`, `@Service`/`@Controller`, . `@Component`, `@Service``@Repository`. , , `@Service`, `@Component`.\n\n\nSpring, Spring, BeanFactory, BeanPostProcessor, . \n\n","slug":"spring-ioc","published":1,"updated":"2021-12-30T03:04:59.355Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpz4001cxotg4oyh0xr2","content":"<p>, , , , , . Order</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Order</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> InterfaceItem orderItem;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> InterfaceAddress orderAddress;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">    Order (InterfaceItem orderItem, InterfaceAddress orderAddress, ...) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.orderItem = orderItem;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.orderAddress = orderAddress;</span><br><span class=\"line\">        <span class=\"comment\">// ...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">persistOrderData</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.save();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> AmazonOrderItem implements InterfaceItem &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> AmazonOrderAddress implements InterfaceItem &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"IoC\"><a href=\"#IoC\" class=\"headerlink\" title=\"IoC\"></a>IoC</h2><p>IoC, , , . , , .<br>, , new YourClass(). Spring, , ,, , : new YourClass(obj_1, obj_2, obj_3, ), obj_nnew.<br>, new, , , ., , new, .<br>, .<br>, (), , setter()</p>\n<h2 id=\"IoC-Service-ProviderBeanFactoryXML\"><a href=\"#IoC-Service-ProviderBeanFactoryXML\" class=\"headerlink\" title=\"IoC Service ProviderBeanFactoryXML\"></a>IoC Service ProviderBeanFactoryXML</h2><p>IoC. IoC Service Provider, . , .</p>\n<p>SpringIoCIoC Service Provider, : BeanFactoryApplicationContext. ApplicationContextBeanFactory, .</p>\n<p>SpringPOJO, JavaBean. Spring, Spring, <code>@Configuration</code>, <code>@Component</code>, <code>@Service</code>. , IoC.</p>\n<p>, XML, XML, , , XML, : </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;order&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;..Order&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;orderItem&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">ref</span> <span class=\"attr\">bean</span>=<span class=\"string\">&quot;amazonOrderItem&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;orderAddress&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">ref</span> <span class=\"attr\">bean</span>=<span class=\"string\">&quot;amazonOrderAddress&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;amazonOrderItem&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;..impl.AmazonOrderItem&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;amazonOrderAddress&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;..impl.AmazonOrderAddress&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>BeanFactory()</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.springframework.beans.factory;</span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * The root interface for accessing a Spring bean container.</span></span><br><span class=\"line\"><span class=\"comment\"> * This is the basic client view of a bean container;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">BeanFactory</span> </span>&#123;</span><br><span class=\"line\">\tString FACTORY_BEAN_PREFIX = <span class=\"string\">&quot;&amp;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Return an instance, which may be shared or independent, of the specified bean.</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\">Object <span class=\"title\">getBean</span><span class=\"params\">(String name)</span> <span class=\"keyword\">throws</span> BeansException</span>;</span><br><span class=\"line\">\t&lt;T&gt; <span class=\"function\">ObjectProvider&lt;T&gt; <span class=\"title\">getBeanProvider</span><span class=\"params\">(Class&lt;T&gt; requiredType)</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">containsBean</span><span class=\"params\">(String name)</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">isSingleton</span><span class=\"params\">(String name)</span> <span class=\"keyword\">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">isPrototype</span><span class=\"params\">(String name)</span> <span class=\"keyword\">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">isTypeMatch</span><span class=\"params\">(String name, ResolvableType typeToMatch)</span> <span class=\"keyword\">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\tClass&lt;?&gt; getType(String name) <span class=\"keyword\">throws</span> NoSuchBeanDefinitionException;</span><br><span class=\"line\">\tString[] getAliases(String name);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** </span></span><br><span class=\"line\"><span class=\"comment\">  * &quot;prototype&quot;, &quot;singleton&quot;beanscope</span></span><br><span class=\"line\"><span class=\"comment\">  * prototype scopebean, , </span></span><br><span class=\"line\"><span class=\"comment\">  * BeanFactory</span></span><br><span class=\"line\"><span class=\"comment\">  **/</span></span><br></pre></td></tr></table></figure>\n<p>BeanFactory, BeanFactory, :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BeanFactory container = <span class=\"keyword\">new</span> XmlBeanFacotry(<span class=\"keyword\">new</span> ClassPathResource(<span class=\"string\">&quot;XML_PATH&quot;</span>));</span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * ApplicationContext</span></span><br><span class=\"line\"><span class=\"comment\"> * ApplicationContext container = new ClassPathXmlApplication(&quot;XML_PATH&quot;);</span></span><br><span class=\"line\"><span class=\"comment\">**/</span></span><br><span class=\"line\">Order order = (Order)container.getBean(<span class=\"string\">&quot;order&quot;</span>);</span><br><span class=\"line\">order.persistOrderData();</span><br></pre></td></tr></table></figure>\n\n<p>, IoC, BeanFactory, , /-&gt;, . IoC., SpringXML</bean>, , .</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>. , : <strong></strong>, ,. .</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> BarInterface barInterface;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Foo</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"comment\">// instance = new BarInterfaceImpl();</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Foo, <code>@Component</code><code>@Service</code>Spring IoC, . , BarInterface, . (Factory Method), . Foo, , , Foo.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> BarInterface barInterface;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Foo</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"comment\">// barInterface = BarInterfaceFactory.getInterface()</span></span><br><span class=\"line\">        <span class=\"comment\">// , </span></span><br><span class=\"line\">        <span class=\"comment\">// barInterface = new BarInterfaceFactory().getInstance();</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// BarInterface. : &quot;&quot;.</span></span><br></pre></td></tr></table></figure>\n<p>XML, , Spring</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;foo&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;...Foo&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;barInterface&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">ref</span> <span class=\"attr\">bean</span>=<span class=\"string\">&quot;bar&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;bar&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;...StaticBarInterfaceFactory&quot;</span> <span class=\"attr\">factory-method</span>=<span class=\"string\">&quot;getInstance&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>factory-method, getInstance. , foobarBarInterfaceImpl.</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Spring IoC, : Bean</p>\n<blockquote>\n<p>:  &gt;  &gt; BeanDefinition &gt;  </p>\n</blockquote>\n<ul>\n<li>BeanDefinitionReaderConfiguration MetaData, BeanDefinitionRegistory<blockquote>\n<p>Bean:  &gt;  &gt;  &gt;  &gt;  </p>\n</blockquote>\n</li>\n<li>BeanBeanDefinitionBeanDefinitionRegistry. getBean, </li>\n</ul>\n<p>, .</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>, :  -&gt;  -&gt; <br>SpringBeanFactoryProcessor, BeanFactoryPostProcessor. : </p>\n<ul>\n<li>PropertyPlaceholderConfigurer, properties.</li>\n<li>CustomEditorConfigurer, XML. SpringJavaBeanPropertyEditorString, : StringArrayPropertyEditor(String[]), ClassEditor(Stringclass, class, Class.forName(String)).</li>\n</ul>\n<blockquote>\n<p>, Processor, Djangomiddleware, Processor, , PropertyPlaceholderConfigurer &gt; CustomEditorConfigurer &gt; , Processor, . Spring, BeanSpring, .</p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>, Bean. BeanDefinition. BeanFactory.getBean(), Bean. </p>\n<h4 id=\"BeanBeanWrapper\"><a href=\"#BeanBeanWrapper\" class=\"headerlink\" title=\"BeanBeanWrapper\"></a>BeanBeanWrapper</h4><p>, (Strategy Pattern)bean, CGLIBbean, . , CglibSubclassingInstantiationStrategy.</p>\n<p>, BeanDefintion, CglibInstantiationStrategy. , , BeanWrapper, BeanWrapper. </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Object order = Class.forName(<span class=\"string\">&quot;package.name.Order&quot;</span>).newInstance();</span><br><span class=\"line\">Object orderItem = Class.forName(<span class=\"string\">&quot;package.name.AmazonOrderItem&quot;</span>).newInstance();</span><br><span class=\"line\">Object orderAddress = Class.forName(<span class=\"string\">&quot;package.name.AmazonOrderAddress&quot;</span>).newInstace();</span><br><span class=\"line\"></span><br><span class=\"line\">BeanWrapper newOrder = <span class=\"keyword\">new</span> BeanWrapperImpl(order);</span><br><span class=\"line\">newOrder.setPropertyValue(<span class=\"string\">&quot;newOrderItem&quot;</span>, orderItem);</span><br><span class=\"line\">newOrder.setPropertyValue(<span class=\"string\">&quot;newOrderAddress&quot;</span>, orderAddress);</span><br><span class=\"line\"></span><br><span class=\"line\">assertTrue(newOrder.getWrappedInstance() <span class=\"keyword\">instanceof</span> Order);</span><br><span class=\"line\">assertSame(order, newOrder.getWrappedInstance());</span><br><span class=\"line\">assertSame(orderItem, newOrder.getPropertyValue(<span class=\"string\">&quot;newOrderItem&quot;</span>));</span><br><span class=\"line\">assertSame(orderAddress, newOrder.getPropertyValue(<span class=\"string\">&quot;newOrderAddress&quot;</span>));</span><br></pre></td></tr></table></figure>\n<p>, , BeanWrapperImpl, AbstractNestablePropertyAccessor.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.springframework.beans;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BeanWrapperImpl</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractNestablePropertyAccessor</span> <span class=\"keyword\">implements</span> <span class=\"title\">BeanWrapper</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">BeanWrapperImpl</span><span class=\"params\">(Object object)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">super</span>(object);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AbstractNestablePropertyAccessor</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractPropertyAccessor</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\tObject wrappedObject;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> Object <span class=\"title\">getWrappedInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\tAssert.state(<span class=\"keyword\">this</span>.wrappedObject != <span class=\"keyword\">null</span>, <span class=\"string\">&quot;No wrapped object&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.wrappedObject;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"title\">AbstractNestablePropertyAccessor</span><span class=\"params\">(Object object)</span> </span>&#123;</span><br><span class=\"line\">\t\tregisterDefaultEditors();</span><br><span class=\"line\">\t\tsetWrappedInstance(object);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setWrappedInstance</span><span class=\"params\">(Object object)</span> </span>&#123;</span><br><span class=\"line\">\t\tsetWrappedInstance(object, <span class=\"string\">&quot;&quot;</span>, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setWrappedInstance</span><span class=\"params\">(Object object, <span class=\"meta\">@Nullable</span> String nestedPath, <span class=\"meta\">@Nullable</span> Object rootObject)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.wrappedObject = ObjectUtils.unwrapOptional(object);</span><br><span class=\"line\">\t\t<span class=\"comment\">// ...</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setPropertyValue</span><span class=\"params\">(String propertyName, <span class=\"meta\">@Nullable</span> Object value)</span> <span class=\"keyword\">throws</span> BeansException </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// ... .</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>, , Spring, , , . </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>, setbean, . SpringAware, Aware.<br>, BeanNameAware, Spring, beanbeanName. BeanClassLoaderAware, beanClassLoader.</p>\n<h4 id=\"--\"><a href=\"#--\" class=\"headerlink\" title=\"()\"></a>()</h4><p>, (hook), Spring, BeanPostProcessor.<br>BeanPostProcessorBeanFactoryPostProcessor. BeanPostProcessor, BeanFactoryPostProcessor. BeanPostProcessor. , , , :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.springframework.beans.factory.config;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.BeansException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.lang.Nullable;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Factory hook that allows for custom modification of new bean instances,</span></span><br><span class=\"line\"><span class=\"comment\"> * e.g. checking for marker interfaces or wrapping them with proxies.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;ApplicationContexts can autodetect BeanPostProcessor beans in their</span></span><br><span class=\"line\"><span class=\"comment\"> * bean definitions and apply them to any beans subsequently created.</span></span><br><span class=\"line\"><span class=\"comment\"> * Plain bean factories allow for programmatic registration of post-processors,</span></span><br><span class=\"line\"><span class=\"comment\"> * applying to all beans created through this factory.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;Typically, post-processors that populate beans via marker interfaces</span></span><br><span class=\"line\"><span class=\"comment\"> * or the like will implement &#123;<span class=\"doctag\">@link</span> #postProcessBeforeInitialization&#125;,</span></span><br><span class=\"line\"><span class=\"comment\"> * while post-processors that wrap beans with proxies will normally</span></span><br><span class=\"line\"><span class=\"comment\"> * implement &#123;<span class=\"doctag\">@link</span> #postProcessAfterInitialization&#125;.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Juergen Hoeller</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 10.10.2003</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> InstantiationAwareBeanPostProcessor</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> DestructionAwareBeanPostProcessor</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> ConfigurableBeanFactory#addBeanPostProcessor</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> BeanFactoryPostProcessor</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">BeanPostProcessor</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Apply this BeanPostProcessor to the given new bean instance &lt;i&gt;before&lt;/i&gt; any bean</span></span><br><span class=\"line\"><span class=\"comment\">\t * initialization callbacks (like InitializingBean&#x27;s &#123;<span class=\"doctag\">@code</span> afterPropertiesSet&#125;</span></span><br><span class=\"line\"><span class=\"comment\">\t * or a custom init-method). The bean will already be populated with property values.</span></span><br><span class=\"line\"><span class=\"comment\">\t * The returned bean instance may be a wrapper around the original.</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;p&gt;The default implementation returns the given &#123;<span class=\"doctag\">@code</span> bean&#125; as-is.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> bean the new bean instance</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> beanName the name of the bean</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> the bean instance to use, either the original or a wrapped one;</span></span><br><span class=\"line\"><span class=\"comment\">\t * if &#123;<span class=\"doctag\">@code</span> null&#125;, no subsequent BeanPostProcessors will be invoked</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@throws</span> org.springframework.beans.BeansException in case of errors</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@see</span> org.springframework.beans.factory.InitializingBean#afterPropertiesSet</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">default</span> Object <span class=\"title\">postProcessBeforeInitialization</span><span class=\"params\">(Object bean, String beanName)</span> <span class=\"keyword\">throws</span> BeansException </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> bean;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Apply this BeanPostProcessor to the given new bean instance &lt;i&gt;after&lt;/i&gt; any bean</span></span><br><span class=\"line\"><span class=\"comment\">\t * initialization callbacks (like InitializingBean&#x27;s &#123;<span class=\"doctag\">@code</span> afterPropertiesSet&#125;</span></span><br><span class=\"line\"><span class=\"comment\">\t * or a custom init-method). The bean will already be populated with property values.</span></span><br><span class=\"line\"><span class=\"comment\">\t * The returned bean instance may be a wrapper around the original.</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;p&gt;In case of a FactoryBean, this callback will be invoked for both the FactoryBean</span></span><br><span class=\"line\"><span class=\"comment\">\t * instance and the objects created by the FactoryBean (as of Spring 2.0). The</span></span><br><span class=\"line\"><span class=\"comment\">\t * post-processor can decide whether to apply to either the FactoryBean or created</span></span><br><span class=\"line\"><span class=\"comment\">\t * objects or both through corresponding &#123;<span class=\"doctag\">@code</span> bean instanceof FactoryBean&#125; checks.</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;p&gt;This callback will also be invoked after a short-circuiting triggered by a</span></span><br><span class=\"line\"><span class=\"comment\">\t * &#123;<span class=\"doctag\">@link</span> InstantiationAwareBeanPostProcessor#postProcessBeforeInstantiation&#125; method,</span></span><br><span class=\"line\"><span class=\"comment\">\t * in contrast to all other BeanPostProcessor callbacks.</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;p&gt;The default implementation returns the given &#123;<span class=\"doctag\">@code</span> bean&#125; as-is.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> bean the new bean instance</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> beanName the name of the bean</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> the bean instance to use, either the original or a wrapped one;</span></span><br><span class=\"line\"><span class=\"comment\">\t * if &#123;<span class=\"doctag\">@code</span> null&#125;, no subsequent BeanPostProcessors will be invoked</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@throws</span> org.springframework.beans.BeansException in case of errors</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@see</span> org.springframework.beans.factory.InitializingBean#afterPropertiesSet</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@see</span> org.springframework.beans.factory.FactoryBean</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">default</span> Object <span class=\"title\">postProcessAfterInitialization</span><span class=\"params\">(Object bean, String beanName)</span> <span class=\"keyword\">throws</span> BeansException </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> bean;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>BeanPostProcessor, implements BeanPostProcessor, bean.</p>\n<h4 id=\"InitialzingBeaninit-method\"><a href=\"#InitialzingBeaninit-method\" class=\"headerlink\" title=\"InitialzingBeaninit-method\"></a>InitialzingBeaninit-method</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.springframework.beans.factory;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Interface to be implemented by beans that need to react once all their properties</span></span><br><span class=\"line\"><span class=\"comment\"> * have been set by a &#123;<span class=\"doctag\">@link</span> BeanFactory&#125;: e.g. to perform custom initialization,</span></span><br><span class=\"line\"><span class=\"comment\"> * or merely to check that all mandatory properties have been set.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;An alternative to implementing &#123;<span class=\"doctag\">@code</span> InitializingBean&#125; is specifying a custom</span></span><br><span class=\"line\"><span class=\"comment\"> * init method, for example in an XML bean definition. For a list of all bean</span></span><br><span class=\"line\"><span class=\"comment\"> * lifecycle methods, see the &#123;<span class=\"doctag\">@link</span> BeanFactory BeanFactory javadocs&#125;.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Rod Johnson</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Juergen Hoeller</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> DisposableBean</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> org.springframework.beans.factory.config.BeanDefinition#getPropertyValues()</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> org.springframework.beans.factory.support.AbstractBeanDefinition#getInitMethodName()</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">InitializingBean</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Invoked by the containing &#123;<span class=\"doctag\">@code</span> BeanFactory&#125; after it has set all bean properties</span></span><br><span class=\"line\"><span class=\"comment\">\t * and satisfied &#123;<span class=\"doctag\">@link</span> BeanFactoryAware&#125;, &#123;<span class=\"doctag\">@code</span> ApplicationContextAware&#125; etc.</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;p&gt;This method allows the bean instance to perform validation of its overall</span></span><br><span class=\"line\"><span class=\"comment\">\t * configuration and final initialization when all bean properties have been set.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@throws</span> Exception in the event of misconfiguration (such as failure to set an</span></span><br><span class=\"line\"><span class=\"comment\">\t * essential property) or if initialization fails for any other reason</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">afterPropertiesSet</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>InitializingBean, BeanPostProcessor, InitializingBean, , afterPropertiesSet().<br>, Spring, Spring, XML<code>&lt;bean&gt;</code>init-method, InitializingBeaninit-method.</p>\n<blockquote>\n<p>, Spring, Spring.</p>\n</blockquote>\n<h4 id=\"DisposableBeandestroy-method\"><a href=\"#DisposableBeandestroy-method\" class=\"headerlink\" title=\"DisposableBeandestroy-method\"></a>DisposableBeandestroy-method</h4><p>, , , , , singletonbean, DisposableBean. bean<code>&lt;bean&gt;</code>destory-method. , (Callback), singleton, .</p>\n<blockquote>\n<p>, scopeprototypebean.</p>\n</blockquote>\n<h2 id=\"XML\"><a href=\"#XML\" class=\"headerlink\" title=\"XML\"></a>XML</h2><p>XML, .<br><code>@Autowired</code>. . <code>@Autowired</code>. , bean.</p>\n<p>Annotation Processor, , SpringAutowiredAnnotationBeanPostProcessor. bean<code>@Autowired</code>. , , <code>@Autowired</code>. : </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Object[] beans = ...;</span><br><span class=\"line\"><span class=\"keyword\">for</span> (Objec bean: beans) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(autowiredExistsOnField(bean))&#123;</span><br><span class=\"line\">        Field f = getQulifiedField(bean);</span><br><span class=\"line\">        setAccessiableIfNeccessary(f);</span><br><span class=\"line\">        f.set(getBeanByTypeFromContainer());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(autowiredExistsOnMethod(bean)) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// ...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Autowired</code>, @Qualifier, name(String). <code>@Qualifier</code>byName.</p>\n<h4 id=\"classpath-scanning\"><a href=\"#classpath-scanning\" class=\"headerlink\" title=\"classpath-scanning\"></a>classpath-scanning</h4><p>, xml. , , . classpath-scanning!<br>(<code>@Component</code>, <code>@Service</code>, <code>@Configuration</code>), classpath-scanning(base package), , , BeanDefinition, BeanDefinition.<br>classpath-scanning<code>&lt;context:component-scan&gt;</code>. <code>&lt;context:component-scan&gt;</code><code>@Component</code>. , @Component<code>@Repository</code>, <code>@Service</code>/<code>@Controller</code>, . <code>@Component</code>, <code>@Service</code><code>@Repository</code>. , , <code>@Service</code>, <code>@Component</code>.</p>\n<p>Spring, Spring, BeanFactory, BeanPostProcessor, . </p>\n","site":{"data":{}},"excerpt":"","more":"<p>, , , , , . Order</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Order</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> InterfaceItem orderItem;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> InterfaceAddress orderAddress;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">    Order (InterfaceItem orderItem, InterfaceAddress orderAddress, ...) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.orderItem = orderItem;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.orderAddress = orderAddress;</span><br><span class=\"line\">        <span class=\"comment\">// ...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">persistOrderData</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.save();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> AmazonOrderItem implements InterfaceItem &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> AmazonOrderAddress implements InterfaceItem &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"IoC\"><a href=\"#IoC\" class=\"headerlink\" title=\"IoC\"></a>IoC</h2><p>IoC, , , . , , .<br>, , new YourClass(). Spring, , ,, , : new YourClass(obj_1, obj_2, obj_3, ), obj_nnew.<br>, new, , , ., , new, .<br>, .<br>, (), , setter()</p>\n<h2 id=\"IoC-Service-ProviderBeanFactoryXML\"><a href=\"#IoC-Service-ProviderBeanFactoryXML\" class=\"headerlink\" title=\"IoC Service ProviderBeanFactoryXML\"></a>IoC Service ProviderBeanFactoryXML</h2><p>IoC. IoC Service Provider, . , .</p>\n<p>SpringIoCIoC Service Provider, : BeanFactoryApplicationContext. ApplicationContextBeanFactory, .</p>\n<p>SpringPOJO, JavaBean. Spring, Spring, <code>@Configuration</code>, <code>@Component</code>, <code>@Service</code>. , IoC.</p>\n<p>, XML, XML, , , XML, : </p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;order&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;..Order&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;orderItem&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">ref</span> <span class=\"attr\">bean</span>=<span class=\"string\">&quot;amazonOrderItem&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;orderAddress&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">ref</span> <span class=\"attr\">bean</span>=<span class=\"string\">&quot;amazonOrderAddress&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;amazonOrderItem&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;..impl.AmazonOrderItem&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;amazonOrderAddress&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;..impl.AmazonOrderAddress&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>BeanFactory()</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.springframework.beans.factory;</span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * The root interface for accessing a Spring bean container.</span></span><br><span class=\"line\"><span class=\"comment\"> * This is the basic client view of a bean container;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">BeanFactory</span> </span>&#123;</span><br><span class=\"line\">\tString FACTORY_BEAN_PREFIX = <span class=\"string\">&quot;&amp;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Return an instance, which may be shared or independent, of the specified bean.</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\">Object <span class=\"title\">getBean</span><span class=\"params\">(String name)</span> <span class=\"keyword\">throws</span> BeansException</span>;</span><br><span class=\"line\">\t&lt;T&gt; <span class=\"function\">ObjectProvider&lt;T&gt; <span class=\"title\">getBeanProvider</span><span class=\"params\">(Class&lt;T&gt; requiredType)</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">containsBean</span><span class=\"params\">(String name)</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">isSingleton</span><span class=\"params\">(String name)</span> <span class=\"keyword\">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">isPrototype</span><span class=\"params\">(String name)</span> <span class=\"keyword\">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">isTypeMatch</span><span class=\"params\">(String name, ResolvableType typeToMatch)</span> <span class=\"keyword\">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\tClass&lt;?&gt; getType(String name) <span class=\"keyword\">throws</span> NoSuchBeanDefinitionException;</span><br><span class=\"line\">\tString[] getAliases(String name);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** </span></span><br><span class=\"line\"><span class=\"comment\">  * &quot;prototype&quot;, &quot;singleton&quot;beanscope</span></span><br><span class=\"line\"><span class=\"comment\">  * prototype scopebean, , </span></span><br><span class=\"line\"><span class=\"comment\">  * BeanFactory</span></span><br><span class=\"line\"><span class=\"comment\">  **/</span></span><br></pre></td></tr></table></figure>\n<p>BeanFactory, BeanFactory, :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BeanFactory container = <span class=\"keyword\">new</span> XmlBeanFacotry(<span class=\"keyword\">new</span> ClassPathResource(<span class=\"string\">&quot;XML_PATH&quot;</span>));</span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * ApplicationContext</span></span><br><span class=\"line\"><span class=\"comment\"> * ApplicationContext container = new ClassPathXmlApplication(&quot;XML_PATH&quot;);</span></span><br><span class=\"line\"><span class=\"comment\">**/</span></span><br><span class=\"line\">Order order = (Order)container.getBean(<span class=\"string\">&quot;order&quot;</span>);</span><br><span class=\"line\">order.persistOrderData();</span><br></pre></td></tr></table></figure>\n\n<p>, IoC, BeanFactory, , /-&gt;, . IoC., SpringXML</bean>, , .</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>. , : <strong></strong>, ,. .</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> BarInterface barInterface;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Foo</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"comment\">// instance = new BarInterfaceImpl();</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Foo, <code>@Component</code><code>@Service</code>Spring IoC, . , BarInterface, . (Factory Method), . Foo, , , Foo.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> BarInterface barInterface;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Foo</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"comment\">// barInterface = BarInterfaceFactory.getInterface()</span></span><br><span class=\"line\">        <span class=\"comment\">// , </span></span><br><span class=\"line\">        <span class=\"comment\">// barInterface = new BarInterfaceFactory().getInstance();</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// BarInterface. : &quot;&quot;.</span></span><br></pre></td></tr></table></figure>\n<p>XML, , Spring</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;foo&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;...Foo&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;barInterface&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">ref</span> <span class=\"attr\">bean</span>=<span class=\"string\">&quot;bar&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;bar&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;...StaticBarInterfaceFactory&quot;</span> <span class=\"attr\">factory-method</span>=<span class=\"string\">&quot;getInstance&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>factory-method, getInstance. , foobarBarInterfaceImpl.</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Spring IoC, : Bean</p>\n<blockquote>\n<p>:  &gt;  &gt; BeanDefinition &gt;  </p>\n</blockquote>\n<ul>\n<li>BeanDefinitionReaderConfiguration MetaData, BeanDefinitionRegistory<blockquote>\n<p>Bean:  &gt;  &gt;  &gt;  &gt;  </p>\n</blockquote>\n</li>\n<li>BeanBeanDefinitionBeanDefinitionRegistry. getBean, </li>\n</ul>\n<p>, .</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>, :  -&gt;  -&gt; <br>SpringBeanFactoryProcessor, BeanFactoryPostProcessor. : </p>\n<ul>\n<li>PropertyPlaceholderConfigurer, properties.</li>\n<li>CustomEditorConfigurer, XML. SpringJavaBeanPropertyEditorString, : StringArrayPropertyEditor(String[]), ClassEditor(Stringclass, class, Class.forName(String)).</li>\n</ul>\n<blockquote>\n<p>, Processor, Djangomiddleware, Processor, , PropertyPlaceholderConfigurer &gt; CustomEditorConfigurer &gt; , Processor, . Spring, BeanSpring, .</p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>, Bean. BeanDefinition. BeanFactory.getBean(), Bean. </p>\n<h4 id=\"BeanBeanWrapper\"><a href=\"#BeanBeanWrapper\" class=\"headerlink\" title=\"BeanBeanWrapper\"></a>BeanBeanWrapper</h4><p>, (Strategy Pattern)bean, CGLIBbean, . , CglibSubclassingInstantiationStrategy.</p>\n<p>, BeanDefintion, CglibInstantiationStrategy. , , BeanWrapper, BeanWrapper. </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Object order = Class.forName(<span class=\"string\">&quot;package.name.Order&quot;</span>).newInstance();</span><br><span class=\"line\">Object orderItem = Class.forName(<span class=\"string\">&quot;package.name.AmazonOrderItem&quot;</span>).newInstance();</span><br><span class=\"line\">Object orderAddress = Class.forName(<span class=\"string\">&quot;package.name.AmazonOrderAddress&quot;</span>).newInstace();</span><br><span class=\"line\"></span><br><span class=\"line\">BeanWrapper newOrder = <span class=\"keyword\">new</span> BeanWrapperImpl(order);</span><br><span class=\"line\">newOrder.setPropertyValue(<span class=\"string\">&quot;newOrderItem&quot;</span>, orderItem);</span><br><span class=\"line\">newOrder.setPropertyValue(<span class=\"string\">&quot;newOrderAddress&quot;</span>, orderAddress);</span><br><span class=\"line\"></span><br><span class=\"line\">assertTrue(newOrder.getWrappedInstance() <span class=\"keyword\">instanceof</span> Order);</span><br><span class=\"line\">assertSame(order, newOrder.getWrappedInstance());</span><br><span class=\"line\">assertSame(orderItem, newOrder.getPropertyValue(<span class=\"string\">&quot;newOrderItem&quot;</span>));</span><br><span class=\"line\">assertSame(orderAddress, newOrder.getPropertyValue(<span class=\"string\">&quot;newOrderAddress&quot;</span>));</span><br></pre></td></tr></table></figure>\n<p>, , BeanWrapperImpl, AbstractNestablePropertyAccessor.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.springframework.beans;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BeanWrapperImpl</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractNestablePropertyAccessor</span> <span class=\"keyword\">implements</span> <span class=\"title\">BeanWrapper</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">BeanWrapperImpl</span><span class=\"params\">(Object object)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">super</span>(object);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AbstractNestablePropertyAccessor</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractPropertyAccessor</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\tObject wrappedObject;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> Object <span class=\"title\">getWrappedInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\tAssert.state(<span class=\"keyword\">this</span>.wrappedObject != <span class=\"keyword\">null</span>, <span class=\"string\">&quot;No wrapped object&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.wrappedObject;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"title\">AbstractNestablePropertyAccessor</span><span class=\"params\">(Object object)</span> </span>&#123;</span><br><span class=\"line\">\t\tregisterDefaultEditors();</span><br><span class=\"line\">\t\tsetWrappedInstance(object);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setWrappedInstance</span><span class=\"params\">(Object object)</span> </span>&#123;</span><br><span class=\"line\">\t\tsetWrappedInstance(object, <span class=\"string\">&quot;&quot;</span>, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setWrappedInstance</span><span class=\"params\">(Object object, <span class=\"meta\">@Nullable</span> String nestedPath, <span class=\"meta\">@Nullable</span> Object rootObject)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.wrappedObject = ObjectUtils.unwrapOptional(object);</span><br><span class=\"line\">\t\t<span class=\"comment\">// ...</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setPropertyValue</span><span class=\"params\">(String propertyName, <span class=\"meta\">@Nullable</span> Object value)</span> <span class=\"keyword\">throws</span> BeansException </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// ... .</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>, , Spring, , , . </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>, setbean, . SpringAware, Aware.<br>, BeanNameAware, Spring, beanbeanName. BeanClassLoaderAware, beanClassLoader.</p>\n<h4 id=\"--\"><a href=\"#--\" class=\"headerlink\" title=\"()\"></a>()</h4><p>, (hook), Spring, BeanPostProcessor.<br>BeanPostProcessorBeanFactoryPostProcessor. BeanPostProcessor, BeanFactoryPostProcessor. BeanPostProcessor. , , , :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.springframework.beans.factory.config;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.BeansException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.lang.Nullable;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Factory hook that allows for custom modification of new bean instances,</span></span><br><span class=\"line\"><span class=\"comment\"> * e.g. checking for marker interfaces or wrapping them with proxies.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;ApplicationContexts can autodetect BeanPostProcessor beans in their</span></span><br><span class=\"line\"><span class=\"comment\"> * bean definitions and apply them to any beans subsequently created.</span></span><br><span class=\"line\"><span class=\"comment\"> * Plain bean factories allow for programmatic registration of post-processors,</span></span><br><span class=\"line\"><span class=\"comment\"> * applying to all beans created through this factory.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;Typically, post-processors that populate beans via marker interfaces</span></span><br><span class=\"line\"><span class=\"comment\"> * or the like will implement &#123;<span class=\"doctag\">@link</span> #postProcessBeforeInitialization&#125;,</span></span><br><span class=\"line\"><span class=\"comment\"> * while post-processors that wrap beans with proxies will normally</span></span><br><span class=\"line\"><span class=\"comment\"> * implement &#123;<span class=\"doctag\">@link</span> #postProcessAfterInitialization&#125;.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Juergen Hoeller</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 10.10.2003</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> InstantiationAwareBeanPostProcessor</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> DestructionAwareBeanPostProcessor</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> ConfigurableBeanFactory#addBeanPostProcessor</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> BeanFactoryPostProcessor</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">BeanPostProcessor</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Apply this BeanPostProcessor to the given new bean instance &lt;i&gt;before&lt;/i&gt; any bean</span></span><br><span class=\"line\"><span class=\"comment\">\t * initialization callbacks (like InitializingBean&#x27;s &#123;<span class=\"doctag\">@code</span> afterPropertiesSet&#125;</span></span><br><span class=\"line\"><span class=\"comment\">\t * or a custom init-method). The bean will already be populated with property values.</span></span><br><span class=\"line\"><span class=\"comment\">\t * The returned bean instance may be a wrapper around the original.</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;p&gt;The default implementation returns the given &#123;<span class=\"doctag\">@code</span> bean&#125; as-is.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> bean the new bean instance</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> beanName the name of the bean</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> the bean instance to use, either the original or a wrapped one;</span></span><br><span class=\"line\"><span class=\"comment\">\t * if &#123;<span class=\"doctag\">@code</span> null&#125;, no subsequent BeanPostProcessors will be invoked</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@throws</span> org.springframework.beans.BeansException in case of errors</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@see</span> org.springframework.beans.factory.InitializingBean#afterPropertiesSet</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">default</span> Object <span class=\"title\">postProcessBeforeInitialization</span><span class=\"params\">(Object bean, String beanName)</span> <span class=\"keyword\">throws</span> BeansException </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> bean;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Apply this BeanPostProcessor to the given new bean instance &lt;i&gt;after&lt;/i&gt; any bean</span></span><br><span class=\"line\"><span class=\"comment\">\t * initialization callbacks (like InitializingBean&#x27;s &#123;<span class=\"doctag\">@code</span> afterPropertiesSet&#125;</span></span><br><span class=\"line\"><span class=\"comment\">\t * or a custom init-method). The bean will already be populated with property values.</span></span><br><span class=\"line\"><span class=\"comment\">\t * The returned bean instance may be a wrapper around the original.</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;p&gt;In case of a FactoryBean, this callback will be invoked for both the FactoryBean</span></span><br><span class=\"line\"><span class=\"comment\">\t * instance and the objects created by the FactoryBean (as of Spring 2.0). The</span></span><br><span class=\"line\"><span class=\"comment\">\t * post-processor can decide whether to apply to either the FactoryBean or created</span></span><br><span class=\"line\"><span class=\"comment\">\t * objects or both through corresponding &#123;<span class=\"doctag\">@code</span> bean instanceof FactoryBean&#125; checks.</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;p&gt;This callback will also be invoked after a short-circuiting triggered by a</span></span><br><span class=\"line\"><span class=\"comment\">\t * &#123;<span class=\"doctag\">@link</span> InstantiationAwareBeanPostProcessor#postProcessBeforeInstantiation&#125; method,</span></span><br><span class=\"line\"><span class=\"comment\">\t * in contrast to all other BeanPostProcessor callbacks.</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;p&gt;The default implementation returns the given &#123;<span class=\"doctag\">@code</span> bean&#125; as-is.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> bean the new bean instance</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@param</span> beanName the name of the bean</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span> the bean instance to use, either the original or a wrapped one;</span></span><br><span class=\"line\"><span class=\"comment\">\t * if &#123;<span class=\"doctag\">@code</span> null&#125;, no subsequent BeanPostProcessors will be invoked</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@throws</span> org.springframework.beans.BeansException in case of errors</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@see</span> org.springframework.beans.factory.InitializingBean#afterPropertiesSet</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@see</span> org.springframework.beans.factory.FactoryBean</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"meta\">@Nullable</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">default</span> Object <span class=\"title\">postProcessAfterInitialization</span><span class=\"params\">(Object bean, String beanName)</span> <span class=\"keyword\">throws</span> BeansException </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> bean;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>BeanPostProcessor, implements BeanPostProcessor, bean.</p>\n<h4 id=\"InitialzingBeaninit-method\"><a href=\"#InitialzingBeaninit-method\" class=\"headerlink\" title=\"InitialzingBeaninit-method\"></a>InitialzingBeaninit-method</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> org.springframework.beans.factory;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Interface to be implemented by beans that need to react once all their properties</span></span><br><span class=\"line\"><span class=\"comment\"> * have been set by a &#123;<span class=\"doctag\">@link</span> BeanFactory&#125;: e.g. to perform custom initialization,</span></span><br><span class=\"line\"><span class=\"comment\"> * or merely to check that all mandatory properties have been set.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;An alternative to implementing &#123;<span class=\"doctag\">@code</span> InitializingBean&#125; is specifying a custom</span></span><br><span class=\"line\"><span class=\"comment\"> * init method, for example in an XML bean definition. For a list of all bean</span></span><br><span class=\"line\"><span class=\"comment\"> * lifecycle methods, see the &#123;<span class=\"doctag\">@link</span> BeanFactory BeanFactory javadocs&#125;.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Rod Johnson</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Juergen Hoeller</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> DisposableBean</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> org.springframework.beans.factory.config.BeanDefinition#getPropertyValues()</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> org.springframework.beans.factory.support.AbstractBeanDefinition#getInitMethodName()</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">InitializingBean</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Invoked by the containing &#123;<span class=\"doctag\">@code</span> BeanFactory&#125; after it has set all bean properties</span></span><br><span class=\"line\"><span class=\"comment\">\t * and satisfied &#123;<span class=\"doctag\">@link</span> BeanFactoryAware&#125;, &#123;<span class=\"doctag\">@code</span> ApplicationContextAware&#125; etc.</span></span><br><span class=\"line\"><span class=\"comment\">\t * &lt;p&gt;This method allows the bean instance to perform validation of its overall</span></span><br><span class=\"line\"><span class=\"comment\">\t * configuration and final initialization when all bean properties have been set.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@throws</span> Exception in the event of misconfiguration (such as failure to set an</span></span><br><span class=\"line\"><span class=\"comment\">\t * essential property) or if initialization fails for any other reason</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">afterPropertiesSet</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>InitializingBean, BeanPostProcessor, InitializingBean, , afterPropertiesSet().<br>, Spring, Spring, XML<code>&lt;bean&gt;</code>init-method, InitializingBeaninit-method.</p>\n<blockquote>\n<p>, Spring, Spring.</p>\n</blockquote>\n<h4 id=\"DisposableBeandestroy-method\"><a href=\"#DisposableBeandestroy-method\" class=\"headerlink\" title=\"DisposableBeandestroy-method\"></a>DisposableBeandestroy-method</h4><p>, , , , , singletonbean, DisposableBean. bean<code>&lt;bean&gt;</code>destory-method. , (Callback), singleton, .</p>\n<blockquote>\n<p>, scopeprototypebean.</p>\n</blockquote>\n<h2 id=\"XML\"><a href=\"#XML\" class=\"headerlink\" title=\"XML\"></a>XML</h2><p>XML, .<br><code>@Autowired</code>. . <code>@Autowired</code>. , bean.</p>\n<p>Annotation Processor, , SpringAutowiredAnnotationBeanPostProcessor. bean<code>@Autowired</code>. , , <code>@Autowired</code>. : </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Object[] beans = ...;</span><br><span class=\"line\"><span class=\"keyword\">for</span> (Objec bean: beans) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(autowiredExistsOnField(bean))&#123;</span><br><span class=\"line\">        Field f = getQulifiedField(bean);</span><br><span class=\"line\">        setAccessiableIfNeccessary(f);</span><br><span class=\"line\">        f.set(getBeanByTypeFromContainer());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(autowiredExistsOnMethod(bean)) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// ...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Autowired</code>, @Qualifier, name(String). <code>@Qualifier</code>byName.</p>\n<h4 id=\"classpath-scanning\"><a href=\"#classpath-scanning\" class=\"headerlink\" title=\"classpath-scanning\"></a>classpath-scanning</h4><p>, xml. , , . classpath-scanning!<br>(<code>@Component</code>, <code>@Service</code>, <code>@Configuration</code>), classpath-scanning(base package), , , BeanDefinition, BeanDefinition.<br>classpath-scanning<code>&lt;context:component-scan&gt;</code>. <code>&lt;context:component-scan&gt;</code><code>@Component</code>. , @Component<code>@Repository</code>, <code>@Service</code>/<code>@Controller</code>, . <code>@Component</code>, <code>@Service</code><code>@Repository</code>. , , <code>@Service</code>, <code>@Component</code>.</p>\n<p>Spring, Spring, BeanFactory, BeanPostProcessor, . </p>\n"},{"title":"","date":"2021-11-12T06:49:19.000Z","_content":"\n\n\n\n\nBrainfuck\n\n# \n\nTuring Machine1936 \"On Computable Numbers, with an Application to the Entscheidungsproblem\"\n\ntapesquaresymbolalphabetblankhead///state register/instructions table5301\n\n\n\nconfiguration\n - \n - \n\n...011001...\n\n 12345 \n\n# \n\nComputation Theory\nComputational Problem\n> A computational problem is a mathematical object representing a collection of questions that computers might be able to solve.\n\n\n -  n\n -  01 \n - \n - \n\n - \n - \n\nComputability 1 n 2 n-1 n  1 \n\nHalting Problem\n > Halting Problem: given the description of an arbitrary program and a finite input, decide whether the program finishes running or will run forever. \n\nUndecidable Problem\n\n\n\n# \n\nTuring Completenessif/else while \n\n Brainfuck \n\n# Brainfuck \n\nC++JavaPython1993Urban Mller  Brainfuck  helloworld  8 \n > Brainfuck is fully Turing-complete.\n\n BF \n```Brainfuck\n++++++++[>++++[>++>+++>+++>+<<<<-]>+>+>->>+[<]<-]>>.>---.+++++++..+++.>>.<-.<.+++\n.------.--------.>>+.>++.\n```\n \"Hello World!\"\n\nBF  0//\n\n 8 \n - `>` ---- \n - `<` ---- \n - `+` ---- \n - `-` ---- \n - `.` ----  ASCII \n - `,` ----  byte  ASCII \n - `[` ----  0  `]` \n - `]` ----  `[` \n\n ASCII  'A'  65 5 * 13  65  'A'\n```Brainfuck\n+++++\n[\n>+++++++++++++\n<-\n]\n>.\n```\n\n cell 0cell 0  cell 1 5  5 13   1  cell 0  0  cell 1  5  13  65 cell 1 'A'\n\n","source":"_posts/theory-turing-completeness.md","raw":"---\ntitle: \ndate: 2021-11-12 14:49:19\ncategories:\n- \ntags:\n- Turing\n---\n\n\n\n\n\nBrainfuck\n\n# \n\nTuring Machine1936 \"On Computable Numbers, with an Application to the Entscheidungsproblem\"\n\ntapesquaresymbolalphabetblankhead///state register/instructions table5301\n\n\n\nconfiguration\n - \n - \n\n...011001...\n\n 12345 \n\n# \n\nComputation Theory\nComputational Problem\n> A computational problem is a mathematical object representing a collection of questions that computers might be able to solve.\n\n\n -  n\n -  01 \n - \n - \n\n - \n - \n\nComputability 1 n 2 n-1 n  1 \n\nHalting Problem\n > Halting Problem: given the description of an arbitrary program and a finite input, decide whether the program finishes running or will run forever. \n\nUndecidable Problem\n\n\n\n# \n\nTuring Completenessif/else while \n\n Brainfuck \n\n# Brainfuck \n\nC++JavaPython1993Urban Mller  Brainfuck  helloworld  8 \n > Brainfuck is fully Turing-complete.\n\n BF \n```Brainfuck\n++++++++[>++++[>++>+++>+++>+<<<<-]>+>+>->>+[<]<-]>>.>---.+++++++..+++.>>.<-.<.+++\n.------.--------.>>+.>++.\n```\n \"Hello World!\"\n\nBF  0//\n\n 8 \n - `>` ---- \n - `<` ---- \n - `+` ---- \n - `-` ---- \n - `.` ----  ASCII \n - `,` ----  byte  ASCII \n - `[` ----  0  `]` \n - `]` ----  `[` \n\n ASCII  'A'  65 5 * 13  65  'A'\n```Brainfuck\n+++++\n[\n>+++++++++++++\n<-\n]\n>.\n```\n\n cell 0cell 0  cell 1 5  5 13   1  cell 0  0  cell 1  5  13  65 cell 1 'A'\n\n","slug":"theory-turing-completeness","published":1,"updated":"2021-12-30T03:05:08.334Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckxsdzpz5001exotg5gzjgm4a","content":"<p><br><br><br><br>Brainfuck</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Turing Machine1936 On Computable Numbers, with an Application to the Entscheidungsproblem</p>\n<p>tapesquaresymbolalphabetblankhead///state register/instructions table5301</p>\n<p>configuration</p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p>011001</p>\n<p> 12345 </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Computation Theory<br>Computational Problem</p>\n<blockquote>\n<p>A computational problem is a mathematical object representing a collection of questions that computers might be able to solve.</p>\n</blockquote>\n<p></p>\n<ul>\n<li> n</li>\n<li> 01 </li>\n<li></li>\n<li><br></li>\n<li></li>\n<li></li>\n</ul>\n<p>Computability 1 n 2 n-1 n  1 </p>\n<p>Halting Problem</p>\n<blockquote>\n<p>Halting Problem: given the description of an arbitrary program and a finite input, decide whether the program finishes running or will run forever. </p>\n</blockquote>\n<p>Undecidable Problem</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Turing Completenessif/else while </p>\n<p> Brainfuck </p>\n<h1 id=\"Brainfuck-\"><a href=\"#Brainfuck-\" class=\"headerlink\" title=\"Brainfuck \"></a>Brainfuck </h1><p>C++JavaPython1993Urban Mller  Brainfuck  helloworld  8 </p>\n<blockquote>\n<p>Brainfuck is fully Turing-complete.</p>\n</blockquote>\n<p> BF </p>\n<figure class=\"highlight brainfuck\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">++<span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"title\">[</span>&gt;++<span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"title\">[</span>&gt;++&gt;++<span class=\"literal\">+</span>&gt;++<span class=\"literal\">+</span>&gt;<span class=\"literal\">+</span>&lt;&lt;&lt;&lt;<span class=\"literal\">-</span><span class=\"title\">]</span>&gt;<span class=\"literal\">+</span>&gt;<span class=\"literal\">+</span>&gt;<span class=\"literal\">-</span>&gt;&gt;<span class=\"literal\">+</span><span class=\"title\">[</span>&lt;<span class=\"title\">]</span>&lt;<span class=\"literal\">-</span><span class=\"title\">]</span>&gt;&gt;<span class=\"string\">.</span>&gt;--<span class=\"literal\">-</span><span class=\"string\">.</span>++<span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"string\">.</span><span class=\"string\">.</span>++<span class=\"literal\">+</span><span class=\"string\">.</span>&gt;&gt;<span class=\"string\">.</span>&lt;<span class=\"literal\">-</span><span class=\"string\">.</span>&lt;<span class=\"string\">.</span>++<span class=\"literal\">+</span></span><br><span class=\"line\"><span class=\"string\">.</span>--<span class=\"literal\">-</span><span class=\"literal\">-</span><span class=\"literal\">-</span><span class=\"literal\">-</span><span class=\"string\">.</span>--<span class=\"literal\">-</span><span class=\"literal\">-</span><span class=\"literal\">-</span><span class=\"literal\">-</span><span class=\"literal\">-</span><span class=\"literal\">-</span><span class=\"string\">.</span>&gt;&gt;<span class=\"literal\">+</span><span class=\"string\">.</span>&gt;++<span class=\"string\">.</span></span><br></pre></td></tr></table></figure>\n<p> Hello World!</p>\n<p>BF  0//</p>\n<p> 8 </p>\n<ul>\n<li><code>&gt;</code> - </li>\n<li><code>&lt;</code> - </li>\n<li><code>+</code> - </li>\n<li><code>-</code> - </li>\n<li><code>.</code> -  ASCII </li>\n<li><code>,</code> -  byte  ASCII </li>\n<li><code>[</code> -  0  <code>]</code> </li>\n<li><code>]</code> -  <code>[</code> </li>\n</ul>\n<p> ASCII  A  65 5 * 13  65  A</p>\n<figure class=\"highlight brainfuck\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">++<span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span></span><br><span class=\"line\"><span class=\"title\">[</span></span><br><span class=\"line\">&gt;++<span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span></span><br><span class=\"line\">&lt;<span class=\"literal\">-</span></span><br><span class=\"line\"><span class=\"title\">]</span></span><br><span class=\"line\">&gt;<span class=\"string\">.</span></span><br></pre></td></tr></table></figure>\n\n<p> cell 0cell 0  cell 1 5  5 13   1  cell 0  0  cell 1  5  13  65 cell 1 A</p>\n<p></p>\n","site":{"data":{}},"excerpt":"","more":"<p><br><br><br><br>Brainfuck</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Turing Machine1936 On Computable Numbers, with an Application to the Entscheidungsproblem</p>\n<p>tapesquaresymbolalphabetblankhead///state register/instructions table5301</p>\n<p>configuration</p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p>011001</p>\n<p> 12345 </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Computation Theory<br>Computational Problem</p>\n<blockquote>\n<p>A computational problem is a mathematical object representing a collection of questions that computers might be able to solve.</p>\n</blockquote>\n<p></p>\n<ul>\n<li> n</li>\n<li> 01 </li>\n<li></li>\n<li><br></li>\n<li></li>\n<li></li>\n</ul>\n<p>Computability 1 n 2 n-1 n  1 </p>\n<p>Halting Problem</p>\n<blockquote>\n<p>Halting Problem: given the description of an arbitrary program and a finite input, decide whether the program finishes running or will run forever. </p>\n</blockquote>\n<p>Undecidable Problem</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Turing Completenessif/else while </p>\n<p> Brainfuck </p>\n<h1 id=\"Brainfuck-\"><a href=\"#Brainfuck-\" class=\"headerlink\" title=\"Brainfuck \"></a>Brainfuck </h1><p>C++JavaPython1993Urban Mller  Brainfuck  helloworld  8 </p>\n<blockquote>\n<p>Brainfuck is fully Turing-complete.</p>\n</blockquote>\n<p> BF </p>\n<figure class=\"highlight brainfuck\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">++<span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"title\">[</span>&gt;++<span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"title\">[</span>&gt;++&gt;++<span class=\"literal\">+</span>&gt;++<span class=\"literal\">+</span>&gt;<span class=\"literal\">+</span>&lt;&lt;&lt;&lt;<span class=\"literal\">-</span><span class=\"title\">]</span>&gt;<span class=\"literal\">+</span>&gt;<span class=\"literal\">+</span>&gt;<span class=\"literal\">-</span>&gt;&gt;<span class=\"literal\">+</span><span class=\"title\">[</span>&lt;<span class=\"title\">]</span>&lt;<span class=\"literal\">-</span><span class=\"title\">]</span>&gt;&gt;<span class=\"string\">.</span>&gt;--<span class=\"literal\">-</span><span class=\"string\">.</span>++<span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"string\">.</span><span class=\"string\">.</span>++<span class=\"literal\">+</span><span class=\"string\">.</span>&gt;&gt;<span class=\"string\">.</span>&lt;<span class=\"literal\">-</span><span class=\"string\">.</span>&lt;<span class=\"string\">.</span>++<span class=\"literal\">+</span></span><br><span class=\"line\"><span class=\"string\">.</span>--<span class=\"literal\">-</span><span class=\"literal\">-</span><span class=\"literal\">-</span><span class=\"literal\">-</span><span class=\"string\">.</span>--<span class=\"literal\">-</span><span class=\"literal\">-</span><span class=\"literal\">-</span><span class=\"literal\">-</span><span class=\"literal\">-</span><span class=\"literal\">-</span><span class=\"string\">.</span>&gt;&gt;<span class=\"literal\">+</span><span class=\"string\">.</span>&gt;++<span class=\"string\">.</span></span><br></pre></td></tr></table></figure>\n<p> Hello World!</p>\n<p>BF  0//</p>\n<p> 8 </p>\n<ul>\n<li><code>&gt;</code> - </li>\n<li><code>&lt;</code> - </li>\n<li><code>+</code> - </li>\n<li><code>-</code> - </li>\n<li><code>.</code> -  ASCII </li>\n<li><code>,</code> -  byte  ASCII </li>\n<li><code>[</code> -  0  <code>]</code> </li>\n<li><code>]</code> -  <code>[</code> </li>\n</ul>\n<p> ASCII  A  65 5 * 13  65  A</p>\n<figure class=\"highlight brainfuck\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">++<span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span></span><br><span class=\"line\"><span class=\"title\">[</span></span><br><span class=\"line\">&gt;++<span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span><span class=\"literal\">+</span></span><br><span class=\"line\">&lt;<span class=\"literal\">-</span></span><br><span class=\"line\"><span class=\"title\">]</span></span><br><span class=\"line\">&gt;<span class=\"string\">.</span></span><br></pre></td></tr></table></figure>\n\n<p> cell 0cell 0  cell 1 5  5 13   1  cell 0  0  cell 1  5  13  65 cell 1 A</p>\n<p></p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"ckxsdzpxx0001xotg65yafs9i","category_id":"ckxsdzpy50004xotg087w2j5w","_id":"ckxsdzpyg000cxotgb8b3azcx"},{"post_id":"ckxsdzpy80006xotgf8gsfdnb","category_id":"ckxsdzpyd0009xotg7114am3u","_id":"ckxsdzpyk000hxotg00i261ua"},{"post_id":"ckxsdzpya0007xotg13uchtu0","category_id":"ckxsdzpyg000dxotgbnsjarwf","_id":"ckxsdzpyr000nxotgc4c560jw"},{"post_id":"ckxsdzpyj000gxotgc1s61qa7","category_id":"ckxsdzpyg000dxotgbnsjarwf","_id":"ckxsdzpyt000qxotg2psu7m3t"},{"post_id":"ckxsdzpym000jxotg96oo7rra","category_id":"ckxsdzpyg000dxotgbnsjarwf","_id":"ckxsdzpyv000txotghwu5gul0"},{"post_id":"ckxsdzpyb0008xotgekce7p56","category_id":"ckxsdzpyg000dxotgbnsjarwf","_id":"ckxsdzpyx000xxotg47vl5955"},{"post_id":"ckxsdzpys000pxotga2iw86jk","category_id":"ckxsdzpyg000dxotgbnsjarwf","_id":"ckxsdzpyz0010xotg60gvh9zt"},{"post_id":"ckxsdzpye000axotg528s5jom","category_id":"ckxsdzpyr000mxotge5xqgrtr","_id":"ckxsdzpz10014xotg2seb2b9r"},{"post_id":"ckxsdzpyt000rxotg46dx0vzu","category_id":"ckxsdzpyg000dxotgbnsjarwf","_id":"ckxsdzpz20016xotgc26tgpbq"},{"post_id":"ckxsdzpyv000vxotgg27783me","category_id":"ckxsdzpy50004xotg087w2j5w","_id":"ckxsdzpz4001bxotg9wql1wqt"},{"post_id":"ckxsdzpyf000bxotg7gxz7t70","category_id":"ckxsdzpyg000dxotgbnsjarwf","_id":"ckxsdzpz5001dxotg60rlcens"},{"post_id":"ckxsdzpyh000exotg922w7a6o","category_id":"ckxsdzpyg000dxotgbnsjarwf","_id":"ckxsdzpz7001hxotgbk018ip4"},{"post_id":"ckxsdzpyh000exotg922w7a6o","category_id":"ckxsdzpyz0011xotgeu895910","_id":"ckxsdzpz8001jxotg4omba035"},{"post_id":"ckxsdzpyp000kxotg3azoa26w","category_id":"ckxsdzpyg000dxotgbnsjarwf","_id":"ckxsdzpz9001mxotgdczka4z2"},{"post_id":"ckxsdzpyp000kxotg3azoa26w","category_id":"ckxsdzpyz0011xotgeu895910","_id":"ckxsdzpz9001oxotgffzs8q8r"},{"post_id":"ckxsdzpyx000yxotgbky136mi","category_id":"ckxsdzpz6001gxotg7vrz8bz1","_id":"ckxsdzpza001rxotg92d5djh5"},{"post_id":"ckxsdzpz10015xotgg4ppd5tt","category_id":"ckxsdzpz8001lxotg3mw83p5p","_id":"ckxsdzpzb001uxotgcuug41te"},{"post_id":"ckxsdzpz20018xotg9bmc867m","category_id":"ckxsdzpz8001lxotg3mw83p5p","_id":"ckxsdzpzd001xxotgdh9qbznw"},{"post_id":"ckxsdzpz4001cxotg4oyh0xr2","category_id":"ckxsdzpz8001lxotg3mw83p5p","_id":"ckxsdzpzd0020xotgg73tfg9o"},{"post_id":"ckxsdzpz5001exotg5gzjgm4a","category_id":"ckxsdzpzc001wxotgff1x5cxf","_id":"ckxsdzpze0023xotgfww761z6"}],"PostTag":[{"post_id":"ckxsdzpyf000bxotg7gxz7t70","tag_id":"ckxsdzpyi000fxotgd0yyb9ex","_id":"ckxsdzpyr000oxotghbbebugp"},{"post_id":"ckxsdzpyh000exotg922w7a6o","tag_id":"ckxsdzpyq000lxotg45b2176h","_id":"ckxsdzpyw000wxotg5cni6u0x"},{"post_id":"ckxsdzpyp000kxotg3azoa26w","tag_id":"ckxsdzpyu000sxotgcam3a7tb","_id":"ckxsdzpz00013xotg4sunhnzj"},{"post_id":"ckxsdzpys000pxotga2iw86jk","tag_id":"ckxsdzpyy000zxotgczl1e2u0","_id":"ckxsdzpz4001axotg19cx2dcs"},{"post_id":"ckxsdzpyt000rxotg46dx0vzu","tag_id":"ckxsdzpz20017xotgbr7mgmya","_id":"ckxsdzpz7001ixotga83l85re"},{"post_id":"ckxsdzpyv000vxotgg27783me","tag_id":"ckxsdzpz6001fxotg9681c32n","_id":"ckxsdzpz9001nxotg0n6t06re"},{"post_id":"ckxsdzpyz0012xotg2tceetz9","tag_id":"ckxsdzpz8001kxotgbg7g9okn","_id":"ckxsdzpza001sxotg57cp3me3"},{"post_id":"ckxsdzpz10015xotgg4ppd5tt","tag_id":"ckxsdzpz9001pxotghjibfctj","_id":"ckxsdzpzd001zxotga4aeduou"},{"post_id":"ckxsdzpz10015xotgg4ppd5tt","tag_id":"ckxsdzpzb001vxotg84x6hmmn","_id":"ckxsdzpze0021xotgb3pya25j"},{"post_id":"ckxsdzpz5001exotg5gzjgm4a","tag_id":"ckxsdzpzd001yxotg9fi57plw","_id":"ckxsdzpze0022xotgfe3k6pjd"}],"Tag":[{"name":"ClassLoader","_id":"ckxsdzpyi000fxotgd0yyb9ex"},{"name":"factory pattern","_id":"ckxsdzpyq000lxotg45b2176h"},{"name":"Proxy","_id":"ckxsdzpyu000sxotgcam3a7tb"},{"name":"Reflection","_id":"ckxsdzpyy000zxotgczl1e2u0"},{"name":"Stream","_id":"ckxsdzpz20017xotgbr7mgmya"},{"name":"maven","_id":"ckxsdzpz6001fxotg9681c32n"},{"name":"Serialization","_id":"ckxsdzpz8001kxotgbg7g9okn"},{"name":"AOP","_id":"ckxsdzpz9001pxotghjibfctj"},{"name":"Spring","_id":"ckxsdzpzb001vxotg84x6hmmn"},{"name":"Turing","_id":"ckxsdzpzd001yxotg9fi57plw"}]}}